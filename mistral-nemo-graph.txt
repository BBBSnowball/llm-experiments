Size of temporary storage is up to 192512 bytes.
Total cost:
  read: 6.232 GiB
  fmul: 1.15893e+10
  fdiv: 573521
  sqrt: 81
  fsin: 204800
  write: 0.001 GiB
  fpow: 1280
  fadd: 1.67936e+06
  fexp: 614400
          
<---------inp_embd: get_rows(x)
|           20480.0, [5120, 1]
|           costs: {'read': 20484.0, 'tempsize': 20480.0}
|           x: token_embd.weight, 377487360.0, [5120, 131072]
|           y: inp_tokens, 4.0, [1, 1]
|         
|         == layer 0 ==
|         
| <-------norm-0: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: inp_embd, 20480.0, [5120, 1]
| |       
| | <-----attn_norm-0: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-0, 20480.0, [5120, 1]
|   |       y: blk.0.attn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----Qcur-0: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.0.attn_q.weight, 11796480.0, [5120, 4096]
| | >-----  y: attn_norm-0, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-0: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
| >-------  x: Qcur-0, 16384.0, [4096, 1]
|   | |   
| <-|-|---Qcur-0: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'read': 4.0, 'tempsize': 73728.0}
| | | >---  x: Qcur-0, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-0: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.0.attn_k.weight, 2949120.0, [5120, 1024]
| | >-----  y: attn_norm-0, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-0: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-0, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-0: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-0, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-0: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.0.attn_v.weight, 2949120.0, [5120, 1024]
| | >-----  y: attn_norm-0, 20480.0, [5120, 1]
| |   | | 
| | <-|-|-k_cache_view-0: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l0, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-0: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-0, 4096.0, [128, 8]
| | >-----  y: k_cache_view-0, 2048.0, [1024, 1]
| |     | 
| | <---|-Vcur-0: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-0, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-0: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l0, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-0: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| | >-----  x: Vcur-0, 4096.0, [1, 1024]
| |   >---  y: v_cache_view-0, 2048.0, [1, 1024]
| |       
| | <-----v-0: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l0, 8388608.0, [4194304, 1]
| | |     
| | | <---k-0: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l0, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-0: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
| >-------  x: Qcur-0, 16384.0, [128, 32]
|   | | | 
| <-|-|-|-kq-0: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-0, 65536.0, [128, 32, 8]
| | |   >-  y: q-0, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-0: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'read': 4096.0, 'tempsize': 28672.0}
| >-------  x: kq-0, 4096.0, [32, 1, 32]
|   | |     y: KQ_mask, 4096.0, [32, 32]
|   | |   
| <-|-|---kqv-0: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | >-----  x: v-0, 65536.0, [32, 128, 8]
| |   >---  y: kq_soft_max_ext-0, 4096.0, [32, 1, 32]
| |       
| | <-----kqv_merged-0: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv-0, 16384.0, [128, 1, 32]
|   |     
| <-|-----kqv_merged_cont-0: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| | >-----  x: kqv_merged-0, 16384.0, [128, 32]
| |       
| | <-----kqv_out-0: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.0.attn_output.weight, 11796480.0, [4096, 5120]
| >-------  y: kqv_merged_cont-0, 16384.0, [4096, 1]
|   |     
| <-|-----ffn_inp-0: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| | >-----  x: kqv_out-0, 20480.0, [5120, 1]
>---------  y: inp_embd, 20480.0, [5120, 1]
  |       
<-|-------norm-0: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
| >-------  x: ffn_inp-0, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-0: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-0, 20480.0, [5120, 1]
  | |       y: blk.0.ffn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----ffn_gate-0: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.0.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-0, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-0: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
>---------  x: ffn_gate-0, 57344.0, [14336, 1]
  | | |   
<-|-|-|---ffn_up-0: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.0.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-0, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-0: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-0, 57344.0, [14336, 1]
>---------  y: ffn_up-0, 57344.0, [14336, 1]
  | |     
<-|-|-----ffn_out-0: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.0.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-0, 57344.0, [14336, 1]
| |       
| | <-----l_out-0: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
>---------  x: ffn_out-0, 20480.0, [5120, 1]
  >-------  y: ffn_inp-0, 20480.0, [5120, 1]
    |     
    |     == layer 1 ==
    |     
<---|-----norm-1: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-0, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-1: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-1, 20480.0, [5120, 1]
  | |       y: blk.1.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-1: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.1.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-1, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-1: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-1, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-1: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-1, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-1: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.1.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-1, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-1: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-1, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-1: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-1, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-1: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.1.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-1, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-1: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l1, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-1: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-1, 4096.0, [128, 8]
| >-------  y: k_cache_view-1, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-1: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-1, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-1: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l1, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-1: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-1, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-1, 2048.0, [1, 1024]
|   |     
| <-|-----v-1: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l1, 8388608.0, [4194304, 1]
| | |     
| | | <---k-1: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l1, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-1: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-1, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-1: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-1, 65536.0, [128, 32, 8]
| | |   >-  y: q-1, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-1: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-1, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-1: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-1, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-1, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-1: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-1, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-1: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-1, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-1: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.1.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-1, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-1: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-1, 20480.0, [5120, 1]
|   >-----  y: l_out-0, 20480.0, [5120, 1]
|         
| <-------norm-1: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-1, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-1: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-1, 20480.0, [5120, 1]
|   |       y: blk.1.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-1: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.1.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-1, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-1: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-1, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-1: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.1.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-1, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-1: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-1, 57344.0, [14336, 1]
| >-------  y: ffn_up-1, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-1: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.1.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-1, 57344.0, [14336, 1]
| |       
| | <-----l_out-1: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-1, 20480.0, [5120, 1]
>---------  y: ffn_inp-1, 20480.0, [5120, 1]
    |     
    |     == layer 2 ==
    |     
<---|-----norm-2: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-1, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-2: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-2, 20480.0, [5120, 1]
  | |       y: blk.2.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-2: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.2.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-2, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-2: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-2, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-2: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-2, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-2: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.2.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-2, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-2: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-2, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-2: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-2, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-2: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.2.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-2, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-2: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l2, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-2: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-2, 4096.0, [128, 8]
| >-------  y: k_cache_view-2, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-2: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-2, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-2: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l2, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-2: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-2, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-2, 2048.0, [1, 1024]
|   |     
| <-|-----v-2: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l2, 8388608.0, [4194304, 1]
| | |     
| | | <---k-2: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l2, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-2: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-2, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-2: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-2, 65536.0, [128, 32, 8]
| | |   >-  y: q-2, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-2: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-2, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-2: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-2, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-2, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-2: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-2, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-2: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-2, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-2: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.2.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-2, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-2: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-2, 20480.0, [5120, 1]
|   >-----  y: l_out-1, 20480.0, [5120, 1]
|         
| <-------norm-2: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-2, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-2: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-2, 20480.0, [5120, 1]
|   |       y: blk.2.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-2: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.2.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-2, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-2: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-2, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-2: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.2.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-2, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-2: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-2, 57344.0, [14336, 1]
| >-------  y: ffn_up-2, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-2: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.2.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-2, 57344.0, [14336, 1]
| |       
| | <-----l_out-2: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-2, 20480.0, [5120, 1]
>---------  y: ffn_inp-2, 20480.0, [5120, 1]
    |     
    |     == layer 3 ==
    |     
<---|-----norm-3: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-2, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-3: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-3, 20480.0, [5120, 1]
  | |       y: blk.3.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-3: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.3.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-3, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-3: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-3, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-3: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-3, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-3: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.3.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-3, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-3: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-3, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-3: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-3, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-3: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.3.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-3, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-3: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l3, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-3: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-3, 4096.0, [128, 8]
| >-------  y: k_cache_view-3, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-3: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-3, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-3: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l3, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-3: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-3, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-3, 2048.0, [1, 1024]
|   |     
| <-|-----v-3: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l3, 8388608.0, [4194304, 1]
| | |     
| | | <---k-3: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l3, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-3: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-3, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-3: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-3, 65536.0, [128, 32, 8]
| | |   >-  y: q-3, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-3: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-3, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-3: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-3, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-3, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-3: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-3, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-3: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-3, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-3: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.3.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-3, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-3: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-3, 20480.0, [5120, 1]
|   >-----  y: l_out-2, 20480.0, [5120, 1]
|         
| <-------norm-3: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-3, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-3: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-3, 20480.0, [5120, 1]
|   |       y: blk.3.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-3: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.3.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-3, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-3: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-3, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-3: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.3.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-3, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-3: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-3, 57344.0, [14336, 1]
| >-------  y: ffn_up-3, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-3: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.3.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-3, 57344.0, [14336, 1]
| |       
| | <-----l_out-3: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-3, 20480.0, [5120, 1]
>---------  y: ffn_inp-3, 20480.0, [5120, 1]
    |     
    |     == layer 4 ==
    |     
<---|-----norm-4: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-3, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-4: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-4, 20480.0, [5120, 1]
  | |       y: blk.4.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-4: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.4.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-4, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-4: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-4, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-4: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-4, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-4: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.4.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-4, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-4: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-4, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-4: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-4, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-4: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.4.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-4, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-4: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l4, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-4: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-4, 4096.0, [128, 8]
| >-------  y: k_cache_view-4, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-4: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-4, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-4: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l4, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-4: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-4, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-4, 2048.0, [1, 1024]
|   |     
| <-|-----v-4: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l4, 8388608.0, [4194304, 1]
| | |     
| | | <---k-4: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l4, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-4: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-4, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-4: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-4, 65536.0, [128, 32, 8]
| | |   >-  y: q-4, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-4: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-4, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-4: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-4, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-4, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-4: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-4, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-4: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-4, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-4: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.4.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-4, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-4: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-4, 20480.0, [5120, 1]
|   >-----  y: l_out-3, 20480.0, [5120, 1]
|         
| <-------norm-4: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-4, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-4: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-4, 20480.0, [5120, 1]
|   |       y: blk.4.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-4: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.4.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-4, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-4: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-4, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-4: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.4.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-4, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-4: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-4, 57344.0, [14336, 1]
| >-------  y: ffn_up-4, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-4: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.4.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-4, 57344.0, [14336, 1]
| |       
| | <-----l_out-4: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-4, 20480.0, [5120, 1]
>---------  y: ffn_inp-4, 20480.0, [5120, 1]
    |     
    |     == layer 5 ==
    |     
<---|-----norm-5: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-4, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-5: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-5, 20480.0, [5120, 1]
  | |       y: blk.5.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-5: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.5.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-5, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-5: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-5, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-5: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-5, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-5: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.5.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-5, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-5: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-5, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-5: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-5, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-5: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.5.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-5, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-5: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l5, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-5: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-5, 4096.0, [128, 8]
| >-------  y: k_cache_view-5, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-5: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-5, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-5: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l5, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-5: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-5, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-5, 2048.0, [1, 1024]
|   |     
| <-|-----v-5: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l5, 8388608.0, [4194304, 1]
| | |     
| | | <---k-5: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l5, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-5: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-5, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-5: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-5, 65536.0, [128, 32, 8]
| | |   >-  y: q-5, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-5: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-5, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-5: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-5, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-5, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-5: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-5, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-5: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-5, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-5: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.5.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-5, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-5: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-5, 20480.0, [5120, 1]
|   >-----  y: l_out-4, 20480.0, [5120, 1]
|         
| <-------norm-5: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-5, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-5: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-5, 20480.0, [5120, 1]
|   |       y: blk.5.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-5: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.5.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-5, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-5: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-5, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-5: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.5.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-5, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-5: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-5, 57344.0, [14336, 1]
| >-------  y: ffn_up-5, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-5: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.5.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-5, 57344.0, [14336, 1]
| |       
| | <-----l_out-5: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-5, 20480.0, [5120, 1]
>---------  y: ffn_inp-5, 20480.0, [5120, 1]
    |     
    |     == layer 6 ==
    |     
<---|-----norm-6: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-5, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-6: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-6, 20480.0, [5120, 1]
  | |       y: blk.6.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-6: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.6.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-6, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-6: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-6, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-6: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-6, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-6: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.6.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-6, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-6: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-6, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-6: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-6, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-6: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.6.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-6, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-6: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l6, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-6: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-6, 4096.0, [128, 8]
| >-------  y: k_cache_view-6, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-6: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-6, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-6: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l6, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-6: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-6, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-6, 2048.0, [1, 1024]
|   |     
| <-|-----v-6: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l6, 8388608.0, [4194304, 1]
| | |     
| | | <---k-6: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l6, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-6: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-6, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-6: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-6, 65536.0, [128, 32, 8]
| | |   >-  y: q-6, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-6: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-6, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-6: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-6, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-6, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-6: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-6, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-6: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-6, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-6: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.6.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-6, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-6: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-6, 20480.0, [5120, 1]
|   >-----  y: l_out-5, 20480.0, [5120, 1]
|         
| <-------norm-6: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-6, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-6: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-6, 20480.0, [5120, 1]
|   |       y: blk.6.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-6: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.6.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-6, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-6: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-6, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-6: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.6.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-6, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-6: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-6, 57344.0, [14336, 1]
| >-------  y: ffn_up-6, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-6: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.6.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-6, 57344.0, [14336, 1]
| |       
| | <-----l_out-6: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-6, 20480.0, [5120, 1]
>---------  y: ffn_inp-6, 20480.0, [5120, 1]
    |     
    |     == layer 7 ==
    |     
<---|-----norm-7: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-6, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-7: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-7, 20480.0, [5120, 1]
  | |       y: blk.7.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-7: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.7.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-7, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-7: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-7, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-7: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-7, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-7: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.7.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-7, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-7: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-7, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-7: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-7, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-7: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.7.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-7, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-7: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l7, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-7: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-7, 4096.0, [128, 8]
| >-------  y: k_cache_view-7, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-7: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-7, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-7: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l7, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-7: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-7, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-7, 2048.0, [1, 1024]
|   |     
| <-|-----v-7: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l7, 8388608.0, [4194304, 1]
| | |     
| | | <---k-7: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l7, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-7: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-7, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-7: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-7, 65536.0, [128, 32, 8]
| | |   >-  y: q-7, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-7: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-7, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-7: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-7, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-7, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-7: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-7, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-7: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-7, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-7: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.7.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-7, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-7: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-7, 20480.0, [5120, 1]
|   >-----  y: l_out-6, 20480.0, [5120, 1]
|         
| <-------norm-7: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-7, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-7: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-7, 20480.0, [5120, 1]
|   |       y: blk.7.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-7: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.7.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-7, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-7: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-7, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-7: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.7.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-7, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-7: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-7, 57344.0, [14336, 1]
| >-------  y: ffn_up-7, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-7: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.7.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-7, 57344.0, [14336, 1]
| |       
| | <-----l_out-7: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-7, 20480.0, [5120, 1]
>---------  y: ffn_inp-7, 20480.0, [5120, 1]
    |     
    |     == layer 8 ==
    |     
<---|-----norm-8: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-7, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-8: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-8, 20480.0, [5120, 1]
  | |       y: blk.8.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-8: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.8.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-8, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-8: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-8, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-8: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-8, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-8: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.8.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-8, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-8: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-8, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-8: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-8, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-8: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.8.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-8, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-8: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l8, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-8: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-8, 4096.0, [128, 8]
| >-------  y: k_cache_view-8, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-8: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-8, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-8: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l8, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-8: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-8, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-8, 2048.0, [1, 1024]
|   |     
| <-|-----v-8: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l8, 8388608.0, [4194304, 1]
| | |     
| | | <---k-8: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l8, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-8: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-8, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-8: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-8, 65536.0, [128, 32, 8]
| | |   >-  y: q-8, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-8: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-8, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-8: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-8, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-8, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-8: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-8, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-8: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-8, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-8: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.8.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-8, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-8: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-8, 20480.0, [5120, 1]
|   >-----  y: l_out-7, 20480.0, [5120, 1]
|         
| <-------norm-8: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-8, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-8: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-8, 20480.0, [5120, 1]
|   |       y: blk.8.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-8: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.8.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-8, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-8: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-8, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-8: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.8.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-8, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-8: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-8, 57344.0, [14336, 1]
| >-------  y: ffn_up-8, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-8: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.8.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-8, 57344.0, [14336, 1]
| |       
| | <-----l_out-8: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-8, 20480.0, [5120, 1]
>---------  y: ffn_inp-8, 20480.0, [5120, 1]
    |     
    |     == layer 9 ==
    |     
<---|-----norm-9: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-8, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-9: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-9, 20480.0, [5120, 1]
  | |       y: blk.9.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-9: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.9.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-9, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-9: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-9, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-9: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-9, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-9: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.9.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-9, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-9: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-9, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-9: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-9, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-9: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.9.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-9, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-9: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l9, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-9: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-9, 4096.0, [128, 8]
| >-------  y: k_cache_view-9, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-9: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-9, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-9: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l9, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-9: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-9, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-9, 2048.0, [1, 1024]
|   |     
| <-|-----v-9: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l9, 8388608.0, [4194304, 1]
| | |     
| | | <---k-9: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l9, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-9: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-9, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-9: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-9, 65536.0, [128, 32, 8]
| | |   >-  y: q-9, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-9: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-9, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-9: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-9, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-9, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-9: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-9, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-9: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-9, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-9: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.9.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-9, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-9: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-9, 20480.0, [5120, 1]
|   >-----  y: l_out-8, 20480.0, [5120, 1]
|         
| <-------norm-9: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-9, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-9: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-9, 20480.0, [5120, 1]
|   |       y: blk.9.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-9: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.9.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-9, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-9: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-9, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-9: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.9.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-9, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-9: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-9, 57344.0, [14336, 1]
| >-------  y: ffn_up-9, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-9: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.9.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-9, 57344.0, [14336, 1]
| |       
| | <-----l_out-9: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-9, 20480.0, [5120, 1]
>---------  y: ffn_inp-9, 20480.0, [5120, 1]
    |     
    |     == layer 10 ==
    |     
<---|-----norm-10: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-9, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-10: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-10, 20480.0, [5120, 1]
  | |       y: blk.10.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-10: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.10.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-10, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-10: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-10, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-10: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-10, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-10: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.10.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-10, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-10: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-10, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-10: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-10, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-10: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.10.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-10, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-10: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l10, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-10: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-10, 4096.0, [128, 8]
| >-------  y: k_cache_view-10, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-10: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-10, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-10: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l10, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-10: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-10, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-10, 2048.0, [1, 1024]
|   |     
| <-|-----v-10: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l10, 8388608.0, [4194304, 1]
| | |     
| | | <---k-10: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l10, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-10: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-10, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-10: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-10, 65536.0, [128, 32, 8]
| | |   >-  y: q-10, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-10: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-10, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-10: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-10, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-10, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-10: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-10, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-10: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-10, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-10: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.10.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-10, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-10: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-10, 20480.0, [5120, 1]
|   >-----  y: l_out-9, 20480.0, [5120, 1]
|         
| <-------norm-10: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-10, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-10: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-10, 20480.0, [5120, 1]
|   |       y: blk.10.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-10: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.10.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-10, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-10: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-10, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-10: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.10.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-10, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-10: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-10, 57344.0, [14336, 1]
| >-------  y: ffn_up-10, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-10: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.10.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-10, 57344.0, [14336, 1]
| |       
| | <-----l_out-10: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-10, 20480.0, [5120, 1]
>---------  y: ffn_inp-10, 20480.0, [5120, 1]
    |     
    |     == layer 11 ==
    |     
<---|-----norm-11: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-10, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-11: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-11, 20480.0, [5120, 1]
  | |       y: blk.11.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-11: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.11.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-11, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-11: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-11, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-11: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-11, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-11: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.11.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-11, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-11: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-11, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-11: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-11, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-11: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.11.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-11, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-11: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l11, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-11: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-11, 4096.0, [128, 8]
| >-------  y: k_cache_view-11, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-11: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-11, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-11: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l11, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-11: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-11, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-11, 2048.0, [1, 1024]
|   |     
| <-|-----v-11: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l11, 8388608.0, [4194304, 1]
| | |     
| | | <---k-11: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l11, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-11: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-11, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-11: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-11, 65536.0, [128, 32, 8]
| | |   >-  y: q-11, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-11: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-11, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-11: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-11, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-11, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-11: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-11, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-11: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-11, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-11: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.11.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-11, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-11: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-11, 20480.0, [5120, 1]
|   >-----  y: l_out-10, 20480.0, [5120, 1]
|         
| <-------norm-11: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-11, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-11: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-11, 20480.0, [5120, 1]
|   |       y: blk.11.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-11: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.11.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-11, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-11: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-11, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-11: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.11.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-11, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-11: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-11, 57344.0, [14336, 1]
| >-------  y: ffn_up-11, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-11: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.11.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-11, 57344.0, [14336, 1]
| |       
| | <-----l_out-11: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-11, 20480.0, [5120, 1]
>---------  y: ffn_inp-11, 20480.0, [5120, 1]
    |     
    |     == layer 12 ==
    |     
<---|-----norm-12: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-11, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-12: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-12, 20480.0, [5120, 1]
  | |       y: blk.12.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-12: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.12.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-12, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-12: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-12, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-12: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-12, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-12: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.12.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-12, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-12: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-12, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-12: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-12, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-12: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.12.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-12, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-12: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l12, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-12: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-12, 4096.0, [128, 8]
| >-------  y: k_cache_view-12, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-12: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-12, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-12: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l12, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-12: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-12, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-12, 2048.0, [1, 1024]
|   |     
| <-|-----v-12: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l12, 8388608.0, [4194304, 1]
| | |     
| | | <---k-12: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l12, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-12: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-12, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-12: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-12, 65536.0, [128, 32, 8]
| | |   >-  y: q-12, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-12: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-12, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-12: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-12, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-12, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-12: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-12, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-12: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-12, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-12: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.12.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-12, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-12: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-12, 20480.0, [5120, 1]
|   >-----  y: l_out-11, 20480.0, [5120, 1]
|         
| <-------norm-12: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-12, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-12: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-12, 20480.0, [5120, 1]
|   |       y: blk.12.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-12: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.12.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-12, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-12: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-12, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-12: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.12.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-12, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-12: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-12, 57344.0, [14336, 1]
| >-------  y: ffn_up-12, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-12: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.12.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-12, 57344.0, [14336, 1]
| |       
| | <-----l_out-12: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-12, 20480.0, [5120, 1]
>---------  y: ffn_inp-12, 20480.0, [5120, 1]
    |     
    |     == layer 13 ==
    |     
<---|-----norm-13: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-12, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-13: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-13, 20480.0, [5120, 1]
  | |       y: blk.13.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-13: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.13.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-13, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-13: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-13, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-13: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-13, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-13: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.13.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-13, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-13: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-13, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-13: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-13, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-13: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.13.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-13, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-13: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l13, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-13: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-13, 4096.0, [128, 8]
| >-------  y: k_cache_view-13, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-13: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-13, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-13: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l13, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-13: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-13, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-13, 2048.0, [1, 1024]
|   |     
| <-|-----v-13: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l13, 8388608.0, [4194304, 1]
| | |     
| | | <---k-13: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l13, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-13: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-13, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-13: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-13, 65536.0, [128, 32, 8]
| | |   >-  y: q-13, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-13: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-13, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-13: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-13, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-13, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-13: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-13, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-13: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-13, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-13: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.13.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-13, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-13: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-13, 20480.0, [5120, 1]
|   >-----  y: l_out-12, 20480.0, [5120, 1]
|         
| <-------norm-13: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-13, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-13: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-13, 20480.0, [5120, 1]
|   |       y: blk.13.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-13: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.13.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-13, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-13: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-13, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-13: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.13.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-13, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-13: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-13, 57344.0, [14336, 1]
| >-------  y: ffn_up-13, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-13: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.13.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-13, 57344.0, [14336, 1]
| |       
| | <-----l_out-13: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-13, 20480.0, [5120, 1]
>---------  y: ffn_inp-13, 20480.0, [5120, 1]
    |     
    |     == layer 14 ==
    |     
<---|-----norm-14: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-13, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-14: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-14, 20480.0, [5120, 1]
  | |       y: blk.14.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-14: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.14.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-14, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-14: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-14, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-14: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-14, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-14: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.14.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-14, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-14: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-14, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-14: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-14, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-14: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.14.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-14, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-14: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l14, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-14: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-14, 4096.0, [128, 8]
| >-------  y: k_cache_view-14, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-14: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-14, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-14: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l14, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-14: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-14, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-14, 2048.0, [1, 1024]
|   |     
| <-|-----v-14: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l14, 8388608.0, [4194304, 1]
| | |     
| | | <---k-14: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l14, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-14: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-14, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-14: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-14, 65536.0, [128, 32, 8]
| | |   >-  y: q-14, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-14: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-14, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-14: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-14, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-14, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-14: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-14, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-14: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-14, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-14: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.14.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-14, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-14: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-14, 20480.0, [5120, 1]
|   >-----  y: l_out-13, 20480.0, [5120, 1]
|         
| <-------norm-14: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-14, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-14: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-14, 20480.0, [5120, 1]
|   |       y: blk.14.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-14: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.14.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-14, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-14: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-14, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-14: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.14.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-14, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-14: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-14, 57344.0, [14336, 1]
| >-------  y: ffn_up-14, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-14: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.14.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-14, 57344.0, [14336, 1]
| |       
| | <-----l_out-14: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-14, 20480.0, [5120, 1]
>---------  y: ffn_inp-14, 20480.0, [5120, 1]
    |     
    |     == layer 15 ==
    |     
<---|-----norm-15: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-14, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-15: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-15, 20480.0, [5120, 1]
  | |       y: blk.15.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-15: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.15.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-15, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-15: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-15, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-15: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-15, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-15: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.15.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-15, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-15: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-15, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-15: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-15, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-15: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.15.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-15, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-15: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l15, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-15: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-15, 4096.0, [128, 8]
| >-------  y: k_cache_view-15, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-15: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-15, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-15: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l15, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-15: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-15, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-15, 2048.0, [1, 1024]
|   |     
| <-|-----v-15: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l15, 8388608.0, [4194304, 1]
| | |     
| | | <---k-15: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l15, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-15: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-15, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-15: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-15, 65536.0, [128, 32, 8]
| | |   >-  y: q-15, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-15: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-15, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-15: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-15, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-15, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-15: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-15, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-15: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-15, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-15: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.15.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-15, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-15: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-15, 20480.0, [5120, 1]
|   >-----  y: l_out-14, 20480.0, [5120, 1]
|         
| <-------norm-15: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-15, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-15: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-15, 20480.0, [5120, 1]
|   |       y: blk.15.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-15: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.15.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-15, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-15: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-15, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-15: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.15.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-15, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-15: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-15, 57344.0, [14336, 1]
| >-------  y: ffn_up-15, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-15: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.15.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-15, 57344.0, [14336, 1]
| |       
| | <-----l_out-15: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-15, 20480.0, [5120, 1]
>---------  y: ffn_inp-15, 20480.0, [5120, 1]
    |     
    |     == layer 16 ==
    |     
<---|-----norm-16: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-15, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-16: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-16, 20480.0, [5120, 1]
  | |       y: blk.16.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-16: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.16.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-16, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-16: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-16, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-16: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-16, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-16: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.16.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-16, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-16: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-16, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-16: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-16, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-16: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.16.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-16, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-16: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l16, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-16: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-16, 4096.0, [128, 8]
| >-------  y: k_cache_view-16, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-16: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-16, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-16: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l16, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-16: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-16, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-16, 2048.0, [1, 1024]
|   |     
| <-|-----v-16: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l16, 8388608.0, [4194304, 1]
| | |     
| | | <---k-16: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l16, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-16: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-16, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-16: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-16, 65536.0, [128, 32, 8]
| | |   >-  y: q-16, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-16: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-16, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-16: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-16, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-16, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-16: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-16, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-16: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-16, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-16: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.16.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-16, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-16: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-16, 20480.0, [5120, 1]
|   >-----  y: l_out-15, 20480.0, [5120, 1]
|         
| <-------norm-16: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-16, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-16: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-16, 20480.0, [5120, 1]
|   |       y: blk.16.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-16: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.16.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-16, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-16: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-16, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-16: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.16.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-16, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-16: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-16, 57344.0, [14336, 1]
| >-------  y: ffn_up-16, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-16: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.16.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-16, 57344.0, [14336, 1]
| |       
| | <-----l_out-16: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-16, 20480.0, [5120, 1]
>---------  y: ffn_inp-16, 20480.0, [5120, 1]
    |     
    |     == layer 17 ==
    |     
<---|-----norm-17: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-16, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-17: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-17, 20480.0, [5120, 1]
  | |       y: blk.17.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-17: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.17.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-17, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-17: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-17, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-17: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-17, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-17: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.17.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-17, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-17: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-17, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-17: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-17, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-17: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.17.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-17, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-17: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l17, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-17: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-17, 4096.0, [128, 8]
| >-------  y: k_cache_view-17, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-17: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-17, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-17: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l17, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-17: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-17, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-17, 2048.0, [1, 1024]
|   |     
| <-|-----v-17: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l17, 8388608.0, [4194304, 1]
| | |     
| | | <---k-17: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l17, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-17: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-17, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-17: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-17, 65536.0, [128, 32, 8]
| | |   >-  y: q-17, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-17: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-17, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-17: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-17, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-17, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-17: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-17, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-17: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-17, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-17: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.17.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-17, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-17: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-17, 20480.0, [5120, 1]
|   >-----  y: l_out-16, 20480.0, [5120, 1]
|         
| <-------norm-17: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-17, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-17: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-17, 20480.0, [5120, 1]
|   |       y: blk.17.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-17: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.17.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-17, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-17: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-17, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-17: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.17.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-17, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-17: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-17, 57344.0, [14336, 1]
| >-------  y: ffn_up-17, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-17: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.17.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-17, 57344.0, [14336, 1]
| |       
| | <-----l_out-17: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-17, 20480.0, [5120, 1]
>---------  y: ffn_inp-17, 20480.0, [5120, 1]
    |     
    |     == layer 18 ==
    |     
<---|-----norm-18: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-17, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-18: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-18, 20480.0, [5120, 1]
  | |       y: blk.18.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-18: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.18.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-18, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-18: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-18, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-18: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-18, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-18: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.18.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-18, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-18: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-18, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-18: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-18, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-18: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.18.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-18, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-18: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l18, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-18: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-18, 4096.0, [128, 8]
| >-------  y: k_cache_view-18, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-18: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-18, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-18: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l18, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-18: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-18, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-18, 2048.0, [1, 1024]
|   |     
| <-|-----v-18: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l18, 8388608.0, [4194304, 1]
| | |     
| | | <---k-18: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l18, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-18: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-18, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-18: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-18, 65536.0, [128, 32, 8]
| | |   >-  y: q-18, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-18: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-18, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-18: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-18, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-18, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-18: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-18, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-18: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-18, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-18: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.18.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-18, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-18: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-18, 20480.0, [5120, 1]
|   >-----  y: l_out-17, 20480.0, [5120, 1]
|         
| <-------norm-18: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-18, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-18: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-18, 20480.0, [5120, 1]
|   |       y: blk.18.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-18: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.18.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-18, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-18: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-18, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-18: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.18.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-18, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-18: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-18, 57344.0, [14336, 1]
| >-------  y: ffn_up-18, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-18: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.18.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-18, 57344.0, [14336, 1]
| |       
| | <-----l_out-18: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-18, 20480.0, [5120, 1]
>---------  y: ffn_inp-18, 20480.0, [5120, 1]
    |     
    |     == layer 19 ==
    |     
<---|-----norm-19: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-18, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-19: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-19, 20480.0, [5120, 1]
  | |       y: blk.19.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-19: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.19.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-19, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-19: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-19, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-19: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-19, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-19: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.19.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-19, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-19: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-19, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-19: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-19, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-19: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.19.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-19, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-19: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l19, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-19: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-19, 4096.0, [128, 8]
| >-------  y: k_cache_view-19, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-19: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-19, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-19: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l19, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-19: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-19, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-19, 2048.0, [1, 1024]
|   |     
| <-|-----v-19: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l19, 8388608.0, [4194304, 1]
| | |     
| | | <---k-19: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l19, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-19: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-19, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-19: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-19, 65536.0, [128, 32, 8]
| | |   >-  y: q-19, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-19: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-19, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-19: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-19, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-19, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-19: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-19, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-19: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-19, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-19: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.19.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-19, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-19: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-19, 20480.0, [5120, 1]
|   >-----  y: l_out-18, 20480.0, [5120, 1]
|         
| <-------norm-19: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-19, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-19: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-19, 20480.0, [5120, 1]
|   |       y: blk.19.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-19: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.19.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-19, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-19: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-19, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-19: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.19.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-19, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-19: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-19, 57344.0, [14336, 1]
| >-------  y: ffn_up-19, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-19: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.19.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-19, 57344.0, [14336, 1]
| |       
| | <-----l_out-19: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-19, 20480.0, [5120, 1]
>---------  y: ffn_inp-19, 20480.0, [5120, 1]
    |     
    |     == layer 20 ==
    |     
<---|-----norm-20: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-19, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-20: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-20, 20480.0, [5120, 1]
  | |       y: blk.20.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-20: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.20.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-20, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-20: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-20, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-20: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-20, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-20: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.20.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-20, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-20: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-20, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-20: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-20, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-20: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.20.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-20, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-20: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l20, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-20: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-20, 4096.0, [128, 8]
| >-------  y: k_cache_view-20, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-20: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-20, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-20: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l20, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-20: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-20, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-20, 2048.0, [1, 1024]
|   |     
| <-|-----v-20: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l20, 8388608.0, [4194304, 1]
| | |     
| | | <---k-20: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l20, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-20: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-20, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-20: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-20, 65536.0, [128, 32, 8]
| | |   >-  y: q-20, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-20: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-20, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-20: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-20, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-20, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-20: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-20, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-20: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-20, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-20: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.20.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-20, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-20: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-20, 20480.0, [5120, 1]
|   >-----  y: l_out-19, 20480.0, [5120, 1]
|         
| <-------norm-20: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-20, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-20: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-20, 20480.0, [5120, 1]
|   |       y: blk.20.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-20: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.20.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-20, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-20: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-20, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-20: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.20.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-20, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-20: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-20, 57344.0, [14336, 1]
| >-------  y: ffn_up-20, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-20: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.20.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-20, 57344.0, [14336, 1]
| |       
| | <-----l_out-20: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-20, 20480.0, [5120, 1]
>---------  y: ffn_inp-20, 20480.0, [5120, 1]
    |     
    |     == layer 21 ==
    |     
<---|-----norm-21: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-20, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-21: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-21, 20480.0, [5120, 1]
  | |       y: blk.21.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-21: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.21.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-21, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-21: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-21, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-21: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-21, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-21: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.21.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-21, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-21: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-21, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-21: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-21, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-21: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.21.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-21, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-21: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l21, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-21: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-21, 4096.0, [128, 8]
| >-------  y: k_cache_view-21, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-21: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-21, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-21: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l21, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-21: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-21, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-21, 2048.0, [1, 1024]
|   |     
| <-|-----v-21: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l21, 8388608.0, [4194304, 1]
| | |     
| | | <---k-21: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l21, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-21: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-21, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-21: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-21, 65536.0, [128, 32, 8]
| | |   >-  y: q-21, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-21: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-21, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-21: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-21, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-21, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-21: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-21, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-21: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-21, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-21: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.21.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-21, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-21: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-21, 20480.0, [5120, 1]
|   >-----  y: l_out-20, 20480.0, [5120, 1]
|         
| <-------norm-21: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-21, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-21: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-21, 20480.0, [5120, 1]
|   |       y: blk.21.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-21: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.21.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-21, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-21: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-21, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-21: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.21.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-21, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-21: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-21, 57344.0, [14336, 1]
| >-------  y: ffn_up-21, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-21: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.21.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-21, 57344.0, [14336, 1]
| |       
| | <-----l_out-21: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-21, 20480.0, [5120, 1]
>---------  y: ffn_inp-21, 20480.0, [5120, 1]
    |     
    |     == layer 22 ==
    |     
<---|-----norm-22: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-21, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-22: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-22, 20480.0, [5120, 1]
  | |       y: blk.22.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-22: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.22.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-22, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-22: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-22, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-22: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-22, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-22: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.22.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-22, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-22: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-22, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-22: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-22, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-22: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.22.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-22, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-22: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l22, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-22: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-22, 4096.0, [128, 8]
| >-------  y: k_cache_view-22, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-22: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-22, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-22: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l22, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-22: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-22, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-22, 2048.0, [1, 1024]
|   |     
| <-|-----v-22: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l22, 8388608.0, [4194304, 1]
| | |     
| | | <---k-22: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l22, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-22: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-22, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-22: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-22, 65536.0, [128, 32, 8]
| | |   >-  y: q-22, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-22: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-22, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-22: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-22, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-22, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-22: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-22, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-22: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-22, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-22: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.22.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-22, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-22: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-22, 20480.0, [5120, 1]
|   >-----  y: l_out-21, 20480.0, [5120, 1]
|         
| <-------norm-22: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-22, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-22: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-22, 20480.0, [5120, 1]
|   |       y: blk.22.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-22: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.22.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-22, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-22: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-22, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-22: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.22.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-22, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-22: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-22, 57344.0, [14336, 1]
| >-------  y: ffn_up-22, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-22: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.22.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-22, 57344.0, [14336, 1]
| |       
| | <-----l_out-22: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-22, 20480.0, [5120, 1]
>---------  y: ffn_inp-22, 20480.0, [5120, 1]
    |     
    |     == layer 23 ==
    |     
<---|-----norm-23: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-22, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-23: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-23, 20480.0, [5120, 1]
  | |       y: blk.23.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-23: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.23.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-23, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-23: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-23, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-23: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-23, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-23: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.23.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-23, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-23: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-23, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-23: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-23, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-23: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.23.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-23, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-23: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l23, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-23: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-23, 4096.0, [128, 8]
| >-------  y: k_cache_view-23, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-23: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-23, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-23: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l23, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-23: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-23, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-23, 2048.0, [1, 1024]
|   |     
| <-|-----v-23: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l23, 8388608.0, [4194304, 1]
| | |     
| | | <---k-23: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l23, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-23: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-23, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-23: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-23, 65536.0, [128, 32, 8]
| | |   >-  y: q-23, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-23: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-23, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-23: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-23, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-23, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-23: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-23, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-23: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-23, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-23: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.23.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-23, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-23: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-23, 20480.0, [5120, 1]
|   >-----  y: l_out-22, 20480.0, [5120, 1]
|         
| <-------norm-23: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-23, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-23: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-23, 20480.0, [5120, 1]
|   |       y: blk.23.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-23: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.23.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-23, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-23: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-23, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-23: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.23.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-23, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-23: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-23, 57344.0, [14336, 1]
| >-------  y: ffn_up-23, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-23: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.23.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-23, 57344.0, [14336, 1]
| |       
| | <-----l_out-23: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-23, 20480.0, [5120, 1]
>---------  y: ffn_inp-23, 20480.0, [5120, 1]
    |     
    |     == layer 24 ==
    |     
<---|-----norm-24: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-23, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-24: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-24, 20480.0, [5120, 1]
  | |       y: blk.24.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-24: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.24.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-24, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-24: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-24, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-24: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-24, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-24: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.24.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-24, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-24: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-24, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-24: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-24, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-24: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.24.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-24, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-24: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l24, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-24: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-24, 4096.0, [128, 8]
| >-------  y: k_cache_view-24, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-24: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-24, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-24: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l24, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-24: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-24, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-24, 2048.0, [1, 1024]
|   |     
| <-|-----v-24: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l24, 8388608.0, [4194304, 1]
| | |     
| | | <---k-24: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l24, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-24: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-24, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-24: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-24, 65536.0, [128, 32, 8]
| | |   >-  y: q-24, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-24: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-24, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-24: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-24, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-24, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-24: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-24, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-24: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-24, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-24: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.24.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-24, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-24: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-24, 20480.0, [5120, 1]
|   >-----  y: l_out-23, 20480.0, [5120, 1]
|         
| <-------norm-24: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-24, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-24: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-24, 20480.0, [5120, 1]
|   |       y: blk.24.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-24: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.24.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-24, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-24: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-24, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-24: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.24.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-24, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-24: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-24, 57344.0, [14336, 1]
| >-------  y: ffn_up-24, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-24: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.24.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-24, 57344.0, [14336, 1]
| |       
| | <-----l_out-24: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-24, 20480.0, [5120, 1]
>---------  y: ffn_inp-24, 20480.0, [5120, 1]
    |     
    |     == layer 25 ==
    |     
<---|-----norm-25: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-24, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-25: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-25, 20480.0, [5120, 1]
  | |       y: blk.25.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-25: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.25.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-25, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-25: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-25, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-25: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-25, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-25: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.25.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-25, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-25: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-25, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-25: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-25, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-25: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.25.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-25, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-25: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l25, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-25: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-25, 4096.0, [128, 8]
| >-------  y: k_cache_view-25, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-25: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-25, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-25: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l25, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-25: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-25, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-25, 2048.0, [1, 1024]
|   |     
| <-|-----v-25: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l25, 8388608.0, [4194304, 1]
| | |     
| | | <---k-25: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l25, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-25: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-25, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-25: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-25, 65536.0, [128, 32, 8]
| | |   >-  y: q-25, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-25: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-25, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-25: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-25, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-25, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-25: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-25, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-25: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-25, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-25: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.25.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-25, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-25: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-25, 20480.0, [5120, 1]
|   >-----  y: l_out-24, 20480.0, [5120, 1]
|         
| <-------norm-25: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-25, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-25: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-25, 20480.0, [5120, 1]
|   |       y: blk.25.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-25: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.25.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-25, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-25: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-25, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-25: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.25.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-25, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-25: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-25, 57344.0, [14336, 1]
| >-------  y: ffn_up-25, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-25: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.25.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-25, 57344.0, [14336, 1]
| |       
| | <-----l_out-25: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-25, 20480.0, [5120, 1]
>---------  y: ffn_inp-25, 20480.0, [5120, 1]
    |     
    |     == layer 26 ==
    |     
<---|-----norm-26: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-25, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-26: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-26, 20480.0, [5120, 1]
  | |       y: blk.26.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-26: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.26.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-26, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-26: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-26, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-26: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-26, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-26: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.26.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-26, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-26: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-26, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-26: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-26, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-26: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.26.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-26, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-26: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l26, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-26: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-26, 4096.0, [128, 8]
| >-------  y: k_cache_view-26, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-26: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-26, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-26: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l26, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-26: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-26, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-26, 2048.0, [1, 1024]
|   |     
| <-|-----v-26: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l26, 8388608.0, [4194304, 1]
| | |     
| | | <---k-26: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l26, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-26: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-26, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-26: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-26, 65536.0, [128, 32, 8]
| | |   >-  y: q-26, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-26: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-26, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-26: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-26, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-26, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-26: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-26, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-26: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-26, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-26: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.26.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-26, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-26: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-26, 20480.0, [5120, 1]
|   >-----  y: l_out-25, 20480.0, [5120, 1]
|         
| <-------norm-26: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-26, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-26: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-26, 20480.0, [5120, 1]
|   |       y: blk.26.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-26: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.26.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-26, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-26: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-26, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-26: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.26.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-26, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-26: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-26, 57344.0, [14336, 1]
| >-------  y: ffn_up-26, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-26: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.26.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-26, 57344.0, [14336, 1]
| |       
| | <-----l_out-26: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-26, 20480.0, [5120, 1]
>---------  y: ffn_inp-26, 20480.0, [5120, 1]
    |     
    |     == layer 27 ==
    |     
<---|-----norm-27: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-26, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-27: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-27, 20480.0, [5120, 1]
  | |       y: blk.27.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-27: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.27.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-27, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-27: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-27, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-27: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-27, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-27: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.27.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-27, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-27: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-27, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-27: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-27, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-27: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.27.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-27, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-27: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l27, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-27: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-27, 4096.0, [128, 8]
| >-------  y: k_cache_view-27, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-27: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-27, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-27: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l27, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-27: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-27, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-27, 2048.0, [1, 1024]
|   |     
| <-|-----v-27: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l27, 8388608.0, [4194304, 1]
| | |     
| | | <---k-27: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l27, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-27: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-27, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-27: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-27, 65536.0, [128, 32, 8]
| | |   >-  y: q-27, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-27: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-27, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-27: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-27, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-27, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-27: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-27, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-27: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-27, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-27: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.27.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-27, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-27: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-27, 20480.0, [5120, 1]
|   >-----  y: l_out-26, 20480.0, [5120, 1]
|         
| <-------norm-27: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-27, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-27: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-27, 20480.0, [5120, 1]
|   |       y: blk.27.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-27: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.27.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-27, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-27: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-27, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-27: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.27.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-27, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-27: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-27, 57344.0, [14336, 1]
| >-------  y: ffn_up-27, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-27: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.27.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-27, 57344.0, [14336, 1]
| |       
| | <-----l_out-27: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-27, 20480.0, [5120, 1]
>---------  y: ffn_inp-27, 20480.0, [5120, 1]
    |     
    |     == layer 28 ==
    |     
<---|-----norm-28: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-27, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-28: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-28, 20480.0, [5120, 1]
  | |       y: blk.28.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-28: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.28.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-28, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-28: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-28, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-28: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-28, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-28: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.28.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-28, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-28: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-28, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-28: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-28, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-28: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.28.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-28, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-28: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l28, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-28: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-28, 4096.0, [128, 8]
| >-------  y: k_cache_view-28, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-28: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-28, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-28: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l28, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-28: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-28, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-28, 2048.0, [1, 1024]
|   |     
| <-|-----v-28: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l28, 8388608.0, [4194304, 1]
| | |     
| | | <---k-28: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l28, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-28: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-28, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-28: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-28, 65536.0, [128, 32, 8]
| | |   >-  y: q-28, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-28: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-28, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-28: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-28, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-28, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-28: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-28, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-28: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-28, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-28: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.28.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-28, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-28: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-28, 20480.0, [5120, 1]
|   >-----  y: l_out-27, 20480.0, [5120, 1]
|         
| <-------norm-28: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-28, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-28: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-28, 20480.0, [5120, 1]
|   |       y: blk.28.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-28: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.28.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-28, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-28: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-28, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-28: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.28.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-28, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-28: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-28, 57344.0, [14336, 1]
| >-------  y: ffn_up-28, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-28: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.28.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-28, 57344.0, [14336, 1]
| |       
| | <-----l_out-28: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-28, 20480.0, [5120, 1]
>---------  y: ffn_inp-28, 20480.0, [5120, 1]
    |     
    |     == layer 29 ==
    |     
<---|-----norm-29: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-28, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-29: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-29, 20480.0, [5120, 1]
  | |       y: blk.29.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-29: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.29.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-29, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-29: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-29, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-29: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-29, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-29: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.29.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-29, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-29: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-29, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-29: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-29, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-29: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.29.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-29, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-29: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l29, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-29: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-29, 4096.0, [128, 8]
| >-------  y: k_cache_view-29, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-29: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-29, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-29: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l29, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-29: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-29, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-29, 2048.0, [1, 1024]
|   |     
| <-|-----v-29: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l29, 8388608.0, [4194304, 1]
| | |     
| | | <---k-29: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l29, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-29: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-29, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-29: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-29, 65536.0, [128, 32, 8]
| | |   >-  y: q-29, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-29: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-29, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-29: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-29, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-29, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-29: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-29, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-29: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-29, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-29: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.29.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-29, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-29: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-29, 20480.0, [5120, 1]
|   >-----  y: l_out-28, 20480.0, [5120, 1]
|         
| <-------norm-29: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-29, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-29: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-29, 20480.0, [5120, 1]
|   |       y: blk.29.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-29: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.29.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-29, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-29: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-29, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-29: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.29.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-29, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-29: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-29, 57344.0, [14336, 1]
| >-------  y: ffn_up-29, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-29: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.29.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-29, 57344.0, [14336, 1]
| |       
| | <-----l_out-29: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-29, 20480.0, [5120, 1]
>---------  y: ffn_inp-29, 20480.0, [5120, 1]
    |     
    |     == layer 30 ==
    |     
<---|-----norm-30: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-29, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-30: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-30, 20480.0, [5120, 1]
  | |       y: blk.30.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-30: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.30.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-30, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-30: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-30, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-30: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-30, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-30: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.30.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-30, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-30: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-30, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-30: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-30, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-30: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.30.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-30, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-30: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l30, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-30: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-30, 4096.0, [128, 8]
| >-------  y: k_cache_view-30, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-30: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-30, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-30: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l30, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-30: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-30, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-30, 2048.0, [1, 1024]
|   |     
| <-|-----v-30: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l30, 8388608.0, [4194304, 1]
| | |     
| | | <---k-30: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l30, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-30: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-30, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-30: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-30, 65536.0, [128, 32, 8]
| | |   >-  y: q-30, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-30: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-30, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-30: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-30, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-30, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-30: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-30, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-30: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-30, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-30: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.30.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-30, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-30: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-30, 20480.0, [5120, 1]
|   >-----  y: l_out-29, 20480.0, [5120, 1]
|         
| <-------norm-30: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-30, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-30: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-30, 20480.0, [5120, 1]
|   |       y: blk.30.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-30: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.30.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-30, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-30: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-30, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-30: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.30.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-30, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-30: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-30, 57344.0, [14336, 1]
| >-------  y: ffn_up-30, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-30: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.30.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-30, 57344.0, [14336, 1]
| |       
| | <-----l_out-30: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-30, 20480.0, [5120, 1]
>---------  y: ffn_inp-30, 20480.0, [5120, 1]
    |     
    |     == layer 31 ==
    |     
<---|-----norm-31: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-30, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-31: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-31, 20480.0, [5120, 1]
  | |       y: blk.31.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-31: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.31.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-31, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-31: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-31, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-31: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-31, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-31: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.31.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-31, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-31: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-31, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-31: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-31, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-31: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.31.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-31, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-31: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l31, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-31: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-31, 4096.0, [128, 8]
| >-------  y: k_cache_view-31, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-31: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-31, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-31: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l31, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-31: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-31, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-31, 2048.0, [1, 1024]
|   |     
| <-|-----v-31: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l31, 8388608.0, [4194304, 1]
| | |     
| | | <---k-31: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l31, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-31: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-31, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-31: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-31, 65536.0, [128, 32, 8]
| | |   >-  y: q-31, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-31: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-31, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-31: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-31, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-31, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-31: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-31, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-31: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-31, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-31: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.31.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-31, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-31: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-31, 20480.0, [5120, 1]
|   >-----  y: l_out-30, 20480.0, [5120, 1]
|         
| <-------norm-31: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-31, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-31: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-31, 20480.0, [5120, 1]
|   |       y: blk.31.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-31: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.31.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-31, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-31: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-31, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-31: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.31.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-31, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-31: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-31, 57344.0, [14336, 1]
| >-------  y: ffn_up-31, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-31: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.31.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-31, 57344.0, [14336, 1]
| |       
| | <-----l_out-31: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-31, 20480.0, [5120, 1]
>---------  y: ffn_inp-31, 20480.0, [5120, 1]
    |     
    |     == layer 32 ==
    |     
<---|-----norm-32: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-31, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-32: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-32, 20480.0, [5120, 1]
  | |       y: blk.32.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-32: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.32.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-32, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-32: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-32, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-32: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-32, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-32: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.32.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-32, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-32: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-32, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-32: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-32, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-32: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.32.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-32, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-32: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l32, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-32: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-32, 4096.0, [128, 8]
| >-------  y: k_cache_view-32, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-32: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-32, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-32: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l32, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-32: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-32, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-32, 2048.0, [1, 1024]
|   |     
| <-|-----v-32: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l32, 8388608.0, [4194304, 1]
| | |     
| | | <---k-32: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l32, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-32: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-32, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-32: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-32, 65536.0, [128, 32, 8]
| | |   >-  y: q-32, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-32: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-32, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-32: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-32, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-32, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-32: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-32, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-32: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-32, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-32: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.32.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-32, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-32: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-32, 20480.0, [5120, 1]
|   >-----  y: l_out-31, 20480.0, [5120, 1]
|         
| <-------norm-32: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-32, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-32: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-32, 20480.0, [5120, 1]
|   |       y: blk.32.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-32: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.32.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-32, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-32: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-32, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-32: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.32.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-32, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-32: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-32, 57344.0, [14336, 1]
| >-------  y: ffn_up-32, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-32: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.32.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-32, 57344.0, [14336, 1]
| |       
| | <-----l_out-32: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-32, 20480.0, [5120, 1]
>---------  y: ffn_inp-32, 20480.0, [5120, 1]
    |     
    |     == layer 33 ==
    |     
<---|-----norm-33: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-32, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-33: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-33, 20480.0, [5120, 1]
  | |       y: blk.33.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-33: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.33.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-33, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-33: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-33, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-33: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-33, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-33: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.33.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-33, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-33: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-33, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-33: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-33, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-33: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.33.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-33, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-33: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l33, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-33: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-33, 4096.0, [128, 8]
| >-------  y: k_cache_view-33, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-33: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-33, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-33: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l33, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-33: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-33, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-33, 2048.0, [1, 1024]
|   |     
| <-|-----v-33: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l33, 8388608.0, [4194304, 1]
| | |     
| | | <---k-33: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l33, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-33: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-33, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-33: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-33, 65536.0, [128, 32, 8]
| | |   >-  y: q-33, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-33: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-33, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-33: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-33, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-33, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-33: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-33, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-33: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-33, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-33: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.33.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-33, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-33: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-33, 20480.0, [5120, 1]
|   >-----  y: l_out-32, 20480.0, [5120, 1]
|         
| <-------norm-33: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-33, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-33: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-33, 20480.0, [5120, 1]
|   |       y: blk.33.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-33: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.33.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-33, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-33: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-33, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-33: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.33.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-33, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-33: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-33, 57344.0, [14336, 1]
| >-------  y: ffn_up-33, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-33: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.33.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-33, 57344.0, [14336, 1]
| |       
| | <-----l_out-33: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-33, 20480.0, [5120, 1]
>---------  y: ffn_inp-33, 20480.0, [5120, 1]
    |     
    |     == layer 34 ==
    |     
<---|-----norm-34: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-33, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-34: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-34, 20480.0, [5120, 1]
  | |       y: blk.34.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-34: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.34.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-34, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-34: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-34, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-34: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-34, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-34: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.34.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-34, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-34: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-34, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-34: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-34, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-34: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.34.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-34, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-34: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l34, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-34: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-34, 4096.0, [128, 8]
| >-------  y: k_cache_view-34, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-34: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-34, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-34: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l34, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-34: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-34, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-34, 2048.0, [1, 1024]
|   |     
| <-|-----v-34: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l34, 8388608.0, [4194304, 1]
| | |     
| | | <---k-34: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l34, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-34: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-34, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-34: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-34, 65536.0, [128, 32, 8]
| | |   >-  y: q-34, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-34: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-34, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-34: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-34, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-34, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-34: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-34, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-34: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-34, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-34: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.34.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-34, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-34: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-34, 20480.0, [5120, 1]
|   >-----  y: l_out-33, 20480.0, [5120, 1]
|         
| <-------norm-34: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-34, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-34: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-34, 20480.0, [5120, 1]
|   |       y: blk.34.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-34: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.34.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-34, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-34: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-34, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-34: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.34.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-34, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-34: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-34, 57344.0, [14336, 1]
| >-------  y: ffn_up-34, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-34: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.34.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-34, 57344.0, [14336, 1]
| |       
| | <-----l_out-34: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-34, 20480.0, [5120, 1]
>---------  y: ffn_inp-34, 20480.0, [5120, 1]
    |     
    |     == layer 35 ==
    |     
<---|-----norm-35: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-34, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-35: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-35, 20480.0, [5120, 1]
  | |       y: blk.35.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-35: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.35.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-35, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-35: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-35, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-35: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-35, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-35: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.35.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-35, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-35: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-35, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-35: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-35, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-35: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.35.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-35, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-35: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l35, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-35: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-35, 4096.0, [128, 8]
| >-------  y: k_cache_view-35, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-35: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-35, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-35: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l35, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-35: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-35, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-35, 2048.0, [1, 1024]
|   |     
| <-|-----v-35: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l35, 8388608.0, [4194304, 1]
| | |     
| | | <---k-35: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l35, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-35: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-35, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-35: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-35, 65536.0, [128, 32, 8]
| | |   >-  y: q-35, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-35: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-35, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-35: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-35, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-35, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-35: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-35, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-35: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-35, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-35: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.35.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-35, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-35: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-35, 20480.0, [5120, 1]
|   >-----  y: l_out-34, 20480.0, [5120, 1]
|         
| <-------norm-35: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-35, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-35: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-35, 20480.0, [5120, 1]
|   |       y: blk.35.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-35: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.35.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-35, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-35: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-35, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-35: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.35.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-35, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-35: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-35, 57344.0, [14336, 1]
| >-------  y: ffn_up-35, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-35: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.35.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-35, 57344.0, [14336, 1]
| |       
| | <-----l_out-35: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-35, 20480.0, [5120, 1]
>---------  y: ffn_inp-35, 20480.0, [5120, 1]
    |     
    |     == layer 36 ==
    |     
<---|-----norm-36: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-35, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-36: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-36, 20480.0, [5120, 1]
  | |       y: blk.36.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-36: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.36.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-36, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-36: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-36, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-36: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-36, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-36: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.36.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-36, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-36: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-36, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-36: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-36, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-36: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.36.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-36, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-36: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l36, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-36: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-36, 4096.0, [128, 8]
| >-------  y: k_cache_view-36, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-36: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-36, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-36: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l36, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-36: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-36, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-36, 2048.0, [1, 1024]
|   |     
| <-|-----v-36: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l36, 8388608.0, [4194304, 1]
| | |     
| | | <---k-36: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l36, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-36: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-36, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-36: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-36, 65536.0, [128, 32, 8]
| | |   >-  y: q-36, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-36: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-36, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-36: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-36, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-36, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-36: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-36, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-36: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-36, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-36: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.36.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-36, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-36: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-36, 20480.0, [5120, 1]
|   >-----  y: l_out-35, 20480.0, [5120, 1]
|         
| <-------norm-36: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-36, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-36: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-36, 20480.0, [5120, 1]
|   |       y: blk.36.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-36: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.36.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-36, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-36: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-36, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-36: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.36.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-36, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-36: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-36, 57344.0, [14336, 1]
| >-------  y: ffn_up-36, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-36: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.36.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-36, 57344.0, [14336, 1]
| |       
| | <-----l_out-36: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-36, 20480.0, [5120, 1]
>---------  y: ffn_inp-36, 20480.0, [5120, 1]
    |     
    |     == layer 37 ==
    |     
<---|-----norm-37: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-36, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-37: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-37, 20480.0, [5120, 1]
  | |       y: blk.37.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-37: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.37.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-37, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-37: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-37, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-37: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-37, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-37: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.37.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-37, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-37: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-37, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-37: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-37, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-37: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.37.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-37, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-37: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l37, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-37: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-37, 4096.0, [128, 8]
| >-------  y: k_cache_view-37, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-37: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-37, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-37: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l37, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-37: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-37, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-37, 2048.0, [1, 1024]
|   |     
| <-|-----v-37: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l37, 8388608.0, [4194304, 1]
| | |     
| | | <---k-37: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l37, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-37: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-37, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-37: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-37, 65536.0, [128, 32, 8]
| | |   >-  y: q-37, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-37: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-37, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-37: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-37, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-37, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-37: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-37, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-37: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-37, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-37: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.37.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-37, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-37: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-37, 20480.0, [5120, 1]
|   >-----  y: l_out-36, 20480.0, [5120, 1]
|         
| <-------norm-37: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-37, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-37: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-37, 20480.0, [5120, 1]
|   |       y: blk.37.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-37: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.37.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-37, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-37: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-37, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-37: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.37.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-37, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-37: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-37, 57344.0, [14336, 1]
| >-------  y: ffn_up-37, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-37: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.37.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-37, 57344.0, [14336, 1]
| |       
| | <-----l_out-37: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-37, 20480.0, [5120, 1]
>---------  y: ffn_inp-37, 20480.0, [5120, 1]
    |     
    |     == layer 38 ==
    |     
<---|-----norm-38: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-37, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-38: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-38, 20480.0, [5120, 1]
  | |       y: blk.38.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-38: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.38.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-38, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-38: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-38, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-38: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-38, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-38: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.38.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-38, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-38: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-38, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-38: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-38, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-38: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.38.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-38, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-38: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l38, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-38: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-38, 4096.0, [128, 8]
| >-------  y: k_cache_view-38, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-38: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-38, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-38: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l38, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-38: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-38, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-38, 2048.0, [1, 1024]
|   |     
| <-|-----v-38: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l38, 8388608.0, [4194304, 1]
| | |     
| | | <---k-38: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l38, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-38: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-38, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-38: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-38, 65536.0, [128, 32, 8]
| | |   >-  y: q-38, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-38: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-38, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-38: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-38, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-38, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-38: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-38, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-38: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-38, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-38: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.38.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-38, 16384.0, [4096, 1]
  | |     
<-|-|-----ffn_inp-38: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: kqv_out-38, 20480.0, [5120, 1]
|   >-----  y: l_out-37, 20480.0, [5120, 1]
|         
| <-------norm-38: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
>---------  x: ffn_inp-38, 20480.0, [5120, 1]
| |       
| | <-----ffn_norm-38: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
| >-------  x: norm-38, 20480.0, [5120, 1]
|   |       y: blk.38.ffn_norm.weight, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_gate-38: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.38.ffn_gate.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-38, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-38: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
| >-------  x: ffn_gate-38, 57344.0, [14336, 1]
|   | |   
| <-|-|---ffn_up-38: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.38.ffn_up.weight, 41287680.0, [5120, 14336]
| | >-----  y: ffn_norm-38, 20480.0, [5120, 1]
| |   |   
| | <-|---ffn_gate_par-38: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-38, 57344.0, [14336, 1]
| >-------  y: ffn_up-38, 57344.0, [14336, 1]
|   |     
| <-|-----ffn_out-38: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.38.ffn_down.weight, 41287680.0, [14336, 5120]
| | >-----  y: ffn_gate_par-38, 57344.0, [14336, 1]
| |       
| | <-----l_out-38: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
| >-------  x: ffn_out-38, 20480.0, [5120, 1]
>---------  y: ffn_inp-38, 20480.0, [5120, 1]
    |     
    |     == layer 39 ==
    |     
<---|-----norm-39: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: l_out-38, 20480.0, [5120, 1]
|   |     
| <-|-----attn_norm-39: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-39, 20480.0, [5120, 1]
  | |       y: blk.39.attn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----Qcur-39: X*Y (MAT_MUL)
| | |       16384.0, [4096, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.39.attn_q.weight, 11796480.0, [5120, 4096]
| >-------  y: attn_norm-39, 20480.0, [5120, 1]
| | |     
| | | <---Qcur-39: reshape(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'tempsize': 73728.0}
>---------  x: Qcur-39, 16384.0, [4096, 1]
  | | |   
<-|-|-|---Qcur-39: rope(x)
| | | |     16384.0, [128, 32]
| | | |     costs: {'fmul': 12288, 'fsin': 4096, 'tempsize': 73728.0}
| | | >---  x: Qcur-39, 16384.0, [128, 32]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-39: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 61440.0}
| | | |     x: blk.39.attn_k.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-39, 20480.0, [5120, 1]
| | | |   
| | | | <-Kcur-39: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 65536.0}
| | | >---  x: Kcur-39, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-39: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 65536.0}
| | | | >-  x: Kcur-39, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-39: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 5242880, 'read': 2949120.0, 'tempsize': 65536.0}
| | | | |   x: blk.39.attn_v.weight, 2949120.0, [5120, 1024]
| >-------  y: attn_norm-39, 20480.0, [5120, 1]
|   | | | 
| <-|-|-|-k_cache_view-39: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 45056.0}
| | | | |   x: cache_k_l39, 8388608.0, [4194304, 1]
| | | | | 
| | | | | k_cache_view-39: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 45056.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-39, 4096.0, [128, 8]
| >-------  y: k_cache_view-39, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-39: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 45056.0}
| | |   >-  x: Vcur-39, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-39: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 40960.0}
| | | |     x: cache_v_l39, 8388608.0, [4194304, 1]
| | | |   
| | | |   v_cache_view-39: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 40960.0}
| | | |     not used by other computations
| >-------  x: Vcur-39, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-39, 2048.0, [1, 1024]
|   |     
| <-|-----v-39: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 36864.0}
| | |       x: cache_v_l39, 8388608.0, [4194304, 1]
| | |     
| | | <---k-39: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 36864.0}
| | | |     x: cache_k_l39, 8388608.0, [4194304, 1]
| | | |   
| | | | <-q-39: permute(x)
| | | | |   16384.0, [128, 1, 32]
| | | | |   costs: {'tempsize': 53248.0}
>---------  x: Qcur-39, 16384.0, [128, 32]
  | | | | 
<-|-|-|-|-kq-39: X*Y (MAT_MUL)
| | | | |   4096.0, [32, 1, 32]
| | | | |   costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| | | >---  x: k-39, 65536.0, [128, 32, 8]
| | |   >-  y: q-39, 16384.0, [128, 1, 32]
| | |     
| | | <---kq_soft_max_ext-39: soft_max(x)
| | | |     4096.0, [32, 1, 32]
| | | |     costs: {'fpow': 32, 'fmul': 3072, 'fadd': 3072, 'fexp': 1024, 'tempsize': 28672.0}
>---------  x: kq-39, 4096.0, [32, 1, 32]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-39: X*Y (MAT_MUL)
| | | |     16384.0, [128, 1, 32]
| | | |     costs: {'fmul': 131072, 'read': 65536.0, 'tempsize': 40960.0}
| >-------  x: v-39, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-39, 4096.0, [32, 1, 32]
|   |     
| <-|-----kqv_merged-39: permute(x)
| | |       16384.0, [128, 32]
| | |       costs: {'tempsize': 53248.0}
>---------  x: kqv-39, 16384.0, [128, 1, 32]
  | |     
<-|-|-----kqv_merged_cont-39: cont(x)
| | |       16384.0, [4096, 1]
| | |       costs: {'tempsize': 53248.0}
| >-------  x: kqv_merged-39, 16384.0, [128, 32]
|   |     
| <-|-----kqv_out-39: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 20971520, 'read': 11796480.0, 'tempsize': 57344.0}
| | |       x: blk.39.attn_output.weight, 11796480.0, [4096, 5120]
>---------  y: kqv_merged_cont-39, 16384.0, [4096, 1]
  | |     
<-|-|-----node_1272: get_rows(x)
| | |       20480.0, [5120, 1]
| | |       costs: {'read': 20484.0, 'tempsize': 61440.0}
| >-------  x: kqv_out-39, 20480.0, [5120, 1]
|   |       y: inp_out_ids, 4.0, [1, 1]
|   |     
| <-|-----node_1273: get_rows(x)
| | |       20480.0, [5120, 1]
| | |       costs: {'read': 20484.0, 'tempsize': 61440.0}
| | >-----  x: l_out-38, 20480.0, [5120, 1]
| |         y: inp_out_ids, 4.0, [1, 1]
| |       
| | <-----ffn_inp-39: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
>---------  x: node_1272, 20480.0, [5120, 1]
  >-------  y: node_1273, 20480.0, [5120, 1]
    |     
<---|-----norm-39: rms_norm(x)
|   |       20480.0, [5120, 1]
|   |       costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
|   >-----  x: ffn_inp-39, 20480.0, [5120, 1]
|   |     
| <-|-----ffn_norm-39: x*y (MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 61440.0}
>---------  x: norm-39, 20480.0, [5120, 1]
  | |       y: blk.39.ffn_norm.weight, 20480.0, [5120, 1]
  | |     
<-|-|-----ffn_gate-39: X*Y (MAT_MUL)
| | |       57344.0, [14336, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.39.ffn_gate.weight, 41287680.0, [5120, 14336]
| >-------  y: ffn_norm-39, 20480.0, [5120, 1]
| | |     
| | | <---ffn_silu-39: unary(x) (SILU?)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fadd': 28672, 'fdiv': 14336, 'fexp': 14336, 'tempsize': 155648.0}
>---------  x: ffn_gate-39, 57344.0, [14336, 1]
  | | |   
<-|-|-|---ffn_up-39: X*Y (MAT_MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 155648.0}
| | | |     x: blk.39.ffn_up.weight, 41287680.0, [5120, 14336]
| >-------  y: ffn_norm-39, 20480.0, [5120, 1]
|   | |   
| <-|-|---ffn_gate_par-39: x*y (MUL)
| | | |     57344.0, [14336, 1]
| | | |     costs: {'fmul': 14336, 'tempsize': 192512.0}
| | | >---  x: ffn_silu-39, 57344.0, [14336, 1]
>---------  y: ffn_up-39, 57344.0, [14336, 1]
  | |     
<-|-|-----ffn_out-39: X*Y (MAT_MUL)
| | |       20480.0, [5120, 1]
| | |       costs: {'fmul': 73400320, 'read': 41287680.0, 'tempsize': 98304.0}
| | |       x: blk.39.ffn_down.weight, 41287680.0, [14336, 5120]
| >-------  y: ffn_gate_par-39, 57344.0, [14336, 1]
|   |     
| <-|-----l_out-39: x+y
| | |       20480.0, [5120, 1]
| | |       costs: {'fadd': 5120, 'tempsize': 61440.0}
>---------  x: ffn_out-39, 20480.0, [5120, 1]
  | >-----  y: ffn_inp-39, 20480.0, [5120, 1]
  |       
<-|-------norm: rms_norm(x)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 10240, 'fdiv': 1, 'sqrt': 1, 'tempsize': 40960.0}
| >-------  x: l_out-39, 20480.0, [5120, 1]
|         
| <-------result_norm: x*y (MUL)
| |         20480.0, [5120, 1]
| |         costs: {'fmul': 5120, 'read': 20480.0, 'tempsize': 40960.0}
>---------  x: norm, 20480.0, [5120, 1]
  |         y: output_norm.weight, 20480.0, [5120, 1]
  |       
  |       result_output: X*Y (MAT_MUL)
  |         524288.0, [131072, 1]
  |         costs: {'fmul': 671088640, 'read': 550502400.0, 'tempsize': 20480.0}
  |         not used by other computations
  |         x: output.weight, 550502400.0, [5120, 131072]
  >-------  y: result_norm, 20480.0, [5120, 1]
