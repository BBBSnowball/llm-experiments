Size of temporary storage is up to 393216 bytes.
Total cost:
  read: 64.135 GiB
  fmul: 1.22288e+11
  fdiv: 2.52331e+06
  sqrt: 177
  fsin: 1.17146e+06
  write: 0.003 GiB
  fpow: 8448
  fadd: 8.01997e+06
  fexp: 2.79347e+06
          
<---------inp_embd: get_rows(x)
|           49152.0, [12288, 1]
|           costs: {'read': 49156.0, 'tempsize': 49152.0}
|           x: token_embd.weight, 226492416.0, [12288, 32768]
|           y: inp_tokens, 4.0, [1, 1]
|         
|         == layer 0 ==
|         
| <-------norm-0: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: inp_embd, 49152.0, [12288, 1]
| |       
| | <-----attn_norm-0: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-0, 49152.0, [12288, 1]
|   |       y: blk.0.attn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----Qcur-0: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.0.attn_q.weight, 84934656.0, [12288, 12288]
| | >-----  y: attn_norm-0, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-0: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
| >-------  x: Qcur-0, 49152.0, [12288, 1]
|   | |   
| <-|-|---Qcur-0: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'read': 4.0, 'tempsize': 196608.0}
| | | >---  x: Qcur-0, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-0: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.0.attn_k.weight, 7077888.0, [12288, 1024]
| | >-----  y: attn_norm-0, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-0: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-0, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-0: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-0, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-0: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.0.attn_v.weight, 7077888.0, [12288, 1024]
| | >-----  y: attn_norm-0, 49152.0, [12288, 1]
| |   | | 
| | <-|-|-k_cache_view-0: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l0, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-0: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-0, 4096.0, [128, 8]
| | >-----  y: k_cache_view-0, 2048.0, [1024, 1]
| |     | 
| | <---|-Vcur-0: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-0, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-0: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l0, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-0: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| | >-----  x: Vcur-0, 4096.0, [1, 1024]
| |   >---  y: v_cache_view-0, 2048.0, [1, 1024]
| |       
| | <-----v-0: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l0, 67108864.0, [33554432, 1]
| | |     
| | | <---k-0: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l0, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-0: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
| >-------  x: Qcur-0, 49152.0, [128, 96]
|   | | | 
| <-|-|-|-kq-0: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-0, 65536.0, [128, 32, 8]
| | |   >-  y: q-0, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-0: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'read': 4096.0, 'tempsize': 73728.0}
| >-------  x: kq-0, 12288.0, [32, 1, 96]
|   | |     y: KQ_mask, 4096.0, [32, 32]
|   | |   
| <-|-|---kqv-0: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | >-----  x: v-0, 65536.0, [32, 128, 8]
| |   >---  y: kq_soft_max_ext-0, 12288.0, [32, 1, 96]
| |       
| | <-----kqv_merged-0: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv-0, 49152.0, [128, 1, 96]
|   |     
| <-|-----kqv_merged_cont-0: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| | >-----  x: kqv_merged-0, 49152.0, [128, 96]
| |       
| | <-----kqv_out-0: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.0.attn_output.weight, 84934656.0, [12288, 12288]
| >-------  y: kqv_merged_cont-0, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_inp-0: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| | >-----  x: kqv_out-0, 49152.0, [12288, 1]
>---------  y: inp_embd, 49152.0, [12288, 1]
  |       
<-|-------norm-0: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
| >-------  x: ffn_inp-0, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-0: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-0, 49152.0, [12288, 1]
  | |       y: blk.0.ffn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_gate-0: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.0.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-0, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-0: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
>---------  x: ffn_gate-0, 114688.0, [28672, 1]
  | | |   
<-|-|-|---ffn_up-0: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.0.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-0, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-0: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-0, 114688.0, [28672, 1]
>---------  y: ffn_up-0, 114688.0, [28672, 1]
  | |     
<-|-|-----ffn_out-0: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.0.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-0, 114688.0, [28672, 1]
| |       
| | <-----l_out-0: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
>---------  x: ffn_out-0, 49152.0, [12288, 1]
  >-------  y: ffn_inp-0, 49152.0, [12288, 1]
    |     
    |     == layer 1 ==
    |     
<---|-----norm-1: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-0, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-1: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-1, 49152.0, [12288, 1]
  | |       y: blk.1.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-1: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.1.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-1, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-1: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-1, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-1: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-1, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-1: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.1.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-1, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-1: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-1, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-1: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-1, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-1: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.1.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-1, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-1: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l1, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-1: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-1, 4096.0, [128, 8]
| >-------  y: k_cache_view-1, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-1: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-1, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-1: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l1, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-1: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-1, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-1, 2048.0, [1, 1024]
|   |     
| <-|-----v-1: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l1, 67108864.0, [33554432, 1]
| | |     
| | | <---k-1: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l1, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-1: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-1, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-1: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-1, 65536.0, [128, 32, 8]
| | |   >-  y: q-1, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-1: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-1, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-1: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-1, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-1, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-1: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-1, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-1: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-1, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-1: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.1.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-1, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-1: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-1, 49152.0, [12288, 1]
|   >-----  y: l_out-0, 49152.0, [12288, 1]
|         
| <-------norm-1: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-1, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-1: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-1, 49152.0, [12288, 1]
|   |       y: blk.1.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-1: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.1.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-1, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-1: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-1, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-1: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.1.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-1, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-1: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-1, 114688.0, [28672, 1]
| >-------  y: ffn_up-1, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-1: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.1.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-1, 114688.0, [28672, 1]
| |       
| | <-----l_out-1: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-1, 49152.0, [12288, 1]
>---------  y: ffn_inp-1, 49152.0, [12288, 1]
    |     
    |     == layer 2 ==
    |     
<---|-----norm-2: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-1, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-2: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-2, 49152.0, [12288, 1]
  | |       y: blk.2.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-2: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.2.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-2, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-2: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-2, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-2: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-2, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-2: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.2.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-2, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-2: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-2, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-2: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-2, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-2: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.2.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-2, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-2: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l2, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-2: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-2, 4096.0, [128, 8]
| >-------  y: k_cache_view-2, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-2: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-2, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-2: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l2, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-2: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-2, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-2, 2048.0, [1, 1024]
|   |     
| <-|-----v-2: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l2, 67108864.0, [33554432, 1]
| | |     
| | | <---k-2: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l2, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-2: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-2, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-2: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-2, 65536.0, [128, 32, 8]
| | |   >-  y: q-2, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-2: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-2, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-2: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-2, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-2, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-2: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-2, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-2: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-2, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-2: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.2.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-2, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-2: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-2, 49152.0, [12288, 1]
|   >-----  y: l_out-1, 49152.0, [12288, 1]
|         
| <-------norm-2: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-2, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-2: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-2, 49152.0, [12288, 1]
|   |       y: blk.2.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-2: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.2.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-2, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-2: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-2, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-2: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.2.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-2, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-2: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-2, 114688.0, [28672, 1]
| >-------  y: ffn_up-2, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-2: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.2.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-2, 114688.0, [28672, 1]
| |       
| | <-----l_out-2: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-2, 49152.0, [12288, 1]
>---------  y: ffn_inp-2, 49152.0, [12288, 1]
    |     
    |     == layer 3 ==
    |     
<---|-----norm-3: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-2, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-3: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-3, 49152.0, [12288, 1]
  | |       y: blk.3.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-3: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.3.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-3, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-3: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-3, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-3: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-3, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-3: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.3.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-3, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-3: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-3, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-3: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-3, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-3: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.3.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-3, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-3: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l3, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-3: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-3, 4096.0, [128, 8]
| >-------  y: k_cache_view-3, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-3: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-3, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-3: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l3, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-3: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-3, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-3, 2048.0, [1, 1024]
|   |     
| <-|-----v-3: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l3, 67108864.0, [33554432, 1]
| | |     
| | | <---k-3: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l3, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-3: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-3, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-3: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-3, 65536.0, [128, 32, 8]
| | |   >-  y: q-3, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-3: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-3, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-3: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-3, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-3, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-3: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-3, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-3: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-3, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-3: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.3.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-3, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-3: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-3, 49152.0, [12288, 1]
|   >-----  y: l_out-2, 49152.0, [12288, 1]
|         
| <-------norm-3: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-3, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-3: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-3, 49152.0, [12288, 1]
|   |       y: blk.3.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-3: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.3.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-3, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-3: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-3, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-3: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.3.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-3, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-3: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-3, 114688.0, [28672, 1]
| >-------  y: ffn_up-3, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-3: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.3.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-3, 114688.0, [28672, 1]
| |       
| | <-----l_out-3: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-3, 49152.0, [12288, 1]
>---------  y: ffn_inp-3, 49152.0, [12288, 1]
    |     
    |     == layer 4 ==
    |     
<---|-----norm-4: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-3, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-4: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-4, 49152.0, [12288, 1]
  | |       y: blk.4.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-4: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.4.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-4, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-4: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-4, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-4: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-4, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-4: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.4.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-4, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-4: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-4, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-4: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-4, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-4: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.4.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-4, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-4: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l4, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-4: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-4, 4096.0, [128, 8]
| >-------  y: k_cache_view-4, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-4: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-4, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-4: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l4, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-4: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-4, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-4, 2048.0, [1, 1024]
|   |     
| <-|-----v-4: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l4, 67108864.0, [33554432, 1]
| | |     
| | | <---k-4: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l4, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-4: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-4, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-4: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-4, 65536.0, [128, 32, 8]
| | |   >-  y: q-4, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-4: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-4, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-4: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-4, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-4, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-4: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-4, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-4: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-4, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-4: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.4.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-4, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-4: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-4, 49152.0, [12288, 1]
|   >-----  y: l_out-3, 49152.0, [12288, 1]
|         
| <-------norm-4: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-4, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-4: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-4, 49152.0, [12288, 1]
|   |       y: blk.4.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-4: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.4.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-4, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-4: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-4, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-4: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.4.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-4, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-4: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-4, 114688.0, [28672, 1]
| >-------  y: ffn_up-4, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-4: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.4.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-4, 114688.0, [28672, 1]
| |       
| | <-----l_out-4: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-4, 49152.0, [12288, 1]
>---------  y: ffn_inp-4, 49152.0, [12288, 1]
    |     
    |     == layer 5 ==
    |     
<---|-----norm-5: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-4, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-5: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-5, 49152.0, [12288, 1]
  | |       y: blk.5.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-5: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.5.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-5, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-5: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-5, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-5: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-5, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-5: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.5.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-5, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-5: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-5, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-5: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-5, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-5: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.5.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-5, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-5: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l5, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-5: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-5, 4096.0, [128, 8]
| >-------  y: k_cache_view-5, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-5: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-5, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-5: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l5, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-5: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-5, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-5, 2048.0, [1, 1024]
|   |     
| <-|-----v-5: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l5, 67108864.0, [33554432, 1]
| | |     
| | | <---k-5: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l5, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-5: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-5, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-5: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-5, 65536.0, [128, 32, 8]
| | |   >-  y: q-5, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-5: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-5, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-5: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-5, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-5, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-5: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-5, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-5: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-5, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-5: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.5.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-5, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-5: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-5, 49152.0, [12288, 1]
|   >-----  y: l_out-4, 49152.0, [12288, 1]
|         
| <-------norm-5: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-5, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-5: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-5, 49152.0, [12288, 1]
|   |       y: blk.5.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-5: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.5.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-5, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-5: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-5, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-5: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.5.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-5, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-5: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-5, 114688.0, [28672, 1]
| >-------  y: ffn_up-5, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-5: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.5.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-5, 114688.0, [28672, 1]
| |       
| | <-----l_out-5: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-5, 49152.0, [12288, 1]
>---------  y: ffn_inp-5, 49152.0, [12288, 1]
    |     
    |     == layer 6 ==
    |     
<---|-----norm-6: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-5, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-6: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-6, 49152.0, [12288, 1]
  | |       y: blk.6.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-6: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.6.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-6, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-6: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-6, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-6: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-6, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-6: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.6.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-6, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-6: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-6, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-6: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-6, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-6: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.6.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-6, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-6: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l6, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-6: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-6, 4096.0, [128, 8]
| >-------  y: k_cache_view-6, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-6: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-6, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-6: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l6, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-6: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-6, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-6, 2048.0, [1, 1024]
|   |     
| <-|-----v-6: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l6, 67108864.0, [33554432, 1]
| | |     
| | | <---k-6: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l6, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-6: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-6, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-6: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-6, 65536.0, [128, 32, 8]
| | |   >-  y: q-6, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-6: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-6, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-6: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-6, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-6, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-6: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-6, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-6: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-6, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-6: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.6.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-6, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-6: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-6, 49152.0, [12288, 1]
|   >-----  y: l_out-5, 49152.0, [12288, 1]
|         
| <-------norm-6: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-6, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-6: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-6, 49152.0, [12288, 1]
|   |       y: blk.6.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-6: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.6.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-6, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-6: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-6, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-6: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.6.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-6, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-6: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-6, 114688.0, [28672, 1]
| >-------  y: ffn_up-6, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-6: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.6.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-6, 114688.0, [28672, 1]
| |       
| | <-----l_out-6: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-6, 49152.0, [12288, 1]
>---------  y: ffn_inp-6, 49152.0, [12288, 1]
    |     
    |     == layer 7 ==
    |     
<---|-----norm-7: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-6, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-7: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-7, 49152.0, [12288, 1]
  | |       y: blk.7.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-7: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.7.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-7, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-7: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-7, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-7: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-7, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-7: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.7.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-7, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-7: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-7, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-7: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-7, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-7: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.7.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-7, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-7: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l7, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-7: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-7, 4096.0, [128, 8]
| >-------  y: k_cache_view-7, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-7: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-7, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-7: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l7, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-7: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-7, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-7, 2048.0, [1, 1024]
|   |     
| <-|-----v-7: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l7, 67108864.0, [33554432, 1]
| | |     
| | | <---k-7: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l7, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-7: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-7, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-7: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-7, 65536.0, [128, 32, 8]
| | |   >-  y: q-7, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-7: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-7, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-7: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-7, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-7, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-7: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-7, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-7: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-7, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-7: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.7.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-7, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-7: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-7, 49152.0, [12288, 1]
|   >-----  y: l_out-6, 49152.0, [12288, 1]
|         
| <-------norm-7: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-7, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-7: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-7, 49152.0, [12288, 1]
|   |       y: blk.7.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-7: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.7.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-7, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-7: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-7, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-7: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.7.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-7, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-7: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-7, 114688.0, [28672, 1]
| >-------  y: ffn_up-7, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-7: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.7.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-7, 114688.0, [28672, 1]
| |       
| | <-----l_out-7: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-7, 49152.0, [12288, 1]
>---------  y: ffn_inp-7, 49152.0, [12288, 1]
    |     
    |     == layer 8 ==
    |     
<---|-----norm-8: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-7, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-8: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-8, 49152.0, [12288, 1]
  | |       y: blk.8.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-8: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.8.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-8, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-8: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-8, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-8: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-8, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-8: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.8.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-8, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-8: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-8, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-8: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-8, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-8: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.8.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-8, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-8: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l8, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-8: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-8, 4096.0, [128, 8]
| >-------  y: k_cache_view-8, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-8: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-8, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-8: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l8, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-8: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-8, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-8, 2048.0, [1, 1024]
|   |     
| <-|-----v-8: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l8, 67108864.0, [33554432, 1]
| | |     
| | | <---k-8: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l8, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-8: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-8, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-8: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-8, 65536.0, [128, 32, 8]
| | |   >-  y: q-8, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-8: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-8, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-8: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-8, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-8, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-8: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-8, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-8: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-8, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-8: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.8.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-8, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-8: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-8, 49152.0, [12288, 1]
|   >-----  y: l_out-7, 49152.0, [12288, 1]
|         
| <-------norm-8: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-8, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-8: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-8, 49152.0, [12288, 1]
|   |       y: blk.8.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-8: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.8.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-8, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-8: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-8, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-8: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.8.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-8, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-8: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-8, 114688.0, [28672, 1]
| >-------  y: ffn_up-8, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-8: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.8.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-8, 114688.0, [28672, 1]
| |       
| | <-----l_out-8: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-8, 49152.0, [12288, 1]
>---------  y: ffn_inp-8, 49152.0, [12288, 1]
    |     
    |     == layer 9 ==
    |     
<---|-----norm-9: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-8, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-9: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-9, 49152.0, [12288, 1]
  | |       y: blk.9.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-9: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.9.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-9, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-9: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-9, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-9: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-9, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-9: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.9.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-9, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-9: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-9, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-9: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-9, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-9: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.9.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-9, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-9: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l9, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-9: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-9, 4096.0, [128, 8]
| >-------  y: k_cache_view-9, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-9: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-9, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-9: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l9, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-9: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-9, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-9, 2048.0, [1, 1024]
|   |     
| <-|-----v-9: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l9, 67108864.0, [33554432, 1]
| | |     
| | | <---k-9: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l9, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-9: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-9, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-9: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-9, 65536.0, [128, 32, 8]
| | |   >-  y: q-9, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-9: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-9, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-9: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-9, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-9, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-9: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-9, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-9: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-9, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-9: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.9.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-9, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-9: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-9, 49152.0, [12288, 1]
|   >-----  y: l_out-8, 49152.0, [12288, 1]
|         
| <-------norm-9: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-9, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-9: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-9, 49152.0, [12288, 1]
|   |       y: blk.9.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-9: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.9.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-9, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-9: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-9, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-9: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.9.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-9, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-9: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-9, 114688.0, [28672, 1]
| >-------  y: ffn_up-9, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-9: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.9.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-9, 114688.0, [28672, 1]
| |       
| | <-----l_out-9: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-9, 49152.0, [12288, 1]
>---------  y: ffn_inp-9, 49152.0, [12288, 1]
    |     
    |     == layer 10 ==
    |     
<---|-----norm-10: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-9, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-10: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-10, 49152.0, [12288, 1]
  | |       y: blk.10.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-10: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.10.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-10, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-10: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-10, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-10: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-10, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-10: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.10.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-10, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-10: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-10, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-10: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-10, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-10: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.10.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-10, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-10: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l10, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-10: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-10, 4096.0, [128, 8]
| >-------  y: k_cache_view-10, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-10: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-10, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-10: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l10, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-10: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-10, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-10, 2048.0, [1, 1024]
|   |     
| <-|-----v-10: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l10, 67108864.0, [33554432, 1]
| | |     
| | | <---k-10: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l10, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-10: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-10, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-10: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-10, 65536.0, [128, 32, 8]
| | |   >-  y: q-10, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-10: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-10, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-10: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-10, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-10, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-10: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-10, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-10: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-10, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-10: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.10.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-10, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-10: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-10, 49152.0, [12288, 1]
|   >-----  y: l_out-9, 49152.0, [12288, 1]
|         
| <-------norm-10: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-10, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-10: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-10, 49152.0, [12288, 1]
|   |       y: blk.10.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-10: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.10.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-10, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-10: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-10, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-10: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.10.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-10, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-10: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-10, 114688.0, [28672, 1]
| >-------  y: ffn_up-10, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-10: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.10.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-10, 114688.0, [28672, 1]
| |       
| | <-----l_out-10: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-10, 49152.0, [12288, 1]
>---------  y: ffn_inp-10, 49152.0, [12288, 1]
    |     
    |     == layer 11 ==
    |     
<---|-----norm-11: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-10, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-11: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-11, 49152.0, [12288, 1]
  | |       y: blk.11.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-11: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.11.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-11, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-11: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-11, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-11: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-11, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-11: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.11.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-11, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-11: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-11, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-11: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-11, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-11: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.11.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-11, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-11: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l11, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-11: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-11, 4096.0, [128, 8]
| >-------  y: k_cache_view-11, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-11: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-11, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-11: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l11, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-11: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-11, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-11, 2048.0, [1, 1024]
|   |     
| <-|-----v-11: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l11, 67108864.0, [33554432, 1]
| | |     
| | | <---k-11: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l11, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-11: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-11, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-11: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-11, 65536.0, [128, 32, 8]
| | |   >-  y: q-11, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-11: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-11, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-11: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-11, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-11, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-11: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-11, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-11: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-11, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-11: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.11.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-11, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-11: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-11, 49152.0, [12288, 1]
|   >-----  y: l_out-10, 49152.0, [12288, 1]
|         
| <-------norm-11: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-11, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-11: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-11, 49152.0, [12288, 1]
|   |       y: blk.11.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-11: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.11.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-11, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-11: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-11, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-11: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.11.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-11, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-11: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-11, 114688.0, [28672, 1]
| >-------  y: ffn_up-11, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-11: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.11.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-11, 114688.0, [28672, 1]
| |       
| | <-----l_out-11: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-11, 49152.0, [12288, 1]
>---------  y: ffn_inp-11, 49152.0, [12288, 1]
    |     
    |     == layer 12 ==
    |     
<---|-----norm-12: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-11, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-12: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-12, 49152.0, [12288, 1]
  | |       y: blk.12.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-12: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.12.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-12, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-12: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-12, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-12: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-12, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-12: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.12.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-12, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-12: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-12, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-12: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-12, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-12: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.12.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-12, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-12: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l12, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-12: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-12, 4096.0, [128, 8]
| >-------  y: k_cache_view-12, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-12: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-12, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-12: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l12, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-12: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-12, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-12, 2048.0, [1, 1024]
|   |     
| <-|-----v-12: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l12, 67108864.0, [33554432, 1]
| | |     
| | | <---k-12: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l12, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-12: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-12, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-12: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-12, 65536.0, [128, 32, 8]
| | |   >-  y: q-12, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-12: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-12, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-12: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-12, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-12, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-12: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-12, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-12: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-12, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-12: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.12.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-12, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-12: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-12, 49152.0, [12288, 1]
|   >-----  y: l_out-11, 49152.0, [12288, 1]
|         
| <-------norm-12: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-12, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-12: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-12, 49152.0, [12288, 1]
|   |       y: blk.12.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-12: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.12.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-12, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-12: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-12, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-12: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.12.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-12, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-12: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-12, 114688.0, [28672, 1]
| >-------  y: ffn_up-12, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-12: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.12.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-12, 114688.0, [28672, 1]
| |       
| | <-----l_out-12: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-12, 49152.0, [12288, 1]
>---------  y: ffn_inp-12, 49152.0, [12288, 1]
    |     
    |     == layer 13 ==
    |     
<---|-----norm-13: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-12, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-13: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-13, 49152.0, [12288, 1]
  | |       y: blk.13.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-13: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.13.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-13, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-13: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-13, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-13: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-13, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-13: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.13.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-13, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-13: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-13, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-13: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-13, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-13: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.13.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-13, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-13: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l13, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-13: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-13, 4096.0, [128, 8]
| >-------  y: k_cache_view-13, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-13: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-13, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-13: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l13, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-13: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-13, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-13, 2048.0, [1, 1024]
|   |     
| <-|-----v-13: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l13, 67108864.0, [33554432, 1]
| | |     
| | | <---k-13: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l13, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-13: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-13, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-13: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-13, 65536.0, [128, 32, 8]
| | |   >-  y: q-13, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-13: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-13, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-13: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-13, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-13, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-13: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-13, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-13: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-13, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-13: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.13.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-13, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-13: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-13, 49152.0, [12288, 1]
|   >-----  y: l_out-12, 49152.0, [12288, 1]
|         
| <-------norm-13: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-13, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-13: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-13, 49152.0, [12288, 1]
|   |       y: blk.13.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-13: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.13.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-13, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-13: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-13, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-13: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.13.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-13, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-13: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-13, 114688.0, [28672, 1]
| >-------  y: ffn_up-13, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-13: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.13.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-13, 114688.0, [28672, 1]
| |       
| | <-----l_out-13: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-13, 49152.0, [12288, 1]
>---------  y: ffn_inp-13, 49152.0, [12288, 1]
    |     
    |     == layer 14 ==
    |     
<---|-----norm-14: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-13, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-14: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-14, 49152.0, [12288, 1]
  | |       y: blk.14.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-14: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.14.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-14, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-14: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-14, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-14: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-14, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-14: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.14.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-14, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-14: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-14, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-14: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-14, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-14: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.14.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-14, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-14: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l14, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-14: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-14, 4096.0, [128, 8]
| >-------  y: k_cache_view-14, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-14: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-14, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-14: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l14, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-14: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-14, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-14, 2048.0, [1, 1024]
|   |     
| <-|-----v-14: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l14, 67108864.0, [33554432, 1]
| | |     
| | | <---k-14: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l14, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-14: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-14, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-14: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-14, 65536.0, [128, 32, 8]
| | |   >-  y: q-14, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-14: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-14, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-14: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-14, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-14, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-14: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-14, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-14: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-14, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-14: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.14.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-14, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-14: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-14, 49152.0, [12288, 1]
|   >-----  y: l_out-13, 49152.0, [12288, 1]
|         
| <-------norm-14: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-14, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-14: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-14, 49152.0, [12288, 1]
|   |       y: blk.14.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-14: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.14.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-14, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-14: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-14, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-14: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.14.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-14, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-14: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-14, 114688.0, [28672, 1]
| >-------  y: ffn_up-14, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-14: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.14.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-14, 114688.0, [28672, 1]
| |       
| | <-----l_out-14: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-14, 49152.0, [12288, 1]
>---------  y: ffn_inp-14, 49152.0, [12288, 1]
    |     
    |     == layer 15 ==
    |     
<---|-----norm-15: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-14, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-15: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-15, 49152.0, [12288, 1]
  | |       y: blk.15.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-15: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.15.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-15, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-15: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-15, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-15: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-15, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-15: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.15.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-15, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-15: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-15, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-15: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-15, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-15: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.15.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-15, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-15: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l15, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-15: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-15, 4096.0, [128, 8]
| >-------  y: k_cache_view-15, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-15: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-15, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-15: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l15, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-15: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-15, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-15, 2048.0, [1, 1024]
|   |     
| <-|-----v-15: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l15, 67108864.0, [33554432, 1]
| | |     
| | | <---k-15: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l15, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-15: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-15, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-15: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-15, 65536.0, [128, 32, 8]
| | |   >-  y: q-15, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-15: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-15, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-15: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-15, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-15, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-15: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-15, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-15: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-15, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-15: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.15.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-15, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-15: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-15, 49152.0, [12288, 1]
|   >-----  y: l_out-14, 49152.0, [12288, 1]
|         
| <-------norm-15: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-15, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-15: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-15, 49152.0, [12288, 1]
|   |       y: blk.15.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-15: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.15.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-15, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-15: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-15, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-15: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.15.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-15, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-15: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-15, 114688.0, [28672, 1]
| >-------  y: ffn_up-15, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-15: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.15.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-15, 114688.0, [28672, 1]
| |       
| | <-----l_out-15: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-15, 49152.0, [12288, 1]
>---------  y: ffn_inp-15, 49152.0, [12288, 1]
    |     
    |     == layer 16 ==
    |     
<---|-----norm-16: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-15, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-16: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-16, 49152.0, [12288, 1]
  | |       y: blk.16.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-16: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.16.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-16, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-16: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-16, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-16: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-16, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-16: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.16.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-16, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-16: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-16, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-16: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-16, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-16: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.16.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-16, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-16: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l16, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-16: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-16, 4096.0, [128, 8]
| >-------  y: k_cache_view-16, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-16: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-16, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-16: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l16, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-16: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-16, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-16, 2048.0, [1, 1024]
|   |     
| <-|-----v-16: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l16, 67108864.0, [33554432, 1]
| | |     
| | | <---k-16: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l16, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-16: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-16, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-16: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-16, 65536.0, [128, 32, 8]
| | |   >-  y: q-16, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-16: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-16, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-16: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-16, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-16, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-16: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-16, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-16: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-16, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-16: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.16.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-16, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-16: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-16, 49152.0, [12288, 1]
|   >-----  y: l_out-15, 49152.0, [12288, 1]
|         
| <-------norm-16: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-16, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-16: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-16, 49152.0, [12288, 1]
|   |       y: blk.16.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-16: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.16.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-16, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-16: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-16, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-16: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.16.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-16, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-16: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-16, 114688.0, [28672, 1]
| >-------  y: ffn_up-16, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-16: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.16.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-16, 114688.0, [28672, 1]
| |       
| | <-----l_out-16: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-16, 49152.0, [12288, 1]
>---------  y: ffn_inp-16, 49152.0, [12288, 1]
    |     
    |     == layer 17 ==
    |     
<---|-----norm-17: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-16, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-17: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-17, 49152.0, [12288, 1]
  | |       y: blk.17.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-17: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.17.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-17, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-17: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-17, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-17: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-17, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-17: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.17.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-17, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-17: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-17, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-17: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-17, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-17: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.17.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-17, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-17: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l17, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-17: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-17, 4096.0, [128, 8]
| >-------  y: k_cache_view-17, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-17: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-17, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-17: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l17, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-17: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-17, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-17, 2048.0, [1, 1024]
|   |     
| <-|-----v-17: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l17, 67108864.0, [33554432, 1]
| | |     
| | | <---k-17: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l17, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-17: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-17, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-17: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-17, 65536.0, [128, 32, 8]
| | |   >-  y: q-17, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-17: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-17, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-17: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-17, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-17, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-17: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-17, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-17: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-17, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-17: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.17.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-17, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-17: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-17, 49152.0, [12288, 1]
|   >-----  y: l_out-16, 49152.0, [12288, 1]
|         
| <-------norm-17: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-17, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-17: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-17, 49152.0, [12288, 1]
|   |       y: blk.17.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-17: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.17.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-17, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-17: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-17, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-17: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.17.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-17, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-17: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-17, 114688.0, [28672, 1]
| >-------  y: ffn_up-17, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-17: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.17.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-17, 114688.0, [28672, 1]
| |       
| | <-----l_out-17: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-17, 49152.0, [12288, 1]
>---------  y: ffn_inp-17, 49152.0, [12288, 1]
    |     
    |     == layer 18 ==
    |     
<---|-----norm-18: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-17, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-18: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-18, 49152.0, [12288, 1]
  | |       y: blk.18.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-18: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.18.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-18, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-18: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-18, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-18: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-18, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-18: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.18.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-18, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-18: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-18, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-18: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-18, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-18: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.18.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-18, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-18: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l18, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-18: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-18, 4096.0, [128, 8]
| >-------  y: k_cache_view-18, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-18: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-18, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-18: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l18, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-18: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-18, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-18, 2048.0, [1, 1024]
|   |     
| <-|-----v-18: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l18, 67108864.0, [33554432, 1]
| | |     
| | | <---k-18: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l18, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-18: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-18, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-18: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-18, 65536.0, [128, 32, 8]
| | |   >-  y: q-18, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-18: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-18, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-18: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-18, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-18, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-18: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-18, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-18: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-18, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-18: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.18.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-18, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-18: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-18, 49152.0, [12288, 1]
|   >-----  y: l_out-17, 49152.0, [12288, 1]
|         
| <-------norm-18: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-18, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-18: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-18, 49152.0, [12288, 1]
|   |       y: blk.18.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-18: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.18.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-18, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-18: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-18, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-18: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.18.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-18, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-18: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-18, 114688.0, [28672, 1]
| >-------  y: ffn_up-18, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-18: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.18.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-18, 114688.0, [28672, 1]
| |       
| | <-----l_out-18: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-18, 49152.0, [12288, 1]
>---------  y: ffn_inp-18, 49152.0, [12288, 1]
    |     
    |     == layer 19 ==
    |     
<---|-----norm-19: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-18, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-19: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-19, 49152.0, [12288, 1]
  | |       y: blk.19.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-19: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.19.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-19, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-19: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-19, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-19: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-19, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-19: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.19.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-19, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-19: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-19, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-19: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-19, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-19: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.19.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-19, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-19: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l19, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-19: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-19, 4096.0, [128, 8]
| >-------  y: k_cache_view-19, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-19: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-19, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-19: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l19, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-19: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-19, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-19, 2048.0, [1, 1024]
|   |     
| <-|-----v-19: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l19, 67108864.0, [33554432, 1]
| | |     
| | | <---k-19: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l19, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-19: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-19, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-19: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-19, 65536.0, [128, 32, 8]
| | |   >-  y: q-19, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-19: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-19, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-19: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-19, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-19, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-19: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-19, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-19: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-19, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-19: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.19.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-19, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-19: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-19, 49152.0, [12288, 1]
|   >-----  y: l_out-18, 49152.0, [12288, 1]
|         
| <-------norm-19: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-19, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-19: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-19, 49152.0, [12288, 1]
|   |       y: blk.19.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-19: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.19.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-19, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-19: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-19, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-19: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.19.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-19, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-19: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-19, 114688.0, [28672, 1]
| >-------  y: ffn_up-19, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-19: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.19.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-19, 114688.0, [28672, 1]
| |       
| | <-----l_out-19: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-19, 49152.0, [12288, 1]
>---------  y: ffn_inp-19, 49152.0, [12288, 1]
    |     
    |     == layer 20 ==
    |     
<---|-----norm-20: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-19, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-20: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-20, 49152.0, [12288, 1]
  | |       y: blk.20.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-20: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.20.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-20, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-20: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-20, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-20: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-20, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-20: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.20.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-20, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-20: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-20, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-20: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-20, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-20: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.20.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-20, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-20: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l20, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-20: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-20, 4096.0, [128, 8]
| >-------  y: k_cache_view-20, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-20: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-20, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-20: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l20, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-20: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-20, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-20, 2048.0, [1, 1024]
|   |     
| <-|-----v-20: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l20, 67108864.0, [33554432, 1]
| | |     
| | | <---k-20: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l20, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-20: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-20, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-20: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-20, 65536.0, [128, 32, 8]
| | |   >-  y: q-20, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-20: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-20, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-20: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-20, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-20, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-20: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-20, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-20: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-20, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-20: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.20.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-20, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-20: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-20, 49152.0, [12288, 1]
|   >-----  y: l_out-19, 49152.0, [12288, 1]
|         
| <-------norm-20: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-20, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-20: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-20, 49152.0, [12288, 1]
|   |       y: blk.20.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-20: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.20.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-20, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-20: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-20, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-20: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.20.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-20, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-20: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-20, 114688.0, [28672, 1]
| >-------  y: ffn_up-20, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-20: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.20.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-20, 114688.0, [28672, 1]
| |       
| | <-----l_out-20: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-20, 49152.0, [12288, 1]
>---------  y: ffn_inp-20, 49152.0, [12288, 1]
    |     
    |     == layer 21 ==
    |     
<---|-----norm-21: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-20, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-21: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-21, 49152.0, [12288, 1]
  | |       y: blk.21.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-21: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.21.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-21, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-21: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-21, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-21: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-21, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-21: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.21.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-21, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-21: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-21, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-21: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-21, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-21: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.21.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-21, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-21: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l21, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-21: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-21, 4096.0, [128, 8]
| >-------  y: k_cache_view-21, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-21: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-21, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-21: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l21, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-21: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-21, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-21, 2048.0, [1, 1024]
|   |     
| <-|-----v-21: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l21, 67108864.0, [33554432, 1]
| | |     
| | | <---k-21: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l21, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-21: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-21, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-21: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-21, 65536.0, [128, 32, 8]
| | |   >-  y: q-21, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-21: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-21, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-21: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-21, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-21, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-21: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-21, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-21: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-21, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-21: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.21.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-21, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-21: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-21, 49152.0, [12288, 1]
|   >-----  y: l_out-20, 49152.0, [12288, 1]
|         
| <-------norm-21: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-21, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-21: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-21, 49152.0, [12288, 1]
|   |       y: blk.21.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-21: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.21.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-21, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-21: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-21, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-21: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.21.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-21, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-21: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-21, 114688.0, [28672, 1]
| >-------  y: ffn_up-21, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-21: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.21.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-21, 114688.0, [28672, 1]
| |       
| | <-----l_out-21: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-21, 49152.0, [12288, 1]
>---------  y: ffn_inp-21, 49152.0, [12288, 1]
    |     
    |     == layer 22 ==
    |     
<---|-----norm-22: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-21, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-22: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-22, 49152.0, [12288, 1]
  | |       y: blk.22.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-22: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.22.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-22, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-22: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-22, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-22: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-22, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-22: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.22.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-22, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-22: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-22, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-22: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-22, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-22: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.22.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-22, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-22: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l22, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-22: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-22, 4096.0, [128, 8]
| >-------  y: k_cache_view-22, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-22: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-22, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-22: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l22, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-22: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-22, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-22, 2048.0, [1, 1024]
|   |     
| <-|-----v-22: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l22, 67108864.0, [33554432, 1]
| | |     
| | | <---k-22: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l22, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-22: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-22, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-22: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-22, 65536.0, [128, 32, 8]
| | |   >-  y: q-22, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-22: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-22, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-22: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-22, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-22, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-22: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-22, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-22: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-22, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-22: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.22.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-22, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-22: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-22, 49152.0, [12288, 1]
|   >-----  y: l_out-21, 49152.0, [12288, 1]
|         
| <-------norm-22: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-22, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-22: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-22, 49152.0, [12288, 1]
|   |       y: blk.22.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-22: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.22.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-22, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-22: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-22, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-22: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.22.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-22, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-22: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-22, 114688.0, [28672, 1]
| >-------  y: ffn_up-22, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-22: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.22.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-22, 114688.0, [28672, 1]
| |       
| | <-----l_out-22: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-22, 49152.0, [12288, 1]
>---------  y: ffn_inp-22, 49152.0, [12288, 1]
    |     
    |     == layer 23 ==
    |     
<---|-----norm-23: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-22, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-23: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-23, 49152.0, [12288, 1]
  | |       y: blk.23.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-23: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.23.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-23, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-23: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-23, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-23: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-23, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-23: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.23.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-23, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-23: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-23, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-23: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-23, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-23: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.23.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-23, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-23: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l23, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-23: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-23, 4096.0, [128, 8]
| >-------  y: k_cache_view-23, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-23: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-23, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-23: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l23, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-23: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-23, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-23, 2048.0, [1, 1024]
|   |     
| <-|-----v-23: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l23, 67108864.0, [33554432, 1]
| | |     
| | | <---k-23: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l23, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-23: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-23, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-23: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-23, 65536.0, [128, 32, 8]
| | |   >-  y: q-23, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-23: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-23, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-23: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-23, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-23, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-23: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-23, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-23: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-23, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-23: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.23.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-23, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-23: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-23, 49152.0, [12288, 1]
|   >-----  y: l_out-22, 49152.0, [12288, 1]
|         
| <-------norm-23: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-23, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-23: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-23, 49152.0, [12288, 1]
|   |       y: blk.23.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-23: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.23.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-23, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-23: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-23, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-23: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.23.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-23, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-23: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-23, 114688.0, [28672, 1]
| >-------  y: ffn_up-23, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-23: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.23.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-23, 114688.0, [28672, 1]
| |       
| | <-----l_out-23: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-23, 49152.0, [12288, 1]
>---------  y: ffn_inp-23, 49152.0, [12288, 1]
    |     
    |     == layer 24 ==
    |     
<---|-----norm-24: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-23, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-24: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-24, 49152.0, [12288, 1]
  | |       y: blk.24.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-24: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.24.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-24, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-24: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-24, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-24: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-24, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-24: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.24.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-24, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-24: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-24, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-24: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-24, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-24: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.24.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-24, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-24: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l24, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-24: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-24, 4096.0, [128, 8]
| >-------  y: k_cache_view-24, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-24: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-24, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-24: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l24, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-24: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-24, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-24, 2048.0, [1, 1024]
|   |     
| <-|-----v-24: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l24, 67108864.0, [33554432, 1]
| | |     
| | | <---k-24: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l24, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-24: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-24, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-24: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-24, 65536.0, [128, 32, 8]
| | |   >-  y: q-24, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-24: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-24, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-24: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-24, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-24, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-24: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-24, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-24: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-24, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-24: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.24.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-24, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-24: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-24, 49152.0, [12288, 1]
|   >-----  y: l_out-23, 49152.0, [12288, 1]
|         
| <-------norm-24: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-24, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-24: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-24, 49152.0, [12288, 1]
|   |       y: blk.24.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-24: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.24.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-24, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-24: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-24, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-24: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.24.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-24, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-24: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-24, 114688.0, [28672, 1]
| >-------  y: ffn_up-24, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-24: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.24.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-24, 114688.0, [28672, 1]
| |       
| | <-----l_out-24: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-24, 49152.0, [12288, 1]
>---------  y: ffn_inp-24, 49152.0, [12288, 1]
    |     
    |     == layer 25 ==
    |     
<---|-----norm-25: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-24, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-25: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-25, 49152.0, [12288, 1]
  | |       y: blk.25.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-25: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.25.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-25, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-25: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-25, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-25: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-25, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-25: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.25.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-25, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-25: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-25, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-25: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-25, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-25: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.25.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-25, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-25: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l25, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-25: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-25, 4096.0, [128, 8]
| >-------  y: k_cache_view-25, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-25: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-25, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-25: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l25, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-25: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-25, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-25, 2048.0, [1, 1024]
|   |     
| <-|-----v-25: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l25, 67108864.0, [33554432, 1]
| | |     
| | | <---k-25: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l25, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-25: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-25, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-25: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-25, 65536.0, [128, 32, 8]
| | |   >-  y: q-25, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-25: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-25, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-25: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-25, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-25, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-25: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-25, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-25: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-25, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-25: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.25.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-25, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-25: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-25, 49152.0, [12288, 1]
|   >-----  y: l_out-24, 49152.0, [12288, 1]
|         
| <-------norm-25: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-25, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-25: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-25, 49152.0, [12288, 1]
|   |       y: blk.25.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-25: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.25.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-25, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-25: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-25, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-25: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.25.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-25, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-25: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-25, 114688.0, [28672, 1]
| >-------  y: ffn_up-25, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-25: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.25.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-25, 114688.0, [28672, 1]
| |       
| | <-----l_out-25: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-25, 49152.0, [12288, 1]
>---------  y: ffn_inp-25, 49152.0, [12288, 1]
    |     
    |     == layer 26 ==
    |     
<---|-----norm-26: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-25, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-26: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-26, 49152.0, [12288, 1]
  | |       y: blk.26.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-26: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.26.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-26, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-26: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-26, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-26: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-26, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-26: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.26.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-26, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-26: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-26, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-26: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-26, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-26: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.26.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-26, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-26: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l26, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-26: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-26, 4096.0, [128, 8]
| >-------  y: k_cache_view-26, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-26: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-26, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-26: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l26, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-26: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-26, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-26, 2048.0, [1, 1024]
|   |     
| <-|-----v-26: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l26, 67108864.0, [33554432, 1]
| | |     
| | | <---k-26: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l26, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-26: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-26, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-26: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-26, 65536.0, [128, 32, 8]
| | |   >-  y: q-26, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-26: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-26, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-26: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-26, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-26, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-26: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-26, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-26: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-26, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-26: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.26.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-26, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-26: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-26, 49152.0, [12288, 1]
|   >-----  y: l_out-25, 49152.0, [12288, 1]
|         
| <-------norm-26: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-26, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-26: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-26, 49152.0, [12288, 1]
|   |       y: blk.26.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-26: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.26.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-26, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-26: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-26, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-26: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.26.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-26, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-26: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-26, 114688.0, [28672, 1]
| >-------  y: ffn_up-26, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-26: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.26.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-26, 114688.0, [28672, 1]
| |       
| | <-----l_out-26: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-26, 49152.0, [12288, 1]
>---------  y: ffn_inp-26, 49152.0, [12288, 1]
    |     
    |     == layer 27 ==
    |     
<---|-----norm-27: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-26, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-27: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-27, 49152.0, [12288, 1]
  | |       y: blk.27.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-27: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.27.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-27, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-27: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-27, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-27: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-27, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-27: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.27.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-27, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-27: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-27, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-27: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-27, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-27: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.27.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-27, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-27: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l27, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-27: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-27, 4096.0, [128, 8]
| >-------  y: k_cache_view-27, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-27: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-27, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-27: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l27, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-27: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-27, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-27, 2048.0, [1, 1024]
|   |     
| <-|-----v-27: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l27, 67108864.0, [33554432, 1]
| | |     
| | | <---k-27: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l27, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-27: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-27, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-27: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-27, 65536.0, [128, 32, 8]
| | |   >-  y: q-27, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-27: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-27, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-27: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-27, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-27, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-27: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-27, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-27: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-27, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-27: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.27.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-27, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-27: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-27, 49152.0, [12288, 1]
|   >-----  y: l_out-26, 49152.0, [12288, 1]
|         
| <-------norm-27: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-27, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-27: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-27, 49152.0, [12288, 1]
|   |       y: blk.27.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-27: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.27.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-27, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-27: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-27, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-27: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.27.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-27, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-27: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-27, 114688.0, [28672, 1]
| >-------  y: ffn_up-27, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-27: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.27.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-27, 114688.0, [28672, 1]
| |       
| | <-----l_out-27: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-27, 49152.0, [12288, 1]
>---------  y: ffn_inp-27, 49152.0, [12288, 1]
    |     
    |     == layer 28 ==
    |     
<---|-----norm-28: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-27, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-28: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-28, 49152.0, [12288, 1]
  | |       y: blk.28.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-28: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.28.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-28, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-28: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-28, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-28: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-28, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-28: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.28.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-28, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-28: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-28, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-28: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-28, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-28: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.28.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-28, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-28: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l28, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-28: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-28, 4096.0, [128, 8]
| >-------  y: k_cache_view-28, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-28: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-28, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-28: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l28, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-28: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-28, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-28, 2048.0, [1, 1024]
|   |     
| <-|-----v-28: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l28, 67108864.0, [33554432, 1]
| | |     
| | | <---k-28: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l28, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-28: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-28, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-28: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-28, 65536.0, [128, 32, 8]
| | |   >-  y: q-28, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-28: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-28, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-28: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-28, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-28, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-28: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-28, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-28: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-28, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-28: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.28.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-28, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-28: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-28, 49152.0, [12288, 1]
|   >-----  y: l_out-27, 49152.0, [12288, 1]
|         
| <-------norm-28: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-28, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-28: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-28, 49152.0, [12288, 1]
|   |       y: blk.28.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-28: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.28.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-28, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-28: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-28, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-28: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.28.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-28, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-28: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-28, 114688.0, [28672, 1]
| >-------  y: ffn_up-28, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-28: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.28.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-28, 114688.0, [28672, 1]
| |       
| | <-----l_out-28: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-28, 49152.0, [12288, 1]
>---------  y: ffn_inp-28, 49152.0, [12288, 1]
    |     
    |     == layer 29 ==
    |     
<---|-----norm-29: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-28, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-29: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-29, 49152.0, [12288, 1]
  | |       y: blk.29.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-29: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.29.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-29, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-29: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-29, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-29: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-29, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-29: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.29.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-29, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-29: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-29, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-29: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-29, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-29: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.29.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-29, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-29: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l29, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-29: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-29, 4096.0, [128, 8]
| >-------  y: k_cache_view-29, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-29: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-29, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-29: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l29, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-29: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-29, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-29, 2048.0, [1, 1024]
|   |     
| <-|-----v-29: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l29, 67108864.0, [33554432, 1]
| | |     
| | | <---k-29: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l29, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-29: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-29, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-29: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-29, 65536.0, [128, 32, 8]
| | |   >-  y: q-29, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-29: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-29, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-29: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-29, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-29, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-29: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-29, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-29: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-29, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-29: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.29.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-29, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-29: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-29, 49152.0, [12288, 1]
|   >-----  y: l_out-28, 49152.0, [12288, 1]
|         
| <-------norm-29: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-29, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-29: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-29, 49152.0, [12288, 1]
|   |       y: blk.29.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-29: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.29.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-29, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-29: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-29, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-29: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.29.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-29, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-29: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-29, 114688.0, [28672, 1]
| >-------  y: ffn_up-29, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-29: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.29.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-29, 114688.0, [28672, 1]
| |       
| | <-----l_out-29: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-29, 49152.0, [12288, 1]
>---------  y: ffn_inp-29, 49152.0, [12288, 1]
    |     
    |     == layer 30 ==
    |     
<---|-----norm-30: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-29, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-30: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-30, 49152.0, [12288, 1]
  | |       y: blk.30.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-30: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.30.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-30, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-30: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-30, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-30: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-30, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-30: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.30.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-30, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-30: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-30, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-30: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-30, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-30: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.30.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-30, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-30: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l30, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-30: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-30, 4096.0, [128, 8]
| >-------  y: k_cache_view-30, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-30: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-30, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-30: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l30, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-30: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-30, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-30, 2048.0, [1, 1024]
|   |     
| <-|-----v-30: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l30, 67108864.0, [33554432, 1]
| | |     
| | | <---k-30: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l30, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-30: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-30, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-30: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-30, 65536.0, [128, 32, 8]
| | |   >-  y: q-30, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-30: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-30, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-30: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-30, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-30, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-30: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-30, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-30: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-30, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-30: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.30.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-30, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-30: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-30, 49152.0, [12288, 1]
|   >-----  y: l_out-29, 49152.0, [12288, 1]
|         
| <-------norm-30: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-30, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-30: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-30, 49152.0, [12288, 1]
|   |       y: blk.30.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-30: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.30.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-30, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-30: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-30, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-30: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.30.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-30, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-30: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-30, 114688.0, [28672, 1]
| >-------  y: ffn_up-30, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-30: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.30.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-30, 114688.0, [28672, 1]
| |       
| | <-----l_out-30: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-30, 49152.0, [12288, 1]
>---------  y: ffn_inp-30, 49152.0, [12288, 1]
    |     
    |     == layer 31 ==
    |     
<---|-----norm-31: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-30, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-31: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-31, 49152.0, [12288, 1]
  | |       y: blk.31.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-31: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.31.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-31, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-31: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-31, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-31: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-31, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-31: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.31.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-31, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-31: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-31, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-31: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-31, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-31: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.31.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-31, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-31: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l31, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-31: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-31, 4096.0, [128, 8]
| >-------  y: k_cache_view-31, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-31: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-31, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-31: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l31, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-31: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-31, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-31, 2048.0, [1, 1024]
|   |     
| <-|-----v-31: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l31, 67108864.0, [33554432, 1]
| | |     
| | | <---k-31: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l31, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-31: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-31, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-31: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-31, 65536.0, [128, 32, 8]
| | |   >-  y: q-31, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-31: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-31, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-31: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-31, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-31, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-31: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-31, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-31: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-31, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-31: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.31.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-31, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-31: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-31, 49152.0, [12288, 1]
|   >-----  y: l_out-30, 49152.0, [12288, 1]
|         
| <-------norm-31: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-31, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-31: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-31, 49152.0, [12288, 1]
|   |       y: blk.31.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-31: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.31.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-31, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-31: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-31, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-31: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.31.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-31, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-31: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-31, 114688.0, [28672, 1]
| >-------  y: ffn_up-31, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-31: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.31.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-31, 114688.0, [28672, 1]
| |       
| | <-----l_out-31: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-31, 49152.0, [12288, 1]
>---------  y: ffn_inp-31, 49152.0, [12288, 1]
    |     
    |     == layer 32 ==
    |     
<---|-----norm-32: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-31, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-32: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-32, 49152.0, [12288, 1]
  | |       y: blk.32.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-32: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.32.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-32, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-32: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-32, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-32: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-32, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-32: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.32.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-32, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-32: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-32, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-32: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-32, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-32: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.32.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-32, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-32: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l32, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-32: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-32, 4096.0, [128, 8]
| >-------  y: k_cache_view-32, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-32: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-32, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-32: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l32, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-32: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-32, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-32, 2048.0, [1, 1024]
|   |     
| <-|-----v-32: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l32, 67108864.0, [33554432, 1]
| | |     
| | | <---k-32: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l32, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-32: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-32, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-32: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-32, 65536.0, [128, 32, 8]
| | |   >-  y: q-32, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-32: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-32, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-32: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-32, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-32, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-32: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-32, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-32: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-32, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-32: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.32.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-32, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-32: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-32, 49152.0, [12288, 1]
|   >-----  y: l_out-31, 49152.0, [12288, 1]
|         
| <-------norm-32: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-32, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-32: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-32, 49152.0, [12288, 1]
|   |       y: blk.32.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-32: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.32.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-32, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-32: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-32, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-32: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.32.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-32, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-32: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-32, 114688.0, [28672, 1]
| >-------  y: ffn_up-32, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-32: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.32.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-32, 114688.0, [28672, 1]
| |       
| | <-----l_out-32: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-32, 49152.0, [12288, 1]
>---------  y: ffn_inp-32, 49152.0, [12288, 1]
    |     
    |     == layer 33 ==
    |     
<---|-----norm-33: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-32, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-33: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-33, 49152.0, [12288, 1]
  | |       y: blk.33.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-33: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.33.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-33, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-33: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-33, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-33: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-33, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-33: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.33.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-33, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-33: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-33, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-33: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-33, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-33: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.33.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-33, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-33: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l33, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-33: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-33, 4096.0, [128, 8]
| >-------  y: k_cache_view-33, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-33: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-33, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-33: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l33, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-33: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-33, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-33, 2048.0, [1, 1024]
|   |     
| <-|-----v-33: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l33, 67108864.0, [33554432, 1]
| | |     
| | | <---k-33: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l33, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-33: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-33, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-33: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-33, 65536.0, [128, 32, 8]
| | |   >-  y: q-33, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-33: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-33, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-33: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-33, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-33, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-33: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-33, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-33: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-33, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-33: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.33.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-33, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-33: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-33, 49152.0, [12288, 1]
|   >-----  y: l_out-32, 49152.0, [12288, 1]
|         
| <-------norm-33: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-33, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-33: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-33, 49152.0, [12288, 1]
|   |       y: blk.33.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-33: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.33.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-33, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-33: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-33, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-33: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.33.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-33, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-33: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-33, 114688.0, [28672, 1]
| >-------  y: ffn_up-33, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-33: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.33.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-33, 114688.0, [28672, 1]
| |       
| | <-----l_out-33: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-33, 49152.0, [12288, 1]
>---------  y: ffn_inp-33, 49152.0, [12288, 1]
    |     
    |     == layer 34 ==
    |     
<---|-----norm-34: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-33, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-34: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-34, 49152.0, [12288, 1]
  | |       y: blk.34.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-34: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.34.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-34, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-34: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-34, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-34: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-34, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-34: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.34.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-34, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-34: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-34, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-34: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-34, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-34: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.34.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-34, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-34: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l34, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-34: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-34, 4096.0, [128, 8]
| >-------  y: k_cache_view-34, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-34: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-34, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-34: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l34, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-34: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-34, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-34, 2048.0, [1, 1024]
|   |     
| <-|-----v-34: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l34, 67108864.0, [33554432, 1]
| | |     
| | | <---k-34: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l34, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-34: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-34, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-34: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-34, 65536.0, [128, 32, 8]
| | |   >-  y: q-34, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-34: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-34, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-34: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-34, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-34, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-34: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-34, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-34: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-34, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-34: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.34.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-34, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-34: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-34, 49152.0, [12288, 1]
|   >-----  y: l_out-33, 49152.0, [12288, 1]
|         
| <-------norm-34: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-34, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-34: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-34, 49152.0, [12288, 1]
|   |       y: blk.34.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-34: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.34.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-34, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-34: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-34, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-34: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.34.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-34, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-34: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-34, 114688.0, [28672, 1]
| >-------  y: ffn_up-34, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-34: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.34.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-34, 114688.0, [28672, 1]
| |       
| | <-----l_out-34: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-34, 49152.0, [12288, 1]
>---------  y: ffn_inp-34, 49152.0, [12288, 1]
    |     
    |     == layer 35 ==
    |     
<---|-----norm-35: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-34, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-35: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-35, 49152.0, [12288, 1]
  | |       y: blk.35.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-35: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.35.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-35, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-35: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-35, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-35: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-35, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-35: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.35.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-35, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-35: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-35, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-35: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-35, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-35: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.35.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-35, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-35: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l35, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-35: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-35, 4096.0, [128, 8]
| >-------  y: k_cache_view-35, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-35: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-35, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-35: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l35, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-35: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-35, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-35, 2048.0, [1, 1024]
|   |     
| <-|-----v-35: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l35, 67108864.0, [33554432, 1]
| | |     
| | | <---k-35: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l35, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-35: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-35, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-35: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-35, 65536.0, [128, 32, 8]
| | |   >-  y: q-35, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-35: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-35, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-35: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-35, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-35, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-35: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-35, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-35: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-35, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-35: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.35.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-35, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-35: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-35, 49152.0, [12288, 1]
|   >-----  y: l_out-34, 49152.0, [12288, 1]
|         
| <-------norm-35: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-35, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-35: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-35, 49152.0, [12288, 1]
|   |       y: blk.35.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-35: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.35.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-35, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-35: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-35, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-35: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.35.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-35, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-35: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-35, 114688.0, [28672, 1]
| >-------  y: ffn_up-35, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-35: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.35.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-35, 114688.0, [28672, 1]
| |       
| | <-----l_out-35: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-35, 49152.0, [12288, 1]
>---------  y: ffn_inp-35, 49152.0, [12288, 1]
    |     
    |     == layer 36 ==
    |     
<---|-----norm-36: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-35, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-36: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-36, 49152.0, [12288, 1]
  | |       y: blk.36.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-36: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.36.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-36, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-36: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-36, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-36: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-36, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-36: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.36.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-36, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-36: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-36, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-36: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-36, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-36: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.36.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-36, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-36: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l36, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-36: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-36, 4096.0, [128, 8]
| >-------  y: k_cache_view-36, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-36: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-36, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-36: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l36, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-36: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-36, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-36, 2048.0, [1, 1024]
|   |     
| <-|-----v-36: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l36, 67108864.0, [33554432, 1]
| | |     
| | | <---k-36: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l36, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-36: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-36, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-36: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-36, 65536.0, [128, 32, 8]
| | |   >-  y: q-36, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-36: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-36, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-36: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-36, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-36, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-36: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-36, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-36: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-36, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-36: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.36.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-36, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-36: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-36, 49152.0, [12288, 1]
|   >-----  y: l_out-35, 49152.0, [12288, 1]
|         
| <-------norm-36: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-36, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-36: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-36, 49152.0, [12288, 1]
|   |       y: blk.36.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-36: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.36.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-36, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-36: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-36, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-36: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.36.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-36, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-36: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-36, 114688.0, [28672, 1]
| >-------  y: ffn_up-36, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-36: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.36.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-36, 114688.0, [28672, 1]
| |       
| | <-----l_out-36: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-36, 49152.0, [12288, 1]
>---------  y: ffn_inp-36, 49152.0, [12288, 1]
    |     
    |     == layer 37 ==
    |     
<---|-----norm-37: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-36, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-37: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-37, 49152.0, [12288, 1]
  | |       y: blk.37.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-37: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.37.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-37, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-37: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-37, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-37: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-37, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-37: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.37.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-37, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-37: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-37, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-37: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-37, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-37: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.37.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-37, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-37: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l37, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-37: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-37, 4096.0, [128, 8]
| >-------  y: k_cache_view-37, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-37: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-37, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-37: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l37, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-37: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-37, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-37, 2048.0, [1, 1024]
|   |     
| <-|-----v-37: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l37, 67108864.0, [33554432, 1]
| | |     
| | | <---k-37: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l37, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-37: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-37, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-37: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-37, 65536.0, [128, 32, 8]
| | |   >-  y: q-37, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-37: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-37, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-37: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-37, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-37, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-37: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-37, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-37: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-37, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-37: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.37.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-37, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-37: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-37, 49152.0, [12288, 1]
|   >-----  y: l_out-36, 49152.0, [12288, 1]
|         
| <-------norm-37: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-37, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-37: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-37, 49152.0, [12288, 1]
|   |       y: blk.37.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-37: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.37.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-37, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-37: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-37, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-37: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.37.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-37, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-37: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-37, 114688.0, [28672, 1]
| >-------  y: ffn_up-37, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-37: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.37.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-37, 114688.0, [28672, 1]
| |       
| | <-----l_out-37: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-37, 49152.0, [12288, 1]
>---------  y: ffn_inp-37, 49152.0, [12288, 1]
    |     
    |     == layer 38 ==
    |     
<---|-----norm-38: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-37, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-38: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-38, 49152.0, [12288, 1]
  | |       y: blk.38.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-38: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.38.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-38, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-38: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-38, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-38: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-38, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-38: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.38.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-38, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-38: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-38, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-38: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-38, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-38: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.38.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-38, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-38: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l38, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-38: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-38, 4096.0, [128, 8]
| >-------  y: k_cache_view-38, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-38: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-38, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-38: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l38, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-38: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-38, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-38, 2048.0, [1, 1024]
|   |     
| <-|-----v-38: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l38, 67108864.0, [33554432, 1]
| | |     
| | | <---k-38: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l38, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-38: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-38, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-38: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-38, 65536.0, [128, 32, 8]
| | |   >-  y: q-38, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-38: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-38, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-38: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-38, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-38, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-38: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-38, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-38: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-38, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-38: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.38.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-38, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-38: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-38, 49152.0, [12288, 1]
|   >-----  y: l_out-37, 49152.0, [12288, 1]
|         
| <-------norm-38: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-38, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-38: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-38, 49152.0, [12288, 1]
|   |       y: blk.38.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-38: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.38.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-38, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-38: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-38, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-38: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.38.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-38, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-38: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-38, 114688.0, [28672, 1]
| >-------  y: ffn_up-38, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-38: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.38.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-38, 114688.0, [28672, 1]
| |       
| | <-----l_out-38: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-38, 49152.0, [12288, 1]
>---------  y: ffn_inp-38, 49152.0, [12288, 1]
    |     
    |     == layer 39 ==
    |     
<---|-----norm-39: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-38, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-39: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-39, 49152.0, [12288, 1]
  | |       y: blk.39.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-39: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.39.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-39, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-39: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-39, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-39: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-39, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-39: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.39.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-39, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-39: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-39, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-39: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-39, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-39: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.39.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-39, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-39: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l39, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-39: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-39, 4096.0, [128, 8]
| >-------  y: k_cache_view-39, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-39: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-39, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-39: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l39, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-39: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-39, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-39, 2048.0, [1, 1024]
|   |     
| <-|-----v-39: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l39, 67108864.0, [33554432, 1]
| | |     
| | | <---k-39: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l39, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-39: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-39, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-39: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-39, 65536.0, [128, 32, 8]
| | |   >-  y: q-39, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-39: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-39, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-39: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-39, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-39, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-39: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-39, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-39: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-39, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-39: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.39.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-39, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-39: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-39, 49152.0, [12288, 1]
|   >-----  y: l_out-38, 49152.0, [12288, 1]
|         
| <-------norm-39: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-39, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-39: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-39, 49152.0, [12288, 1]
|   |       y: blk.39.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-39: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.39.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-39, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-39: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-39, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-39: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.39.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-39, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-39: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-39, 114688.0, [28672, 1]
| >-------  y: ffn_up-39, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-39: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.39.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-39, 114688.0, [28672, 1]
| |       
| | <-----l_out-39: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-39, 49152.0, [12288, 1]
>---------  y: ffn_inp-39, 49152.0, [12288, 1]
    |     
    |     == layer 40 ==
    |     
<---|-----norm-40: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-39, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-40: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-40, 49152.0, [12288, 1]
  | |       y: blk.40.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-40: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.40.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-40, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-40: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-40, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-40: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-40, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-40: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.40.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-40, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-40: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-40, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-40: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-40, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-40: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.40.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-40, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-40: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l40, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-40: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-40, 4096.0, [128, 8]
| >-------  y: k_cache_view-40, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-40: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-40, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-40: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l40, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-40: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-40, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-40, 2048.0, [1, 1024]
|   |     
| <-|-----v-40: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l40, 67108864.0, [33554432, 1]
| | |     
| | | <---k-40: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l40, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-40: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-40, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-40: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-40, 65536.0, [128, 32, 8]
| | |   >-  y: q-40, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-40: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-40, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-40: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-40, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-40, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-40: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-40, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-40: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-40, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-40: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.40.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-40, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-40: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-40, 49152.0, [12288, 1]
|   >-----  y: l_out-39, 49152.0, [12288, 1]
|         
| <-------norm-40: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-40, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-40: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-40, 49152.0, [12288, 1]
|   |       y: blk.40.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-40: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.40.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-40, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-40: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-40, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-40: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.40.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-40, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-40: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-40, 114688.0, [28672, 1]
| >-------  y: ffn_up-40, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-40: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.40.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-40, 114688.0, [28672, 1]
| |       
| | <-----l_out-40: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-40, 49152.0, [12288, 1]
>---------  y: ffn_inp-40, 49152.0, [12288, 1]
    |     
    |     == layer 41 ==
    |     
<---|-----norm-41: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-40, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-41: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-41, 49152.0, [12288, 1]
  | |       y: blk.41.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-41: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.41.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-41, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-41: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-41, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-41: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-41, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-41: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.41.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-41, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-41: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-41, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-41: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-41, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-41: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.41.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-41, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-41: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l41, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-41: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-41, 4096.0, [128, 8]
| >-------  y: k_cache_view-41, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-41: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-41, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-41: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l41, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-41: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-41, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-41, 2048.0, [1, 1024]
|   |     
| <-|-----v-41: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l41, 67108864.0, [33554432, 1]
| | |     
| | | <---k-41: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l41, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-41: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-41, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-41: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-41, 65536.0, [128, 32, 8]
| | |   >-  y: q-41, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-41: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-41, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-41: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-41, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-41, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-41: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-41, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-41: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-41, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-41: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.41.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-41, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-41: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-41, 49152.0, [12288, 1]
|   >-----  y: l_out-40, 49152.0, [12288, 1]
|         
| <-------norm-41: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-41, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-41: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-41, 49152.0, [12288, 1]
|   |       y: blk.41.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-41: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.41.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-41, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-41: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-41, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-41: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.41.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-41, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-41: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-41, 114688.0, [28672, 1]
| >-------  y: ffn_up-41, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-41: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.41.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-41, 114688.0, [28672, 1]
| |       
| | <-----l_out-41: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-41, 49152.0, [12288, 1]
>---------  y: ffn_inp-41, 49152.0, [12288, 1]
    |     
    |     == layer 42 ==
    |     
<---|-----norm-42: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-41, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-42: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-42, 49152.0, [12288, 1]
  | |       y: blk.42.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-42: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.42.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-42, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-42: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-42, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-42: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-42, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-42: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.42.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-42, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-42: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-42, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-42: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-42, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-42: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.42.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-42, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-42: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l42, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-42: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-42, 4096.0, [128, 8]
| >-------  y: k_cache_view-42, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-42: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-42, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-42: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l42, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-42: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-42, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-42, 2048.0, [1, 1024]
|   |     
| <-|-----v-42: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l42, 67108864.0, [33554432, 1]
| | |     
| | | <---k-42: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l42, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-42: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-42, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-42: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-42, 65536.0, [128, 32, 8]
| | |   >-  y: q-42, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-42: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-42, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-42: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-42, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-42, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-42: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-42, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-42: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-42, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-42: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.42.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-42, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-42: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-42, 49152.0, [12288, 1]
|   >-----  y: l_out-41, 49152.0, [12288, 1]
|         
| <-------norm-42: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-42, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-42: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-42, 49152.0, [12288, 1]
|   |       y: blk.42.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-42: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.42.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-42, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-42: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-42, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-42: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.42.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-42, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-42: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-42, 114688.0, [28672, 1]
| >-------  y: ffn_up-42, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-42: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.42.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-42, 114688.0, [28672, 1]
| |       
| | <-----l_out-42: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-42, 49152.0, [12288, 1]
>---------  y: ffn_inp-42, 49152.0, [12288, 1]
    |     
    |     == layer 43 ==
    |     
<---|-----norm-43: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-42, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-43: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-43, 49152.0, [12288, 1]
  | |       y: blk.43.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-43: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.43.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-43, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-43: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-43, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-43: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-43, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-43: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.43.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-43, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-43: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-43, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-43: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-43, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-43: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.43.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-43, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-43: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l43, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-43: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-43, 4096.0, [128, 8]
| >-------  y: k_cache_view-43, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-43: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-43, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-43: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l43, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-43: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-43, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-43, 2048.0, [1, 1024]
|   |     
| <-|-----v-43: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l43, 67108864.0, [33554432, 1]
| | |     
| | | <---k-43: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l43, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-43: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-43, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-43: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-43, 65536.0, [128, 32, 8]
| | |   >-  y: q-43, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-43: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-43, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-43: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-43, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-43, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-43: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-43, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-43: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-43, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-43: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.43.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-43, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-43: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-43, 49152.0, [12288, 1]
|   >-----  y: l_out-42, 49152.0, [12288, 1]
|         
| <-------norm-43: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-43, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-43: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-43, 49152.0, [12288, 1]
|   |       y: blk.43.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-43: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.43.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-43, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-43: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-43, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-43: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.43.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-43, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-43: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-43, 114688.0, [28672, 1]
| >-------  y: ffn_up-43, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-43: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.43.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-43, 114688.0, [28672, 1]
| |       
| | <-----l_out-43: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-43, 49152.0, [12288, 1]
>---------  y: ffn_inp-43, 49152.0, [12288, 1]
    |     
    |     == layer 44 ==
    |     
<---|-----norm-44: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-43, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-44: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-44, 49152.0, [12288, 1]
  | |       y: blk.44.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-44: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.44.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-44, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-44: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-44, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-44: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-44, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-44: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.44.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-44, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-44: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-44, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-44: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-44, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-44: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.44.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-44, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-44: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l44, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-44: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-44, 4096.0, [128, 8]
| >-------  y: k_cache_view-44, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-44: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-44, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-44: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l44, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-44: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-44, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-44, 2048.0, [1, 1024]
|   |     
| <-|-----v-44: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l44, 67108864.0, [33554432, 1]
| | |     
| | | <---k-44: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l44, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-44: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-44, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-44: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-44, 65536.0, [128, 32, 8]
| | |   >-  y: q-44, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-44: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-44, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-44: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-44, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-44, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-44: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-44, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-44: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-44, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-44: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.44.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-44, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-44: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-44, 49152.0, [12288, 1]
|   >-----  y: l_out-43, 49152.0, [12288, 1]
|         
| <-------norm-44: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-44, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-44: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-44, 49152.0, [12288, 1]
|   |       y: blk.44.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-44: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.44.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-44, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-44: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-44, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-44: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.44.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-44, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-44: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-44, 114688.0, [28672, 1]
| >-------  y: ffn_up-44, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-44: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.44.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-44, 114688.0, [28672, 1]
| |       
| | <-----l_out-44: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-44, 49152.0, [12288, 1]
>---------  y: ffn_inp-44, 49152.0, [12288, 1]
    |     
    |     == layer 45 ==
    |     
<---|-----norm-45: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-44, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-45: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-45, 49152.0, [12288, 1]
  | |       y: blk.45.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-45: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.45.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-45, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-45: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-45, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-45: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-45, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-45: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.45.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-45, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-45: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-45, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-45: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-45, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-45: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.45.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-45, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-45: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l45, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-45: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-45, 4096.0, [128, 8]
| >-------  y: k_cache_view-45, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-45: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-45, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-45: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l45, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-45: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-45, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-45, 2048.0, [1, 1024]
|   |     
| <-|-----v-45: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l45, 67108864.0, [33554432, 1]
| | |     
| | | <---k-45: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l45, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-45: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-45, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-45: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-45, 65536.0, [128, 32, 8]
| | |   >-  y: q-45, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-45: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-45, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-45: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-45, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-45, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-45: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-45, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-45: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-45, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-45: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.45.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-45, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-45: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-45, 49152.0, [12288, 1]
|   >-----  y: l_out-44, 49152.0, [12288, 1]
|         
| <-------norm-45: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-45, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-45: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-45, 49152.0, [12288, 1]
|   |       y: blk.45.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-45: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.45.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-45, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-45: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-45, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-45: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.45.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-45, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-45: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-45, 114688.0, [28672, 1]
| >-------  y: ffn_up-45, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-45: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.45.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-45, 114688.0, [28672, 1]
| |       
| | <-----l_out-45: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-45, 49152.0, [12288, 1]
>---------  y: ffn_inp-45, 49152.0, [12288, 1]
    |     
    |     == layer 46 ==
    |     
<---|-----norm-46: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-45, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-46: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-46, 49152.0, [12288, 1]
  | |       y: blk.46.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-46: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.46.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-46, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-46: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-46, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-46: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-46, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-46: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.46.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-46, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-46: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-46, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-46: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-46, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-46: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.46.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-46, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-46: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l46, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-46: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-46, 4096.0, [128, 8]
| >-------  y: k_cache_view-46, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-46: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-46, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-46: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l46, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-46: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-46, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-46, 2048.0, [1, 1024]
|   |     
| <-|-----v-46: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l46, 67108864.0, [33554432, 1]
| | |     
| | | <---k-46: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l46, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-46: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-46, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-46: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-46, 65536.0, [128, 32, 8]
| | |   >-  y: q-46, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-46: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-46, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-46: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-46, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-46, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-46: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-46, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-46: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-46, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-46: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.46.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-46, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-46: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-46, 49152.0, [12288, 1]
|   >-----  y: l_out-45, 49152.0, [12288, 1]
|         
| <-------norm-46: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-46, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-46: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-46, 49152.0, [12288, 1]
|   |       y: blk.46.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-46: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.46.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-46, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-46: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-46, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-46: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.46.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-46, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-46: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-46, 114688.0, [28672, 1]
| >-------  y: ffn_up-46, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-46: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.46.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-46, 114688.0, [28672, 1]
| |       
| | <-----l_out-46: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-46, 49152.0, [12288, 1]
>---------  y: ffn_inp-46, 49152.0, [12288, 1]
    |     
    |     == layer 47 ==
    |     
<---|-----norm-47: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-46, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-47: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-47, 49152.0, [12288, 1]
  | |       y: blk.47.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-47: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.47.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-47, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-47: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-47, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-47: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-47, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-47: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.47.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-47, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-47: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-47, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-47: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-47, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-47: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.47.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-47, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-47: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l47, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-47: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-47, 4096.0, [128, 8]
| >-------  y: k_cache_view-47, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-47: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-47, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-47: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l47, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-47: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-47, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-47, 2048.0, [1, 1024]
|   |     
| <-|-----v-47: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l47, 67108864.0, [33554432, 1]
| | |     
| | | <---k-47: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l47, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-47: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-47, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-47: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-47, 65536.0, [128, 32, 8]
| | |   >-  y: q-47, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-47: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-47, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-47: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-47, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-47, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-47: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-47, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-47: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-47, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-47: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.47.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-47, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-47: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-47, 49152.0, [12288, 1]
|   >-----  y: l_out-46, 49152.0, [12288, 1]
|         
| <-------norm-47: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-47, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-47: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-47, 49152.0, [12288, 1]
|   |       y: blk.47.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-47: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.47.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-47, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-47: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-47, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-47: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.47.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-47, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-47: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-47, 114688.0, [28672, 1]
| >-------  y: ffn_up-47, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-47: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.47.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-47, 114688.0, [28672, 1]
| |       
| | <-----l_out-47: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-47, 49152.0, [12288, 1]
>---------  y: ffn_inp-47, 49152.0, [12288, 1]
    |     
    |     == layer 48 ==
    |     
<---|-----norm-48: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-47, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-48: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-48, 49152.0, [12288, 1]
  | |       y: blk.48.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-48: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.48.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-48, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-48: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-48, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-48: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-48, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-48: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.48.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-48, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-48: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-48, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-48: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-48, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-48: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.48.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-48, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-48: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l48, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-48: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-48, 4096.0, [128, 8]
| >-------  y: k_cache_view-48, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-48: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-48, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-48: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l48, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-48: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-48, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-48, 2048.0, [1, 1024]
|   |     
| <-|-----v-48: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l48, 67108864.0, [33554432, 1]
| | |     
| | | <---k-48: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l48, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-48: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-48, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-48: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-48, 65536.0, [128, 32, 8]
| | |   >-  y: q-48, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-48: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-48, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-48: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-48, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-48, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-48: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-48, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-48: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-48, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-48: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.48.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-48, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-48: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-48, 49152.0, [12288, 1]
|   >-----  y: l_out-47, 49152.0, [12288, 1]
|         
| <-------norm-48: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-48, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-48: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-48, 49152.0, [12288, 1]
|   |       y: blk.48.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-48: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.48.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-48, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-48: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-48, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-48: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.48.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-48, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-48: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-48, 114688.0, [28672, 1]
| >-------  y: ffn_up-48, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-48: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.48.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-48, 114688.0, [28672, 1]
| |       
| | <-----l_out-48: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-48, 49152.0, [12288, 1]
>---------  y: ffn_inp-48, 49152.0, [12288, 1]
    |     
    |     == layer 49 ==
    |     
<---|-----norm-49: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-48, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-49: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-49, 49152.0, [12288, 1]
  | |       y: blk.49.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-49: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.49.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-49, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-49: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-49, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-49: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-49, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-49: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.49.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-49, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-49: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-49, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-49: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-49, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-49: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.49.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-49, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-49: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l49, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-49: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-49, 4096.0, [128, 8]
| >-------  y: k_cache_view-49, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-49: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-49, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-49: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l49, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-49: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-49, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-49, 2048.0, [1, 1024]
|   |     
| <-|-----v-49: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l49, 67108864.0, [33554432, 1]
| | |     
| | | <---k-49: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l49, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-49: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-49, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-49: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-49, 65536.0, [128, 32, 8]
| | |   >-  y: q-49, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-49: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-49, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-49: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-49, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-49, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-49: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-49, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-49: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-49, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-49: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.49.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-49, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-49: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-49, 49152.0, [12288, 1]
|   >-----  y: l_out-48, 49152.0, [12288, 1]
|         
| <-------norm-49: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-49, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-49: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-49, 49152.0, [12288, 1]
|   |       y: blk.49.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-49: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.49.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-49, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-49: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-49, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-49: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.49.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-49, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-49: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-49, 114688.0, [28672, 1]
| >-------  y: ffn_up-49, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-49: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.49.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-49, 114688.0, [28672, 1]
| |       
| | <-----l_out-49: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-49, 49152.0, [12288, 1]
>---------  y: ffn_inp-49, 49152.0, [12288, 1]
    |     
    |     == layer 50 ==
    |     
<---|-----norm-50: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-49, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-50: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-50, 49152.0, [12288, 1]
  | |       y: blk.50.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-50: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.50.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-50, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-50: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-50, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-50: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-50, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-50: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.50.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-50, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-50: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-50, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-50: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-50, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-50: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.50.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-50, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-50: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l50, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-50: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-50, 4096.0, [128, 8]
| >-------  y: k_cache_view-50, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-50: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-50, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-50: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l50, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-50: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-50, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-50, 2048.0, [1, 1024]
|   |     
| <-|-----v-50: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l50, 67108864.0, [33554432, 1]
| | |     
| | | <---k-50: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l50, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-50: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-50, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-50: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-50, 65536.0, [128, 32, 8]
| | |   >-  y: q-50, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-50: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-50, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-50: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-50, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-50, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-50: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-50, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-50: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-50, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-50: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.50.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-50, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-50: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-50, 49152.0, [12288, 1]
|   >-----  y: l_out-49, 49152.0, [12288, 1]
|         
| <-------norm-50: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-50, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-50: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-50, 49152.0, [12288, 1]
|   |       y: blk.50.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-50: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.50.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-50, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-50: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-50, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-50: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.50.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-50, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-50: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-50, 114688.0, [28672, 1]
| >-------  y: ffn_up-50, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-50: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.50.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-50, 114688.0, [28672, 1]
| |       
| | <-----l_out-50: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-50, 49152.0, [12288, 1]
>---------  y: ffn_inp-50, 49152.0, [12288, 1]
    |     
    |     == layer 51 ==
    |     
<---|-----norm-51: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-50, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-51: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-51, 49152.0, [12288, 1]
  | |       y: blk.51.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-51: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.51.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-51, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-51: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-51, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-51: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-51, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-51: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.51.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-51, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-51: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-51, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-51: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-51, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-51: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.51.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-51, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-51: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l51, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-51: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-51, 4096.0, [128, 8]
| >-------  y: k_cache_view-51, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-51: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-51, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-51: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l51, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-51: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-51, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-51, 2048.0, [1, 1024]
|   |     
| <-|-----v-51: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l51, 67108864.0, [33554432, 1]
| | |     
| | | <---k-51: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l51, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-51: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-51, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-51: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-51, 65536.0, [128, 32, 8]
| | |   >-  y: q-51, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-51: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-51, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-51: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-51, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-51, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-51: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-51, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-51: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-51, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-51: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.51.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-51, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-51: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-51, 49152.0, [12288, 1]
|   >-----  y: l_out-50, 49152.0, [12288, 1]
|         
| <-------norm-51: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-51, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-51: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-51, 49152.0, [12288, 1]
|   |       y: blk.51.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-51: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.51.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-51, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-51: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-51, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-51: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.51.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-51, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-51: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-51, 114688.0, [28672, 1]
| >-------  y: ffn_up-51, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-51: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.51.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-51, 114688.0, [28672, 1]
| |       
| | <-----l_out-51: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-51, 49152.0, [12288, 1]
>---------  y: ffn_inp-51, 49152.0, [12288, 1]
    |     
    |     == layer 52 ==
    |     
<---|-----norm-52: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-51, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-52: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-52, 49152.0, [12288, 1]
  | |       y: blk.52.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-52: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.52.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-52, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-52: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-52, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-52: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-52, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-52: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.52.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-52, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-52: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-52, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-52: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-52, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-52: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.52.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-52, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-52: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l52, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-52: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-52, 4096.0, [128, 8]
| >-------  y: k_cache_view-52, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-52: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-52, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-52: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l52, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-52: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-52, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-52, 2048.0, [1, 1024]
|   |     
| <-|-----v-52: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l52, 67108864.0, [33554432, 1]
| | |     
| | | <---k-52: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l52, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-52: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-52, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-52: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-52, 65536.0, [128, 32, 8]
| | |   >-  y: q-52, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-52: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-52, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-52: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-52, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-52, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-52: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-52, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-52: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-52, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-52: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.52.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-52, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-52: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-52, 49152.0, [12288, 1]
|   >-----  y: l_out-51, 49152.0, [12288, 1]
|         
| <-------norm-52: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-52, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-52: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-52, 49152.0, [12288, 1]
|   |       y: blk.52.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-52: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.52.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-52, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-52: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-52, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-52: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.52.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-52, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-52: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-52, 114688.0, [28672, 1]
| >-------  y: ffn_up-52, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-52: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.52.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-52, 114688.0, [28672, 1]
| |       
| | <-----l_out-52: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-52, 49152.0, [12288, 1]
>---------  y: ffn_inp-52, 49152.0, [12288, 1]
    |     
    |     == layer 53 ==
    |     
<---|-----norm-53: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-52, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-53: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-53, 49152.0, [12288, 1]
  | |       y: blk.53.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-53: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.53.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-53, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-53: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-53, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-53: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-53, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-53: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.53.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-53, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-53: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-53, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-53: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-53, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-53: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.53.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-53, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-53: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l53, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-53: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-53, 4096.0, [128, 8]
| >-------  y: k_cache_view-53, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-53: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-53, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-53: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l53, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-53: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-53, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-53, 2048.0, [1, 1024]
|   |     
| <-|-----v-53: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l53, 67108864.0, [33554432, 1]
| | |     
| | | <---k-53: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l53, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-53: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-53, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-53: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-53, 65536.0, [128, 32, 8]
| | |   >-  y: q-53, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-53: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-53, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-53: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-53, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-53, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-53: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-53, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-53: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-53, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-53: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.53.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-53, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-53: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-53, 49152.0, [12288, 1]
|   >-----  y: l_out-52, 49152.0, [12288, 1]
|         
| <-------norm-53: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-53, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-53: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-53, 49152.0, [12288, 1]
|   |       y: blk.53.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-53: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.53.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-53, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-53: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-53, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-53: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.53.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-53, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-53: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-53, 114688.0, [28672, 1]
| >-------  y: ffn_up-53, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-53: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.53.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-53, 114688.0, [28672, 1]
| |       
| | <-----l_out-53: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-53, 49152.0, [12288, 1]
>---------  y: ffn_inp-53, 49152.0, [12288, 1]
    |     
    |     == layer 54 ==
    |     
<---|-----norm-54: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-53, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-54: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-54, 49152.0, [12288, 1]
  | |       y: blk.54.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-54: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.54.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-54, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-54: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-54, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-54: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-54, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-54: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.54.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-54, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-54: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-54, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-54: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-54, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-54: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.54.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-54, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-54: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l54, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-54: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-54, 4096.0, [128, 8]
| >-------  y: k_cache_view-54, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-54: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-54, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-54: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l54, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-54: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-54, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-54, 2048.0, [1, 1024]
|   |     
| <-|-----v-54: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l54, 67108864.0, [33554432, 1]
| | |     
| | | <---k-54: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l54, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-54: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-54, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-54: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-54, 65536.0, [128, 32, 8]
| | |   >-  y: q-54, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-54: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-54, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-54: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-54, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-54, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-54: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-54, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-54: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-54, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-54: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.54.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-54, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-54: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-54, 49152.0, [12288, 1]
|   >-----  y: l_out-53, 49152.0, [12288, 1]
|         
| <-------norm-54: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-54, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-54: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-54, 49152.0, [12288, 1]
|   |       y: blk.54.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-54: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.54.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-54, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-54: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-54, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-54: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.54.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-54, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-54: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-54, 114688.0, [28672, 1]
| >-------  y: ffn_up-54, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-54: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.54.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-54, 114688.0, [28672, 1]
| |       
| | <-----l_out-54: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-54, 49152.0, [12288, 1]
>---------  y: ffn_inp-54, 49152.0, [12288, 1]
    |     
    |     == layer 55 ==
    |     
<---|-----norm-55: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-54, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-55: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-55, 49152.0, [12288, 1]
  | |       y: blk.55.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-55: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.55.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-55, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-55: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-55, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-55: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-55, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-55: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.55.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-55, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-55: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-55, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-55: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-55, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-55: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.55.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-55, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-55: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l55, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-55: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-55, 4096.0, [128, 8]
| >-------  y: k_cache_view-55, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-55: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-55, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-55: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l55, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-55: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-55, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-55, 2048.0, [1, 1024]
|   |     
| <-|-----v-55: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l55, 67108864.0, [33554432, 1]
| | |     
| | | <---k-55: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l55, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-55: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-55, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-55: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-55, 65536.0, [128, 32, 8]
| | |   >-  y: q-55, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-55: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-55, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-55: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-55, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-55, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-55: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-55, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-55: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-55, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-55: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.55.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-55, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-55: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-55, 49152.0, [12288, 1]
|   >-----  y: l_out-54, 49152.0, [12288, 1]
|         
| <-------norm-55: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-55, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-55: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-55, 49152.0, [12288, 1]
|   |       y: blk.55.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-55: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.55.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-55, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-55: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-55, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-55: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.55.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-55, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-55: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-55, 114688.0, [28672, 1]
| >-------  y: ffn_up-55, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-55: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.55.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-55, 114688.0, [28672, 1]
| |       
| | <-----l_out-55: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-55, 49152.0, [12288, 1]
>---------  y: ffn_inp-55, 49152.0, [12288, 1]
    |     
    |     == layer 56 ==
    |     
<---|-----norm-56: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-55, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-56: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-56, 49152.0, [12288, 1]
  | |       y: blk.56.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-56: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.56.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-56, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-56: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-56, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-56: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-56, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-56: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.56.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-56, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-56: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-56, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-56: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-56, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-56: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.56.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-56, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-56: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l56, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-56: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-56, 4096.0, [128, 8]
| >-------  y: k_cache_view-56, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-56: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-56, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-56: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l56, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-56: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-56, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-56, 2048.0, [1, 1024]
|   |     
| <-|-----v-56: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l56, 67108864.0, [33554432, 1]
| | |     
| | | <---k-56: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l56, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-56: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-56, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-56: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-56, 65536.0, [128, 32, 8]
| | |   >-  y: q-56, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-56: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-56, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-56: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-56, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-56, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-56: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-56, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-56: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-56, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-56: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.56.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-56, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-56: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-56, 49152.0, [12288, 1]
|   >-----  y: l_out-55, 49152.0, [12288, 1]
|         
| <-------norm-56: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-56, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-56: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-56, 49152.0, [12288, 1]
|   |       y: blk.56.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-56: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.56.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-56, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-56: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-56, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-56: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.56.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-56, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-56: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-56, 114688.0, [28672, 1]
| >-------  y: ffn_up-56, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-56: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.56.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-56, 114688.0, [28672, 1]
| |       
| | <-----l_out-56: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-56, 49152.0, [12288, 1]
>---------  y: ffn_inp-56, 49152.0, [12288, 1]
    |     
    |     == layer 57 ==
    |     
<---|-----norm-57: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-56, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-57: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-57, 49152.0, [12288, 1]
  | |       y: blk.57.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-57: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.57.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-57, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-57: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-57, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-57: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-57, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-57: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.57.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-57, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-57: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-57, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-57: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-57, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-57: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.57.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-57, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-57: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l57, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-57: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-57, 4096.0, [128, 8]
| >-------  y: k_cache_view-57, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-57: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-57, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-57: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l57, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-57: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-57, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-57, 2048.0, [1, 1024]
|   |     
| <-|-----v-57: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l57, 67108864.0, [33554432, 1]
| | |     
| | | <---k-57: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l57, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-57: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-57, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-57: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-57, 65536.0, [128, 32, 8]
| | |   >-  y: q-57, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-57: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-57, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-57: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-57, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-57, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-57: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-57, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-57: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-57, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-57: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.57.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-57, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-57: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-57, 49152.0, [12288, 1]
|   >-----  y: l_out-56, 49152.0, [12288, 1]
|         
| <-------norm-57: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-57, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-57: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-57, 49152.0, [12288, 1]
|   |       y: blk.57.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-57: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.57.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-57, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-57: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-57, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-57: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.57.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-57, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-57: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-57, 114688.0, [28672, 1]
| >-------  y: ffn_up-57, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-57: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.57.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-57, 114688.0, [28672, 1]
| |       
| | <-----l_out-57: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-57, 49152.0, [12288, 1]
>---------  y: ffn_inp-57, 49152.0, [12288, 1]
    |     
    |     == layer 58 ==
    |     
<---|-----norm-58: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-57, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-58: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-58, 49152.0, [12288, 1]
  | |       y: blk.58.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-58: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.58.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-58, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-58: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-58, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-58: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-58, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-58: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.58.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-58, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-58: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-58, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-58: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-58, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-58: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.58.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-58, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-58: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l58, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-58: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-58, 4096.0, [128, 8]
| >-------  y: k_cache_view-58, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-58: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-58, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-58: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l58, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-58: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-58, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-58, 2048.0, [1, 1024]
|   |     
| <-|-----v-58: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l58, 67108864.0, [33554432, 1]
| | |     
| | | <---k-58: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l58, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-58: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-58, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-58: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-58, 65536.0, [128, 32, 8]
| | |   >-  y: q-58, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-58: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-58, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-58: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-58, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-58, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-58: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-58, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-58: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-58, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-58: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.58.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-58, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-58: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-58, 49152.0, [12288, 1]
|   >-----  y: l_out-57, 49152.0, [12288, 1]
|         
| <-------norm-58: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-58, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-58: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-58, 49152.0, [12288, 1]
|   |       y: blk.58.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-58: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.58.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-58, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-58: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-58, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-58: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.58.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-58, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-58: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-58, 114688.0, [28672, 1]
| >-------  y: ffn_up-58, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-58: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.58.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-58, 114688.0, [28672, 1]
| |       
| | <-----l_out-58: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-58, 49152.0, [12288, 1]
>---------  y: ffn_inp-58, 49152.0, [12288, 1]
    |     
    |     == layer 59 ==
    |     
<---|-----norm-59: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-58, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-59: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-59, 49152.0, [12288, 1]
  | |       y: blk.59.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-59: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.59.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-59, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-59: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-59, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-59: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-59, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-59: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.59.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-59, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-59: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-59, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-59: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-59, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-59: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.59.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-59, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-59: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l59, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-59: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-59, 4096.0, [128, 8]
| >-------  y: k_cache_view-59, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-59: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-59, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-59: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l59, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-59: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-59, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-59, 2048.0, [1, 1024]
|   |     
| <-|-----v-59: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l59, 67108864.0, [33554432, 1]
| | |     
| | | <---k-59: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l59, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-59: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-59, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-59: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-59, 65536.0, [128, 32, 8]
| | |   >-  y: q-59, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-59: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-59, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-59: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-59, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-59, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-59: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-59, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-59: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-59, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-59: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.59.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-59, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-59: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-59, 49152.0, [12288, 1]
|   >-----  y: l_out-58, 49152.0, [12288, 1]
|         
| <-------norm-59: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-59, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-59: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-59, 49152.0, [12288, 1]
|   |       y: blk.59.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-59: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.59.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-59, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-59: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-59, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-59: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.59.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-59, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-59: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-59, 114688.0, [28672, 1]
| >-------  y: ffn_up-59, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-59: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.59.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-59, 114688.0, [28672, 1]
| |       
| | <-----l_out-59: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-59, 49152.0, [12288, 1]
>---------  y: ffn_inp-59, 49152.0, [12288, 1]
    |     
    |     == layer 60 ==
    |     
<---|-----norm-60: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-59, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-60: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-60, 49152.0, [12288, 1]
  | |       y: blk.60.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-60: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.60.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-60, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-60: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-60, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-60: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-60, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-60: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.60.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-60, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-60: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-60, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-60: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-60, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-60: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.60.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-60, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-60: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l60, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-60: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-60, 4096.0, [128, 8]
| >-------  y: k_cache_view-60, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-60: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-60, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-60: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l60, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-60: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-60, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-60, 2048.0, [1, 1024]
|   |     
| <-|-----v-60: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l60, 67108864.0, [33554432, 1]
| | |     
| | | <---k-60: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l60, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-60: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-60, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-60: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-60, 65536.0, [128, 32, 8]
| | |   >-  y: q-60, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-60: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-60, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-60: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-60, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-60, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-60: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-60, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-60: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-60, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-60: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.60.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-60, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-60: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-60, 49152.0, [12288, 1]
|   >-----  y: l_out-59, 49152.0, [12288, 1]
|         
| <-------norm-60: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-60, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-60: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-60, 49152.0, [12288, 1]
|   |       y: blk.60.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-60: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.60.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-60, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-60: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-60, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-60: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.60.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-60, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-60: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-60, 114688.0, [28672, 1]
| >-------  y: ffn_up-60, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-60: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.60.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-60, 114688.0, [28672, 1]
| |       
| | <-----l_out-60: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-60, 49152.0, [12288, 1]
>---------  y: ffn_inp-60, 49152.0, [12288, 1]
    |     
    |     == layer 61 ==
    |     
<---|-----norm-61: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-60, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-61: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-61, 49152.0, [12288, 1]
  | |       y: blk.61.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-61: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.61.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-61, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-61: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-61, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-61: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-61, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-61: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.61.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-61, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-61: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-61, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-61: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-61, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-61: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.61.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-61, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-61: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l61, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-61: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-61, 4096.0, [128, 8]
| >-------  y: k_cache_view-61, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-61: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-61, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-61: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l61, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-61: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-61, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-61, 2048.0, [1, 1024]
|   |     
| <-|-----v-61: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l61, 67108864.0, [33554432, 1]
| | |     
| | | <---k-61: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l61, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-61: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-61, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-61: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-61, 65536.0, [128, 32, 8]
| | |   >-  y: q-61, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-61: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-61, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-61: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-61, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-61, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-61: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-61, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-61: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-61, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-61: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.61.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-61, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-61: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-61, 49152.0, [12288, 1]
|   >-----  y: l_out-60, 49152.0, [12288, 1]
|         
| <-------norm-61: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-61, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-61: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-61, 49152.0, [12288, 1]
|   |       y: blk.61.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-61: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.61.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-61, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-61: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-61, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-61: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.61.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-61, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-61: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-61, 114688.0, [28672, 1]
| >-------  y: ffn_up-61, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-61: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.61.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-61, 114688.0, [28672, 1]
| |       
| | <-----l_out-61: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-61, 49152.0, [12288, 1]
>---------  y: ffn_inp-61, 49152.0, [12288, 1]
    |     
    |     == layer 62 ==
    |     
<---|-----norm-62: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-61, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-62: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-62, 49152.0, [12288, 1]
  | |       y: blk.62.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-62: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.62.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-62, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-62: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-62, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-62: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-62, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-62: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.62.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-62, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-62: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-62, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-62: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-62, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-62: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.62.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-62, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-62: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l62, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-62: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-62, 4096.0, [128, 8]
| >-------  y: k_cache_view-62, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-62: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-62, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-62: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l62, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-62: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-62, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-62, 2048.0, [1, 1024]
|   |     
| <-|-----v-62: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l62, 67108864.0, [33554432, 1]
| | |     
| | | <---k-62: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l62, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-62: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-62, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-62: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-62, 65536.0, [128, 32, 8]
| | |   >-  y: q-62, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-62: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-62, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-62: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-62, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-62, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-62: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-62, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-62: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-62, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-62: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.62.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-62, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-62: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-62, 49152.0, [12288, 1]
|   >-----  y: l_out-61, 49152.0, [12288, 1]
|         
| <-------norm-62: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-62, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-62: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-62, 49152.0, [12288, 1]
|   |       y: blk.62.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-62: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.62.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-62, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-62: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-62, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-62: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.62.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-62, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-62: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-62, 114688.0, [28672, 1]
| >-------  y: ffn_up-62, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-62: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.62.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-62, 114688.0, [28672, 1]
| |       
| | <-----l_out-62: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-62, 49152.0, [12288, 1]
>---------  y: ffn_inp-62, 49152.0, [12288, 1]
    |     
    |     == layer 63 ==
    |     
<---|-----norm-63: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-62, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-63: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-63, 49152.0, [12288, 1]
  | |       y: blk.63.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-63: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.63.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-63, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-63: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-63, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-63: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-63, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-63: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.63.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-63, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-63: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-63, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-63: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-63, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-63: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.63.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-63, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-63: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l63, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-63: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-63, 4096.0, [128, 8]
| >-------  y: k_cache_view-63, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-63: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-63, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-63: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l63, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-63: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-63, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-63, 2048.0, [1, 1024]
|   |     
| <-|-----v-63: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l63, 67108864.0, [33554432, 1]
| | |     
| | | <---k-63: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l63, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-63: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-63, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-63: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-63, 65536.0, [128, 32, 8]
| | |   >-  y: q-63, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-63: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-63, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-63: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-63, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-63, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-63: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-63, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-63: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-63, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-63: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.63.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-63, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-63: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-63, 49152.0, [12288, 1]
|   >-----  y: l_out-62, 49152.0, [12288, 1]
|         
| <-------norm-63: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-63, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-63: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-63, 49152.0, [12288, 1]
|   |       y: blk.63.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-63: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.63.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-63, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-63: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-63, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-63: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.63.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-63, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-63: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-63, 114688.0, [28672, 1]
| >-------  y: ffn_up-63, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-63: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.63.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-63, 114688.0, [28672, 1]
| |       
| | <-----l_out-63: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-63, 49152.0, [12288, 1]
>---------  y: ffn_inp-63, 49152.0, [12288, 1]
    |     
    |     == layer 64 ==
    |     
<---|-----norm-64: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-63, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-64: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-64, 49152.0, [12288, 1]
  | |       y: blk.64.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-64: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.64.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-64, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-64: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-64, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-64: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-64, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-64: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.64.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-64, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-64: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-64, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-64: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-64, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-64: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.64.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-64, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-64: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l64, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-64: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-64, 4096.0, [128, 8]
| >-------  y: k_cache_view-64, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-64: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-64, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-64: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l64, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-64: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-64, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-64, 2048.0, [1, 1024]
|   |     
| <-|-----v-64: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l64, 67108864.0, [33554432, 1]
| | |     
| | | <---k-64: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l64, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-64: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-64, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-64: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-64, 65536.0, [128, 32, 8]
| | |   >-  y: q-64, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-64: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-64, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-64: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-64, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-64, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-64: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-64, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-64: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-64, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-64: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.64.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-64, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-64: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-64, 49152.0, [12288, 1]
|   >-----  y: l_out-63, 49152.0, [12288, 1]
|         
| <-------norm-64: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-64, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-64: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-64, 49152.0, [12288, 1]
|   |       y: blk.64.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-64: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.64.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-64, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-64: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-64, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-64: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.64.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-64, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-64: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-64, 114688.0, [28672, 1]
| >-------  y: ffn_up-64, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-64: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.64.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-64, 114688.0, [28672, 1]
| |       
| | <-----l_out-64: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-64, 49152.0, [12288, 1]
>---------  y: ffn_inp-64, 49152.0, [12288, 1]
    |     
    |     == layer 65 ==
    |     
<---|-----norm-65: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-64, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-65: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-65, 49152.0, [12288, 1]
  | |       y: blk.65.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-65: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.65.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-65, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-65: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-65, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-65: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-65, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-65: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.65.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-65, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-65: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-65, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-65: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-65, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-65: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.65.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-65, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-65: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l65, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-65: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-65, 4096.0, [128, 8]
| >-------  y: k_cache_view-65, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-65: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-65, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-65: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l65, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-65: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-65, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-65, 2048.0, [1, 1024]
|   |     
| <-|-----v-65: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l65, 67108864.0, [33554432, 1]
| | |     
| | | <---k-65: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l65, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-65: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-65, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-65: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-65, 65536.0, [128, 32, 8]
| | |   >-  y: q-65, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-65: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-65, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-65: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-65, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-65, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-65: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-65, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-65: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-65, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-65: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.65.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-65, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-65: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-65, 49152.0, [12288, 1]
|   >-----  y: l_out-64, 49152.0, [12288, 1]
|         
| <-------norm-65: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-65, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-65: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-65, 49152.0, [12288, 1]
|   |       y: blk.65.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-65: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.65.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-65, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-65: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-65, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-65: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.65.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-65, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-65: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-65, 114688.0, [28672, 1]
| >-------  y: ffn_up-65, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-65: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.65.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-65, 114688.0, [28672, 1]
| |       
| | <-----l_out-65: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-65, 49152.0, [12288, 1]
>---------  y: ffn_inp-65, 49152.0, [12288, 1]
    |     
    |     == layer 66 ==
    |     
<---|-----norm-66: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-65, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-66: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-66, 49152.0, [12288, 1]
  | |       y: blk.66.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-66: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.66.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-66, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-66: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-66, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-66: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-66, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-66: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.66.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-66, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-66: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-66, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-66: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-66, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-66: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.66.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-66, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-66: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l66, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-66: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-66, 4096.0, [128, 8]
| >-------  y: k_cache_view-66, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-66: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-66, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-66: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l66, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-66: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-66, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-66, 2048.0, [1, 1024]
|   |     
| <-|-----v-66: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l66, 67108864.0, [33554432, 1]
| | |     
| | | <---k-66: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l66, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-66: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-66, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-66: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-66, 65536.0, [128, 32, 8]
| | |   >-  y: q-66, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-66: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-66, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-66: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-66, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-66, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-66: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-66, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-66: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-66, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-66: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.66.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-66, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-66: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-66, 49152.0, [12288, 1]
|   >-----  y: l_out-65, 49152.0, [12288, 1]
|         
| <-------norm-66: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-66, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-66: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-66, 49152.0, [12288, 1]
|   |       y: blk.66.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-66: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.66.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-66, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-66: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-66, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-66: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.66.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-66, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-66: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-66, 114688.0, [28672, 1]
| >-------  y: ffn_up-66, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-66: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.66.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-66, 114688.0, [28672, 1]
| |       
| | <-----l_out-66: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-66, 49152.0, [12288, 1]
>---------  y: ffn_inp-66, 49152.0, [12288, 1]
    |     
    |     == layer 67 ==
    |     
<---|-----norm-67: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-66, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-67: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-67, 49152.0, [12288, 1]
  | |       y: blk.67.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-67: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.67.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-67, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-67: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-67, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-67: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-67, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-67: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.67.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-67, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-67: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-67, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-67: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-67, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-67: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.67.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-67, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-67: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l67, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-67: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-67, 4096.0, [128, 8]
| >-------  y: k_cache_view-67, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-67: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-67, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-67: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l67, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-67: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-67, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-67, 2048.0, [1, 1024]
|   |     
| <-|-----v-67: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l67, 67108864.0, [33554432, 1]
| | |     
| | | <---k-67: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l67, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-67: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-67, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-67: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-67, 65536.0, [128, 32, 8]
| | |   >-  y: q-67, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-67: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-67, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-67: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-67, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-67, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-67: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-67, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-67: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-67, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-67: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.67.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-67, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-67: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-67, 49152.0, [12288, 1]
|   >-----  y: l_out-66, 49152.0, [12288, 1]
|         
| <-------norm-67: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-67, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-67: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-67, 49152.0, [12288, 1]
|   |       y: blk.67.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-67: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.67.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-67, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-67: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-67, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-67: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.67.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-67, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-67: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-67, 114688.0, [28672, 1]
| >-------  y: ffn_up-67, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-67: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.67.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-67, 114688.0, [28672, 1]
| |       
| | <-----l_out-67: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-67, 49152.0, [12288, 1]
>---------  y: ffn_inp-67, 49152.0, [12288, 1]
    |     
    |     == layer 68 ==
    |     
<---|-----norm-68: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-67, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-68: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-68, 49152.0, [12288, 1]
  | |       y: blk.68.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-68: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.68.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-68, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-68: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-68, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-68: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-68, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-68: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.68.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-68, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-68: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-68, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-68: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-68, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-68: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.68.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-68, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-68: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l68, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-68: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-68, 4096.0, [128, 8]
| >-------  y: k_cache_view-68, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-68: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-68, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-68: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l68, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-68: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-68, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-68, 2048.0, [1, 1024]
|   |     
| <-|-----v-68: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l68, 67108864.0, [33554432, 1]
| | |     
| | | <---k-68: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l68, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-68: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-68, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-68: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-68, 65536.0, [128, 32, 8]
| | |   >-  y: q-68, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-68: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-68, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-68: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-68, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-68, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-68: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-68, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-68: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-68, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-68: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.68.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-68, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-68: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-68, 49152.0, [12288, 1]
|   >-----  y: l_out-67, 49152.0, [12288, 1]
|         
| <-------norm-68: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-68, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-68: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-68, 49152.0, [12288, 1]
|   |       y: blk.68.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-68: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.68.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-68, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-68: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-68, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-68: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.68.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-68, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-68: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-68, 114688.0, [28672, 1]
| >-------  y: ffn_up-68, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-68: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.68.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-68, 114688.0, [28672, 1]
| |       
| | <-----l_out-68: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-68, 49152.0, [12288, 1]
>---------  y: ffn_inp-68, 49152.0, [12288, 1]
    |     
    |     == layer 69 ==
    |     
<---|-----norm-69: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-68, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-69: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-69, 49152.0, [12288, 1]
  | |       y: blk.69.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-69: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.69.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-69, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-69: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-69, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-69: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-69, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-69: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.69.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-69, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-69: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-69, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-69: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-69, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-69: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.69.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-69, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-69: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l69, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-69: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-69, 4096.0, [128, 8]
| >-------  y: k_cache_view-69, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-69: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-69, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-69: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l69, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-69: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-69, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-69, 2048.0, [1, 1024]
|   |     
| <-|-----v-69: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l69, 67108864.0, [33554432, 1]
| | |     
| | | <---k-69: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l69, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-69: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-69, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-69: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-69, 65536.0, [128, 32, 8]
| | |   >-  y: q-69, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-69: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-69, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-69: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-69, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-69, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-69: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-69, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-69: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-69, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-69: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.69.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-69, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-69: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-69, 49152.0, [12288, 1]
|   >-----  y: l_out-68, 49152.0, [12288, 1]
|         
| <-------norm-69: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-69, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-69: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-69, 49152.0, [12288, 1]
|   |       y: blk.69.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-69: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.69.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-69, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-69: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-69, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-69: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.69.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-69, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-69: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-69, 114688.0, [28672, 1]
| >-------  y: ffn_up-69, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-69: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.69.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-69, 114688.0, [28672, 1]
| |       
| | <-----l_out-69: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-69, 49152.0, [12288, 1]
>---------  y: ffn_inp-69, 49152.0, [12288, 1]
    |     
    |     == layer 70 ==
    |     
<---|-----norm-70: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-69, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-70: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-70, 49152.0, [12288, 1]
  | |       y: blk.70.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-70: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.70.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-70, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-70: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-70, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-70: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-70, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-70: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.70.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-70, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-70: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-70, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-70: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-70, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-70: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.70.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-70, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-70: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l70, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-70: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-70, 4096.0, [128, 8]
| >-------  y: k_cache_view-70, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-70: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-70, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-70: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l70, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-70: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-70, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-70, 2048.0, [1, 1024]
|   |     
| <-|-----v-70: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l70, 67108864.0, [33554432, 1]
| | |     
| | | <---k-70: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l70, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-70: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-70, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-70: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-70, 65536.0, [128, 32, 8]
| | |   >-  y: q-70, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-70: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-70, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-70: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-70, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-70, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-70: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-70, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-70: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-70, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-70: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.70.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-70, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-70: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-70, 49152.0, [12288, 1]
|   >-----  y: l_out-69, 49152.0, [12288, 1]
|         
| <-------norm-70: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-70, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-70: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-70, 49152.0, [12288, 1]
|   |       y: blk.70.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-70: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.70.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-70, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-70: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-70, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-70: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.70.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-70, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-70: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-70, 114688.0, [28672, 1]
| >-------  y: ffn_up-70, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-70: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.70.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-70, 114688.0, [28672, 1]
| |       
| | <-----l_out-70: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-70, 49152.0, [12288, 1]
>---------  y: ffn_inp-70, 49152.0, [12288, 1]
    |     
    |     == layer 71 ==
    |     
<---|-----norm-71: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-70, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-71: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-71, 49152.0, [12288, 1]
  | |       y: blk.71.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-71: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.71.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-71, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-71: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-71, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-71: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-71, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-71: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.71.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-71, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-71: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-71, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-71: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-71, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-71: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.71.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-71, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-71: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l71, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-71: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-71, 4096.0, [128, 8]
| >-------  y: k_cache_view-71, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-71: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-71, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-71: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l71, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-71: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-71, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-71, 2048.0, [1, 1024]
|   |     
| <-|-----v-71: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l71, 67108864.0, [33554432, 1]
| | |     
| | | <---k-71: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l71, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-71: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-71, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-71: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-71, 65536.0, [128, 32, 8]
| | |   >-  y: q-71, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-71: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-71, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-71: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-71, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-71, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-71: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-71, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-71: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-71, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-71: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.71.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-71, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-71: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-71, 49152.0, [12288, 1]
|   >-----  y: l_out-70, 49152.0, [12288, 1]
|         
| <-------norm-71: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-71, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-71: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-71, 49152.0, [12288, 1]
|   |       y: blk.71.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-71: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.71.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-71, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-71: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-71, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-71: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.71.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-71, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-71: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-71, 114688.0, [28672, 1]
| >-------  y: ffn_up-71, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-71: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.71.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-71, 114688.0, [28672, 1]
| |       
| | <-----l_out-71: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-71, 49152.0, [12288, 1]
>---------  y: ffn_inp-71, 49152.0, [12288, 1]
    |     
    |     == layer 72 ==
    |     
<---|-----norm-72: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-71, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-72: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-72, 49152.0, [12288, 1]
  | |       y: blk.72.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-72: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.72.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-72, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-72: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-72, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-72: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-72, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-72: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.72.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-72, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-72: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-72, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-72: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-72, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-72: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.72.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-72, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-72: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l72, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-72: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-72, 4096.0, [128, 8]
| >-------  y: k_cache_view-72, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-72: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-72, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-72: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l72, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-72: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-72, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-72, 2048.0, [1, 1024]
|   |     
| <-|-----v-72: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l72, 67108864.0, [33554432, 1]
| | |     
| | | <---k-72: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l72, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-72: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-72, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-72: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-72, 65536.0, [128, 32, 8]
| | |   >-  y: q-72, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-72: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-72, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-72: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-72, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-72, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-72: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-72, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-72: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-72, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-72: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.72.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-72, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-72: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-72, 49152.0, [12288, 1]
|   >-----  y: l_out-71, 49152.0, [12288, 1]
|         
| <-------norm-72: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-72, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-72: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-72, 49152.0, [12288, 1]
|   |       y: blk.72.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-72: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.72.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-72, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-72: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-72, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-72: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.72.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-72, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-72: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-72, 114688.0, [28672, 1]
| >-------  y: ffn_up-72, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-72: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.72.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-72, 114688.0, [28672, 1]
| |       
| | <-----l_out-72: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-72, 49152.0, [12288, 1]
>---------  y: ffn_inp-72, 49152.0, [12288, 1]
    |     
    |     == layer 73 ==
    |     
<---|-----norm-73: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-72, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-73: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-73, 49152.0, [12288, 1]
  | |       y: blk.73.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-73: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.73.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-73, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-73: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-73, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-73: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-73, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-73: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.73.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-73, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-73: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-73, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-73: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-73, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-73: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.73.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-73, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-73: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l73, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-73: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-73, 4096.0, [128, 8]
| >-------  y: k_cache_view-73, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-73: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-73, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-73: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l73, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-73: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-73, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-73, 2048.0, [1, 1024]
|   |     
| <-|-----v-73: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l73, 67108864.0, [33554432, 1]
| | |     
| | | <---k-73: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l73, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-73: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-73, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-73: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-73, 65536.0, [128, 32, 8]
| | |   >-  y: q-73, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-73: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-73, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-73: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-73, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-73, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-73: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-73, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-73: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-73, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-73: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.73.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-73, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-73: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-73, 49152.0, [12288, 1]
|   >-----  y: l_out-72, 49152.0, [12288, 1]
|         
| <-------norm-73: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-73, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-73: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-73, 49152.0, [12288, 1]
|   |       y: blk.73.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-73: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.73.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-73, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-73: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-73, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-73: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.73.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-73, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-73: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-73, 114688.0, [28672, 1]
| >-------  y: ffn_up-73, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-73: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.73.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-73, 114688.0, [28672, 1]
| |       
| | <-----l_out-73: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-73, 49152.0, [12288, 1]
>---------  y: ffn_inp-73, 49152.0, [12288, 1]
    |     
    |     == layer 74 ==
    |     
<---|-----norm-74: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-73, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-74: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-74, 49152.0, [12288, 1]
  | |       y: blk.74.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-74: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.74.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-74, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-74: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-74, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-74: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-74, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-74: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.74.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-74, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-74: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-74, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-74: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-74, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-74: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.74.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-74, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-74: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l74, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-74: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-74, 4096.0, [128, 8]
| >-------  y: k_cache_view-74, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-74: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-74, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-74: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l74, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-74: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-74, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-74, 2048.0, [1, 1024]
|   |     
| <-|-----v-74: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l74, 67108864.0, [33554432, 1]
| | |     
| | | <---k-74: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l74, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-74: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-74, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-74: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-74, 65536.0, [128, 32, 8]
| | |   >-  y: q-74, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-74: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-74, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-74: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-74, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-74, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-74: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-74, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-74: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-74, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-74: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.74.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-74, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-74: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-74, 49152.0, [12288, 1]
|   >-----  y: l_out-73, 49152.0, [12288, 1]
|         
| <-------norm-74: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-74, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-74: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-74, 49152.0, [12288, 1]
|   |       y: blk.74.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-74: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.74.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-74, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-74: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-74, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-74: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.74.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-74, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-74: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-74, 114688.0, [28672, 1]
| >-------  y: ffn_up-74, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-74: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.74.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-74, 114688.0, [28672, 1]
| |       
| | <-----l_out-74: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-74, 49152.0, [12288, 1]
>---------  y: ffn_inp-74, 49152.0, [12288, 1]
    |     
    |     == layer 75 ==
    |     
<---|-----norm-75: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-74, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-75: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-75, 49152.0, [12288, 1]
  | |       y: blk.75.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-75: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.75.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-75, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-75: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-75, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-75: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-75, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-75: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.75.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-75, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-75: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-75, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-75: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-75, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-75: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.75.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-75, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-75: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l75, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-75: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-75, 4096.0, [128, 8]
| >-------  y: k_cache_view-75, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-75: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-75, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-75: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l75, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-75: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-75, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-75, 2048.0, [1, 1024]
|   |     
| <-|-----v-75: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l75, 67108864.0, [33554432, 1]
| | |     
| | | <---k-75: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l75, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-75: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-75, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-75: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-75, 65536.0, [128, 32, 8]
| | |   >-  y: q-75, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-75: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-75, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-75: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-75, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-75, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-75: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-75, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-75: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-75, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-75: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.75.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-75, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-75: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-75, 49152.0, [12288, 1]
|   >-----  y: l_out-74, 49152.0, [12288, 1]
|         
| <-------norm-75: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-75, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-75: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-75, 49152.0, [12288, 1]
|   |       y: blk.75.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-75: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.75.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-75, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-75: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-75, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-75: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.75.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-75, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-75: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-75, 114688.0, [28672, 1]
| >-------  y: ffn_up-75, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-75: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.75.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-75, 114688.0, [28672, 1]
| |       
| | <-----l_out-75: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-75, 49152.0, [12288, 1]
>---------  y: ffn_inp-75, 49152.0, [12288, 1]
    |     
    |     == layer 76 ==
    |     
<---|-----norm-76: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-75, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-76: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-76, 49152.0, [12288, 1]
  | |       y: blk.76.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-76: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.76.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-76, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-76: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-76, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-76: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-76, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-76: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.76.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-76, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-76: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-76, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-76: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-76, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-76: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.76.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-76, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-76: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l76, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-76: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-76, 4096.0, [128, 8]
| >-------  y: k_cache_view-76, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-76: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-76, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-76: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l76, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-76: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-76, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-76, 2048.0, [1, 1024]
|   |     
| <-|-----v-76: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l76, 67108864.0, [33554432, 1]
| | |     
| | | <---k-76: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l76, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-76: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-76, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-76: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-76, 65536.0, [128, 32, 8]
| | |   >-  y: q-76, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-76: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-76, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-76: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-76, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-76, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-76: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-76, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-76: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-76, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-76: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.76.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-76, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-76: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-76, 49152.0, [12288, 1]
|   >-----  y: l_out-75, 49152.0, [12288, 1]
|         
| <-------norm-76: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-76, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-76: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-76, 49152.0, [12288, 1]
|   |       y: blk.76.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-76: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.76.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-76, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-76: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-76, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-76: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.76.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-76, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-76: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-76, 114688.0, [28672, 1]
| >-------  y: ffn_up-76, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-76: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.76.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-76, 114688.0, [28672, 1]
| |       
| | <-----l_out-76: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-76, 49152.0, [12288, 1]
>---------  y: ffn_inp-76, 49152.0, [12288, 1]
    |     
    |     == layer 77 ==
    |     
<---|-----norm-77: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-76, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-77: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-77, 49152.0, [12288, 1]
  | |       y: blk.77.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-77: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.77.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-77, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-77: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-77, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-77: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-77, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-77: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.77.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-77, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-77: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-77, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-77: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-77, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-77: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.77.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-77, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-77: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l77, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-77: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-77, 4096.0, [128, 8]
| >-------  y: k_cache_view-77, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-77: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-77, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-77: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l77, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-77: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-77, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-77, 2048.0, [1, 1024]
|   |     
| <-|-----v-77: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l77, 67108864.0, [33554432, 1]
| | |     
| | | <---k-77: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l77, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-77: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-77, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-77: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-77, 65536.0, [128, 32, 8]
| | |   >-  y: q-77, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-77: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-77, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-77: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-77, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-77, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-77: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-77, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-77: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-77, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-77: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.77.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-77, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-77: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-77, 49152.0, [12288, 1]
|   >-----  y: l_out-76, 49152.0, [12288, 1]
|         
| <-------norm-77: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-77, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-77: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-77, 49152.0, [12288, 1]
|   |       y: blk.77.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-77: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.77.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-77, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-77: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-77, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-77: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.77.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-77, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-77: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-77, 114688.0, [28672, 1]
| >-------  y: ffn_up-77, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-77: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.77.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-77, 114688.0, [28672, 1]
| |       
| | <-----l_out-77: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-77, 49152.0, [12288, 1]
>---------  y: ffn_inp-77, 49152.0, [12288, 1]
    |     
    |     == layer 78 ==
    |     
<---|-----norm-78: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-77, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-78: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-78, 49152.0, [12288, 1]
  | |       y: blk.78.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-78: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.78.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-78, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-78: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-78, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-78: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-78, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-78: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.78.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-78, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-78: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-78, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-78: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-78, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-78: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.78.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-78, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-78: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l78, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-78: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-78, 4096.0, [128, 8]
| >-------  y: k_cache_view-78, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-78: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-78, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-78: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l78, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-78: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-78, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-78, 2048.0, [1, 1024]
|   |     
| <-|-----v-78: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l78, 67108864.0, [33554432, 1]
| | |     
| | | <---k-78: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l78, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-78: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-78, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-78: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-78, 65536.0, [128, 32, 8]
| | |   >-  y: q-78, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-78: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-78, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-78: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-78, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-78, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-78: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-78, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-78: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-78, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-78: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.78.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-78, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-78: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-78, 49152.0, [12288, 1]
|   >-----  y: l_out-77, 49152.0, [12288, 1]
|         
| <-------norm-78: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-78, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-78: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-78, 49152.0, [12288, 1]
|   |       y: blk.78.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-78: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.78.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-78, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-78: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-78, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-78: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.78.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-78, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-78: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-78, 114688.0, [28672, 1]
| >-------  y: ffn_up-78, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-78: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.78.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-78, 114688.0, [28672, 1]
| |       
| | <-----l_out-78: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-78, 49152.0, [12288, 1]
>---------  y: ffn_inp-78, 49152.0, [12288, 1]
    |     
    |     == layer 79 ==
    |     
<---|-----norm-79: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-78, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-79: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-79, 49152.0, [12288, 1]
  | |       y: blk.79.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-79: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.79.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-79, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-79: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-79, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-79: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-79, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-79: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.79.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-79, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-79: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-79, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-79: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-79, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-79: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.79.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-79, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-79: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l79, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-79: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-79, 4096.0, [128, 8]
| >-------  y: k_cache_view-79, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-79: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-79, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-79: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l79, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-79: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-79, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-79, 2048.0, [1, 1024]
|   |     
| <-|-----v-79: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l79, 67108864.0, [33554432, 1]
| | |     
| | | <---k-79: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l79, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-79: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-79, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-79: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-79, 65536.0, [128, 32, 8]
| | |   >-  y: q-79, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-79: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-79, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-79: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-79, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-79, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-79: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-79, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-79: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-79, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-79: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.79.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-79, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-79: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-79, 49152.0, [12288, 1]
|   >-----  y: l_out-78, 49152.0, [12288, 1]
|         
| <-------norm-79: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-79, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-79: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-79, 49152.0, [12288, 1]
|   |       y: blk.79.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-79: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.79.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-79, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-79: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-79, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-79: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.79.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-79, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-79: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-79, 114688.0, [28672, 1]
| >-------  y: ffn_up-79, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-79: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.79.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-79, 114688.0, [28672, 1]
| |       
| | <-----l_out-79: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-79, 49152.0, [12288, 1]
>---------  y: ffn_inp-79, 49152.0, [12288, 1]
    |     
    |     == layer 80 ==
    |     
<---|-----norm-80: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-79, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-80: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-80, 49152.0, [12288, 1]
  | |       y: blk.80.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-80: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.80.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-80, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-80: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-80, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-80: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-80, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-80: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.80.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-80, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-80: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-80, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-80: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-80, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-80: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.80.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-80, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-80: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l80, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-80: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-80, 4096.0, [128, 8]
| >-------  y: k_cache_view-80, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-80: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-80, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-80: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l80, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-80: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-80, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-80, 2048.0, [1, 1024]
|   |     
| <-|-----v-80: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l80, 67108864.0, [33554432, 1]
| | |     
| | | <---k-80: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l80, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-80: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-80, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-80: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-80, 65536.0, [128, 32, 8]
| | |   >-  y: q-80, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-80: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-80, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-80: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-80, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-80, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-80: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-80, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-80: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-80, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-80: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.80.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-80, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-80: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-80, 49152.0, [12288, 1]
|   >-----  y: l_out-79, 49152.0, [12288, 1]
|         
| <-------norm-80: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-80, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-80: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-80, 49152.0, [12288, 1]
|   |       y: blk.80.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-80: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.80.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-80, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-80: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-80, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-80: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.80.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-80, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-80: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-80, 114688.0, [28672, 1]
| >-------  y: ffn_up-80, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-80: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.80.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-80, 114688.0, [28672, 1]
| |       
| | <-----l_out-80: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-80, 49152.0, [12288, 1]
>---------  y: ffn_inp-80, 49152.0, [12288, 1]
    |     
    |     == layer 81 ==
    |     
<---|-----norm-81: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-80, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-81: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-81, 49152.0, [12288, 1]
  | |       y: blk.81.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-81: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.81.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-81, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-81: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-81, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-81: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-81, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-81: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.81.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-81, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-81: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-81, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-81: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-81, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-81: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.81.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-81, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-81: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l81, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-81: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-81, 4096.0, [128, 8]
| >-------  y: k_cache_view-81, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-81: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-81, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-81: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l81, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-81: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-81, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-81, 2048.0, [1, 1024]
|   |     
| <-|-----v-81: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l81, 67108864.0, [33554432, 1]
| | |     
| | | <---k-81: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l81, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-81: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-81, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-81: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-81, 65536.0, [128, 32, 8]
| | |   >-  y: q-81, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-81: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-81, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-81: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-81, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-81, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-81: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-81, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-81: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-81, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-81: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.81.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-81, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-81: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-81, 49152.0, [12288, 1]
|   >-----  y: l_out-80, 49152.0, [12288, 1]
|         
| <-------norm-81: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-81, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-81: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-81, 49152.0, [12288, 1]
|   |       y: blk.81.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-81: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.81.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-81, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-81: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-81, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-81: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.81.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-81, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-81: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-81, 114688.0, [28672, 1]
| >-------  y: ffn_up-81, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-81: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.81.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-81, 114688.0, [28672, 1]
| |       
| | <-----l_out-81: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-81, 49152.0, [12288, 1]
>---------  y: ffn_inp-81, 49152.0, [12288, 1]
    |     
    |     == layer 82 ==
    |     
<---|-----norm-82: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-81, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-82: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-82, 49152.0, [12288, 1]
  | |       y: blk.82.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-82: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.82.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-82, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-82: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-82, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-82: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-82, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-82: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.82.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-82, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-82: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-82, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-82: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-82, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-82: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.82.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-82, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-82: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l82, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-82: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-82, 4096.0, [128, 8]
| >-------  y: k_cache_view-82, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-82: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-82, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-82: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l82, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-82: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-82, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-82, 2048.0, [1, 1024]
|   |     
| <-|-----v-82: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l82, 67108864.0, [33554432, 1]
| | |     
| | | <---k-82: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l82, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-82: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-82, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-82: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-82, 65536.0, [128, 32, 8]
| | |   >-  y: q-82, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-82: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-82, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-82: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-82, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-82, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-82: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-82, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-82: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-82, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-82: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.82.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-82, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-82: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-82, 49152.0, [12288, 1]
|   >-----  y: l_out-81, 49152.0, [12288, 1]
|         
| <-------norm-82: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-82, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-82: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-82, 49152.0, [12288, 1]
|   |       y: blk.82.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-82: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.82.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-82, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-82: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-82, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-82: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.82.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-82, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-82: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-82, 114688.0, [28672, 1]
| >-------  y: ffn_up-82, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-82: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.82.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-82, 114688.0, [28672, 1]
| |       
| | <-----l_out-82: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-82, 49152.0, [12288, 1]
>---------  y: ffn_inp-82, 49152.0, [12288, 1]
    |     
    |     == layer 83 ==
    |     
<---|-----norm-83: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-82, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-83: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-83, 49152.0, [12288, 1]
  | |       y: blk.83.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-83: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.83.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-83, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-83: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-83, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-83: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-83, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-83: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.83.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-83, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-83: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-83, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-83: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-83, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-83: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.83.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-83, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-83: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l83, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-83: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-83, 4096.0, [128, 8]
| >-------  y: k_cache_view-83, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-83: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-83, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-83: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l83, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-83: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-83, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-83, 2048.0, [1, 1024]
|   |     
| <-|-----v-83: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l83, 67108864.0, [33554432, 1]
| | |     
| | | <---k-83: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l83, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-83: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-83, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-83: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-83, 65536.0, [128, 32, 8]
| | |   >-  y: q-83, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-83: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-83, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-83: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-83, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-83, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-83: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-83, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-83: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-83, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-83: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.83.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-83, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-83: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-83, 49152.0, [12288, 1]
|   >-----  y: l_out-82, 49152.0, [12288, 1]
|         
| <-------norm-83: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-83, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-83: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-83, 49152.0, [12288, 1]
|   |       y: blk.83.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-83: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.83.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-83, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-83: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-83, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-83: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.83.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-83, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-83: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-83, 114688.0, [28672, 1]
| >-------  y: ffn_up-83, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-83: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.83.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-83, 114688.0, [28672, 1]
| |       
| | <-----l_out-83: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-83, 49152.0, [12288, 1]
>---------  y: ffn_inp-83, 49152.0, [12288, 1]
    |     
    |     == layer 84 ==
    |     
<---|-----norm-84: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-83, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-84: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-84, 49152.0, [12288, 1]
  | |       y: blk.84.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-84: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.84.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-84, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-84: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-84, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-84: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-84, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-84: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.84.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-84, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-84: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-84, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-84: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-84, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-84: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.84.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-84, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-84: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l84, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-84: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-84, 4096.0, [128, 8]
| >-------  y: k_cache_view-84, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-84: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-84, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-84: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l84, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-84: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-84, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-84, 2048.0, [1, 1024]
|   |     
| <-|-----v-84: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l84, 67108864.0, [33554432, 1]
| | |     
| | | <---k-84: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l84, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-84: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-84, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-84: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-84, 65536.0, [128, 32, 8]
| | |   >-  y: q-84, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-84: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-84, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-84: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-84, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-84, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-84: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-84, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-84: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-84, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-84: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.84.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-84, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-84: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-84, 49152.0, [12288, 1]
|   >-----  y: l_out-83, 49152.0, [12288, 1]
|         
| <-------norm-84: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-84, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-84: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-84, 49152.0, [12288, 1]
|   |       y: blk.84.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-84: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.84.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-84, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-84: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-84, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-84: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.84.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-84, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-84: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-84, 114688.0, [28672, 1]
| >-------  y: ffn_up-84, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-84: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.84.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-84, 114688.0, [28672, 1]
| |       
| | <-----l_out-84: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-84, 49152.0, [12288, 1]
>---------  y: ffn_inp-84, 49152.0, [12288, 1]
    |     
    |     == layer 85 ==
    |     
<---|-----norm-85: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-84, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-85: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-85, 49152.0, [12288, 1]
  | |       y: blk.85.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-85: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.85.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-85, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-85: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-85, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-85: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-85, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-85: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.85.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-85, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-85: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-85, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-85: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-85, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-85: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.85.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-85, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-85: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l85, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-85: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-85, 4096.0, [128, 8]
| >-------  y: k_cache_view-85, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-85: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-85, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-85: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l85, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-85: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-85, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-85, 2048.0, [1, 1024]
|   |     
| <-|-----v-85: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l85, 67108864.0, [33554432, 1]
| | |     
| | | <---k-85: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l85, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-85: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-85, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-85: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-85, 65536.0, [128, 32, 8]
| | |   >-  y: q-85, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-85: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-85, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-85: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-85, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-85, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-85: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-85, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-85: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-85, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-85: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.85.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-85, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-85: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-85, 49152.0, [12288, 1]
|   >-----  y: l_out-84, 49152.0, [12288, 1]
|         
| <-------norm-85: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-85, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-85: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-85, 49152.0, [12288, 1]
|   |       y: blk.85.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-85: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.85.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-85, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-85: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-85, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-85: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.85.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-85, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-85: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-85, 114688.0, [28672, 1]
| >-------  y: ffn_up-85, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-85: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.85.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-85, 114688.0, [28672, 1]
| |       
| | <-----l_out-85: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-85, 49152.0, [12288, 1]
>---------  y: ffn_inp-85, 49152.0, [12288, 1]
    |     
    |     == layer 86 ==
    |     
<---|-----norm-86: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-85, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-86: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-86, 49152.0, [12288, 1]
  | |       y: blk.86.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-86: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.86.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-86, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-86: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-86, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-86: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-86, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-86: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.86.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-86, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-86: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-86, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-86: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-86, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-86: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.86.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-86, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-86: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l86, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-86: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-86, 4096.0, [128, 8]
| >-------  y: k_cache_view-86, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-86: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-86, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-86: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l86, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-86: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-86, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-86, 2048.0, [1, 1024]
|   |     
| <-|-----v-86: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l86, 67108864.0, [33554432, 1]
| | |     
| | | <---k-86: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l86, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-86: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-86, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-86: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-86, 65536.0, [128, 32, 8]
| | |   >-  y: q-86, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-86: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-86, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-86: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-86, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-86, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-86: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-86, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-86: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-86, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-86: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.86.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-86, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_inp-86: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: kqv_out-86, 49152.0, [12288, 1]
|   >-----  y: l_out-85, 49152.0, [12288, 1]
|         
| <-------norm-86: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
>---------  x: ffn_inp-86, 49152.0, [12288, 1]
| |       
| | <-----ffn_norm-86: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
| >-------  x: norm-86, 49152.0, [12288, 1]
|   |       y: blk.86.ffn_norm.weight, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_gate-86: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.86.ffn_gate.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-86, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-86: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
| >-------  x: ffn_gate-86, 114688.0, [28672, 1]
|   | |   
| <-|-|---ffn_up-86: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.86.ffn_up.weight, 198180864.0, [12288, 28672]
| | >-----  y: ffn_norm-86, 49152.0, [12288, 1]
| |   |   
| | <-|---ffn_gate_par-86: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-86, 114688.0, [28672, 1]
| >-------  y: ffn_up-86, 114688.0, [28672, 1]
|   |     
| <-|-----ffn_out-86: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.86.ffn_down.weight, 198180864.0, [28672, 12288]
| | >-----  y: ffn_gate_par-86, 114688.0, [28672, 1]
| |       
| | <-----l_out-86: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
| >-------  x: ffn_out-86, 49152.0, [12288, 1]
>---------  y: ffn_inp-86, 49152.0, [12288, 1]
    |     
    |     == layer 87 ==
    |     
<---|-----norm-87: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: l_out-86, 49152.0, [12288, 1]
|   |     
| <-|-----attn_norm-87: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-87, 49152.0, [12288, 1]
  | |       y: blk.87.attn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----Qcur-87: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.87.attn_q.weight, 84934656.0, [12288, 12288]
| >-------  y: attn_norm-87, 49152.0, [12288, 1]
| | |     
| | | <---Qcur-87: reshape(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'tempsize': 196608.0}
>---------  x: Qcur-87, 49152.0, [12288, 1]
  | | |   
<-|-|-|---Qcur-87: rope(x)
| | | |     49152.0, [128, 96]
| | | |     costs: {'fmul': 36864, 'fsin': 12288, 'tempsize': 196608.0}
| | | >---  x: Qcur-87, 49152.0, [128, 96]
| | |       y: inp_pos, 4.0, [1, 1]
| | |     
| | | <---Kcur-87: X*Y (MAT_MUL)
| | | |     4096.0, [1024, 1]
| | | |     costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 151552.0}
| | | |     x: blk.87.attn_k.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-87, 49152.0, [12288, 1]
| | | |   
| | | | <-Kcur-87: reshape(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'tempsize': 155648.0}
| | | >---  x: Kcur-87, 4096.0, [1024, 1]
| | |   | 
| | | <-|-Kcur-87: rope(x)
| | | | |   4096.0, [128, 8]
| | | | |   costs: {'fmul': 3072, 'fsin': 1024, 'tempsize': 155648.0}
| | | | >-  x: Kcur-87, 4096.0, [128, 8]
| | | |     y: inp_pos, 4.0, [1, 1]
| | | |   
| | | | <-Vcur-87: X*Y (MAT_MUL)
| | | | |   4096.0, [1024, 1]
| | | | |   costs: {'fmul': 12582912, 'read': 7077888.0, 'tempsize': 155648.0}
| | | | |   x: blk.87.attn_v.weight, 7077888.0, [12288, 1024]
| >-------  y: attn_norm-87, 49152.0, [12288, 1]
|   | | | 
| <-|-|-|-k_cache_view-87: view(x)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'tempsize': 106496.0}
| | | | |   x: cache_k_l87, 67108864.0, [33554432, 1]
| | | | | 
| | | | | k_cache_view-87: x->y (STORE)
| | | | |   2048.0, [1024, 1]
| | | | |   costs: {'write': 16384, 'tempsize': 106496.0}
| | | | |   not used by other computations
| | | >---  x: Kcur-87, 4096.0, [128, 8]
| >-------  y: k_cache_view-87, 2048.0, [1024, 1]
|   |   | 
| <-|---|-Vcur-87: transpose(x)
| | |   |   4096.0, [1, 1024]
| | |   |   costs: {'tempsize': 106496.0}
| | |   >-  x: Vcur-87, 4096.0, [1024, 1]
| | |     
| | | <---v_cache_view-87: view(x)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'tempsize': 102400.0}
| | | |     x: cache_v_l87, 67108864.0, [33554432, 1]
| | | |   
| | | |   v_cache_view-87: x->y (STORE)
| | | |     2048.0, [1, 1024]
| | | |     costs: {'write': 16384, 'tempsize': 102400.0}
| | | |     not used by other computations
| >-------  x: Vcur-87, 4096.0, [1, 1024]
|   | >---  y: v_cache_view-87, 2048.0, [1, 1024]
|   |     
| <-|-----v-87: view(x)
| | |       65536.0, [32, 128, 8]
| | |       costs: {'tempsize': 98304.0}
| | |       x: cache_v_l87, 67108864.0, [33554432, 1]
| | |     
| | | <---k-87: view(x)
| | | |     65536.0, [128, 32, 8]
| | | |     costs: {'tempsize': 98304.0}
| | | |     x: cache_k_l87, 67108864.0, [33554432, 1]
| | | |   
| | | | <-q-87: permute(x)
| | | | |   49152.0, [128, 1, 96]
| | | | |   costs: {'tempsize': 147456.0}
>---------  x: Qcur-87, 49152.0, [128, 96]
  | | | | 
<-|-|-|-|-kq-87: X*Y (MAT_MUL)
| | | | |   12288.0, [32, 1, 96]
| | | | |   costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| | | >---  x: k-87, 65536.0, [128, 32, 8]
| | |   >-  y: q-87, 49152.0, [128, 1, 96]
| | |     
| | | <---kq_soft_max_ext-87: soft_max(x)
| | | |     12288.0, [32, 1, 96]
| | | |     costs: {'fpow': 96, 'fmul': 9216, 'fadd': 9216, 'fexp': 3072, 'tempsize': 73728.0}
>---------  x: kq-87, 12288.0, [32, 1, 96]
  | | |     y: KQ_mask, 4096.0, [32, 32]
  | | |   
<-|-|-|---kqv-87: X*Y (MAT_MUL)
| | | |     49152.0, [128, 1, 96]
| | | |     costs: {'fmul': 393216, 'read': 65536.0, 'tempsize': 110592.0}
| >-------  x: v-87, 65536.0, [32, 128, 8]
|   | >---  y: kq_soft_max_ext-87, 12288.0, [32, 1, 96]
|   |     
| <-|-----kqv_merged-87: permute(x)
| | |       49152.0, [128, 96]
| | |       costs: {'tempsize': 147456.0}
>---------  x: kqv-87, 49152.0, [128, 1, 96]
  | |     
<-|-|-----kqv_merged_cont-87: cont(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'tempsize': 147456.0}
| >-------  x: kqv_merged-87, 49152.0, [128, 96]
|   |     
| <-|-----kqv_out-87: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 150994944, 'read': 84934656.0, 'tempsize': 147456.0}
| | |       x: blk.87.attn_output.weight, 84934656.0, [12288, 12288]
>---------  y: kqv_merged_cont-87, 49152.0, [12288, 1]
  | |     
<-|-|-----node_2808: get_rows(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'read': 49156.0, 'tempsize': 147456.0}
| >-------  x: kqv_out-87, 49152.0, [12288, 1]
|   |       y: inp_out_ids, 4.0, [1, 1]
|   |     
| <-|-----node_2809: get_rows(x)
| | |       49152.0, [12288, 1]
| | |       costs: {'read': 49156.0, 'tempsize': 147456.0}
| | >-----  x: l_out-86, 49152.0, [12288, 1]
| |         y: inp_out_ids, 4.0, [1, 1]
| |       
| | <-----ffn_inp-87: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
>---------  x: node_2808, 49152.0, [12288, 1]
  >-------  y: node_2809, 49152.0, [12288, 1]
    |     
<---|-----norm-87: rms_norm(x)
|   |       49152.0, [12288, 1]
|   |       costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
|   >-----  x: ffn_inp-87, 49152.0, [12288, 1]
|   |     
| <-|-----ffn_norm-87: x*y (MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 147456.0}
>---------  x: norm-87, 49152.0, [12288, 1]
  | |       y: blk.87.ffn_norm.weight, 49152.0, [12288, 1]
  | |     
<-|-|-----ffn_gate-87: X*Y (MAT_MUL)
| | |       114688.0, [28672, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.87.ffn_gate.weight, 198180864.0, [12288, 28672]
| >-------  y: ffn_norm-87, 49152.0, [12288, 1]
| | |     
| | | <---ffn_silu-87: unary(x) (SILU?)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fadd': 57344, 'fdiv': 28672, 'fexp': 28672, 'tempsize': 327680.0}
>---------  x: ffn_gate-87, 114688.0, [28672, 1]
  | | |   
<-|-|-|---ffn_up-87: X*Y (MAT_MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 327680.0}
| | | |     x: blk.87.ffn_up.weight, 198180864.0, [12288, 28672]
| >-------  y: ffn_norm-87, 49152.0, [12288, 1]
|   | |   
| <-|-|---ffn_gate_par-87: x*y (MUL)
| | | |     114688.0, [28672, 1]
| | | |     costs: {'fmul': 28672, 'tempsize': 393216.0}
| | | >---  x: ffn_silu-87, 114688.0, [28672, 1]
>---------  y: ffn_up-87, 114688.0, [28672, 1]
  | |     
<-|-|-----ffn_out-87: X*Y (MAT_MUL)
| | |       49152.0, [12288, 1]
| | |       costs: {'fmul': 352321536, 'read': 198180864.0, 'tempsize': 212992.0}
| | |       x: blk.87.ffn_down.weight, 198180864.0, [28672, 12288]
| >-------  y: ffn_gate_par-87, 114688.0, [28672, 1]
|   |     
| <-|-----l_out-87: x+y
| | |       49152.0, [12288, 1]
| | |       costs: {'fadd': 12288, 'tempsize': 147456.0}
>---------  x: ffn_out-87, 49152.0, [12288, 1]
  | >-----  y: ffn_inp-87, 49152.0, [12288, 1]
  |       
<-|-------norm: rms_norm(x)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 24576, 'fdiv': 1, 'sqrt': 1, 'tempsize': 98304.0}
| >-------  x: l_out-87, 49152.0, [12288, 1]
|         
| <-------result_norm: x*y (MUL)
| |         49152.0, [12288, 1]
| |         costs: {'fmul': 12288, 'read': 49152.0, 'tempsize': 98304.0}
>---------  x: norm, 49152.0, [12288, 1]
  |         y: output_norm.weight, 49152.0, [12288, 1]
  |       
  |       result_output: X*Y (MAT_MUL)
  |         131072.0, [32768, 1]
  |         costs: {'fmul': 402653184, 'read': 330301440.0, 'tempsize': 49152.0}
  |         not used by other computations
  |         x: output.weight, 330301440.0, [12288, 32768]
  >-------  y: result_norm, 49152.0, [12288, 1]
